/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};

// src/main.ts
__export(exports, {
  default: () => EmojiChecklistPlugin
});
var import_obsidian5 = __toModule(require("obsidian"));

// src/types.ts
var DEFAULT_SETTINGS = {
  checkedEmoji: "\u2705",
  uncheckedEmoji: "\u2B1C\uFE0F",
  tagMappings: [
    {
      tag: "stopper",
      uncheckedEmoji: "\u{1F6D1}",
      checkedEmoji: "\u2705"
    }
  ],
  jiraSettings: {
    enabled: false,
    baseUrl: "",
    username: "",
    apiToken: "",
    triggerWord: "@jira"
  },
  reportSettings: {
    enabled: true,
    showHeaders: true,
    sections: [
      {
        name: "GREETINGS",
        content: "Good Morning everyone",
        enabled: true,
        showHeader: true
      },
      {
        name: "DATE",
        content: "",
        enabled: true,
        showHeader: false
      },
      {
        name: "BODY",
        content: "",
        enabled: true,
        showHeader: true
      },
      {
        name: "STOPPERS",
        content: "",
        enabled: true,
        showHeader: true
      }
    ]
  }
};

// src/settings.ts
var import_obsidian = __toModule(require("obsidian"));
var EmojiChecklistSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  updateTestSection() {
    if (this.testEl) {
      this.testEl.empty();
      const header = this.testEl.createEl("h3", { text: "Live Preview" });
      const uncheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
      uncheckedExample.createEl("span", { text: "Unchecked example: " });
      const uncheckedContainer = uncheckedExample.createEl("span", { cls: "task-preview" });
      uncheckedContainer.createEl("span", {
        text: this.plugin.settings.uncheckedEmoji,
        cls: "emoji-preview"
      });
      uncheckedContainer.createEl("span", { text: " Sample task" });
      const checkedExample = this.testEl.createEl("div", { cls: "setting-item" });
      checkedExample.createEl("span", { text: "Checked example: " });
      const checkedContainer = checkedExample.createEl("span", { cls: "task-preview" });
      checkedContainer.createEl("span", {
        text: this.plugin.settings.checkedEmoji,
        cls: "emoji-preview"
      });
      const checkedText = checkedContainer.createEl("span", { text: " Sample task" });
      checkedText.style.textDecoration = "line-through";
      checkedText.style.color = "var(--text-muted)";
      if (this.plugin.settings.tagMappings.length > 0) {
        const tagHeader = this.testEl.createEl("h3", { text: "Tag Examples" });
        tagHeader.style.marginTop = "2em";
        tagHeader.style.marginBottom = "1em";
        for (const mapping of this.plugin.settings.tagMappings) {
          const tagUncheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
          tagUncheckedExample.createEl("span", { text: `#${mapping.tag} unchecked: ` });
          const tagUncheckedContainer = tagUncheckedExample.createEl("span", { cls: "task-preview" });
          tagUncheckedContainer.createEl("span", {
            text: mapping.uncheckedEmoji,
            cls: "emoji-preview"
          });
          tagUncheckedContainer.createEl("span", { text: ` Sample #${mapping.tag} task` });
          const tagCheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
          tagCheckedExample.createEl("span", { text: `#${mapping.tag} checked: ` });
          const tagCheckedContainer = tagCheckedExample.createEl("span", { cls: "task-preview" });
          tagCheckedContainer.createEl("span", {
            text: mapping.checkedEmoji,
            cls: "emoji-preview"
          });
          const tagCheckedText = tagCheckedContainer.createEl("span", { text: ` Sample #${mapping.tag} task` });
          tagCheckedText.style.textDecoration = "line-through";
          tagCheckedText.style.color = "var(--text-muted)";
          tagUncheckedExample.style.marginBottom = "0.5em";
          tagCheckedExample.style.marginBottom = "0.5em";
        }
      }
      header.style.marginTop = "2em";
      header.style.marginBottom = "1em";
      uncheckedExample.style.marginBottom = "0.5em";
      checkedExample.style.marginBottom = "0.5em";
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Emoji Checklist Settings" });
    new import_obsidian.Setting(containerEl).setName("Default Unchecked Emoji").setDesc("Emoji to display for unchecked tasks").addText((text) => text.setValue(this.plugin.settings.uncheckedEmoji).onChange(async (value) => {
      this.plugin.settings.uncheckedEmoji = value;
      await this.plugin.saveSettings();
      this.updateTestSection();
      console.log("Updated default unchecked emoji:", this.plugin.settings.uncheckedEmoji);
    }));
    new import_obsidian.Setting(containerEl).setName("Default Checked Emoji").setDesc("Emoji to display for checked tasks").addText((text) => text.setValue(this.plugin.settings.checkedEmoji).onChange(async (value) => {
      this.plugin.settings.checkedEmoji = value;
      await this.plugin.saveSettings();
      this.updateTestSection();
      console.log("Updated default checked emoji:", this.plugin.settings.checkedEmoji);
    }));
    containerEl.createEl("h3", { text: "Tag Mappings" });
    const tagMappingsContainer = containerEl.createDiv("tag-mappings");
    this.plugin.settings.tagMappings.forEach((mapping, index) => {
      const mappingContainer = tagMappingsContainer.createDiv("tag-mapping");
      new import_obsidian.Setting(mappingContainer).setName(`Tag #${mapping.tag}`).addText((text) => text.setPlaceholder("tag name").setValue(mapping.tag).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].tag = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addText((text) => text.setPlaceholder("unchecked emoji").setValue(mapping.uncheckedEmoji).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].uncheckedEmoji = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addText((text) => text.setPlaceholder("checked emoji").setValue(mapping.checkedEmoji).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].checkedEmoji = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addButton((button) => button.setIcon("trash").onClick(async () => {
        this.plugin.settings.tagMappings.splice(index, 1);
        await this.plugin.saveSettings();
        this.display();
        console.log("Removed tag mapping, remaining:", this.plugin.settings.tagMappings);
      }));
    });
    new import_obsidian.Setting(containerEl).setName("Add Tag Mapping").setDesc("Add a new tag-emoji mapping").addButton((button) => button.setButtonText("Add New Tag").onClick(async () => {
      this.plugin.settings.tagMappings.push({
        tag: "newtag",
        uncheckedEmoji: "\u2B55",
        checkedEmoji: "\u2705"
      });
      await this.plugin.saveSettings();
      console.log("Added new tag mapping:", this.plugin.settings.tagMappings);
      this.display();
    }));
    new import_obsidian.Setting(containerEl).setName("Reset Settings").setDesc("Restore all settings to their defaults").addButton((button) => button.setButtonText("Restore Defaults").onClick(async () => {
      this.plugin.settings = Object.assign({}, DEFAULT_SETTINGS);
      await this.plugin.saveSettings();
      console.log("Reset settings to defaults:", this.plugin.settings);
      this.display();
      new import_obsidian.Notice("Settings restored to defaults");
    }));
    containerEl.createEl("h3", { text: "Jira Integration" });
    new import_obsidian.Setting(containerEl).setName("Enable Jira Integration").setDesc("Enable or disable Jira integration").addToggle((toggle) => toggle.setValue(this.plugin.settings.jiraSettings.enabled).onChange(async (value) => {
      this.plugin.settings.jiraSettings.enabled = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Trigger Word").setDesc("Word that triggers Jira task insertion (e.g., @jira)").addText((text) => text.setPlaceholder("@jira").setValue(this.plugin.settings.jiraSettings.triggerWord).onChange(async (value) => {
      this.plugin.settings.jiraSettings.triggerWord = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Jira Base URL").setDesc("Your Jira instance URL (e.g., https://your-domain.atlassian.net)").addText((text) => text.setPlaceholder("https://your-domain.atlassian.net").setValue(this.plugin.settings.jiraSettings.baseUrl).onChange(async (value) => {
      this.plugin.settings.jiraSettings.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Username").setDesc("Your Jira email address").addText((text) => text.setPlaceholder("email@example.com").setValue(this.plugin.settings.jiraSettings.username).onChange(async (value) => {
      this.plugin.settings.jiraSettings.username = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("API Token").setDesc("Your Jira API token (from https://id.atlassian.com/manage-profile/security/api-tokens)").addText((text) => text.setPlaceholder("Enter your API token").setValue(this.plugin.settings.jiraSettings.apiToken).onChange(async (value) => {
      this.plugin.settings.jiraSettings.apiToken = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h2", { text: "Report Settings" });
    new import_obsidian.Setting(containerEl).setName("Enable Report Feature").setDesc("Enable/disable the report formatting feature").addToggle((toggle) => toggle.setValue(this.plugin.settings.reportSettings.enabled).onChange(async (value) => {
      this.plugin.settings.reportSettings.enabled = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Show Section Headers").setDesc("Show/hide section headers in the report").addToggle((toggle) => toggle.setValue(this.plugin.settings.reportSettings.showHeaders).onChange(async (value) => {
      this.plugin.settings.reportSettings.showHeaders = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Report Sections" });
    for (let i = 0; i < this.plugin.settings.reportSettings.sections.length; i++) {
      const section = this.plugin.settings.reportSettings.sections[i];
      const sectionContainer = containerEl.createDiv();
      sectionContainer.addClass("report-section-settings");
      new import_obsidian.Setting(sectionContainer).setName(`Section: ${section.name}`).setDesc("Configure this section").addToggle((toggle) => toggle.setValue(section.enabled).onChange(async (value) => {
        section.enabled = value;
        await this.plugin.saveSettings();
      })).addToggle((toggle) => toggle.setTooltip("Show section header").setValue(section.showHeader).onChange(async (value) => {
        section.showHeader = value;
        await this.plugin.saveSettings();
      })).addText((text) => text.setPlaceholder("Section content").setValue(section.content).onChange(async (value) => {
        section.content = value;
        await this.plugin.saveSettings();
      }));
    }
    new import_obsidian.Setting(containerEl).setName("Add New Section").setDesc("Add a new section to the report").addButton((button) => button.setButtonText("Add Section").onClick(async () => {
      this.plugin.settings.reportSettings.sections.push({
        name: "New Section",
        content: "",
        enabled: true,
        showHeader: true
      });
      await this.plugin.saveSettings();
      this.display();
    }));
    new import_obsidian.Setting(containerEl).setName("Apply Changes").setDesc("Apply emoji changes to all open notes").addButton((button) => button.setButtonText("Apply Changes").onClick(() => {
      this.plugin.refreshAllNotes();
    }));
    this.testEl = containerEl.createDiv();
    this.updateTestSection();
  }
};

// src/processor.ts
var import_obsidian2 = __toModule(require("obsidian"));
var EmojiRenderChild = class extends import_obsidian2.MarkdownRenderChild {
  constructor(span) {
    super(span);
    this.span = span;
  }
  onunload() {
  }
};
var CheckboxProcessor = class {
  static findTagInLine(listItem) {
    const text = listItem.textContent || "";
    const tagMatch = text.replace(/^[^\w\s#]*\s*/, "").match(/#(\w+)/);
    return tagMatch ? tagMatch[1] : null;
  }
  static getEmojisForTag(plugin, tag, isChecked) {
    if (!tag) {
      return isChecked ? plugin.settings.checkedEmoji : plugin.settings.uncheckedEmoji;
    }
    const mapping = plugin.settings.tagMappings.find((m) => m.tag === tag);
    if (!mapping) {
      return isChecked ? plugin.settings.checkedEmoji : plugin.settings.uncheckedEmoji;
    }
    return isChecked ? mapping.checkedEmoji : mapping.uncheckedEmoji;
  }
  static updateEditorContent(editor, lineIndex, newEmoji) {
    const lineText = editor.getLine(lineIndex);
    const newText = lineText.replace(/^[^\w\s#]*\s*/, `${newEmoji} `);
    const change = {
      from: { line: lineIndex, ch: 0 },
      to: { line: lineIndex, ch: lineText.length },
      text: newText
    };
    editor.transaction({ changes: [change] });
  }
  static createEmojiSpan(emoji) {
    const span = document.createElement("span");
    span.className = "task-list-emoji";
    span.textContent = emoji;
    return span;
  }
  static styleContainer(container) {
    if (container) {
      container.style.display = "inline-block";
      container.style.verticalAlign = "top";
      container.style.marginRight = "0.5em";
    }
  }
  static setupEventListeners(plugin, checkbox, span, tag, index, editor, sectionInfo, ctx) {
    const updateEmoji = (isChecked) => {
      const newEmoji = this.getEmojisForTag(plugin, tag, isChecked);
      span.textContent = newEmoji;
      if (editor && sectionInfo) {
        this.updateEditorContent(editor, sectionInfo.lineStart + index, newEmoji);
      }
    };
    const toggleCheckbox = async () => {
      checkbox.checked = !checkbox.checked;
      updateEmoji(checkbox.checked);
      checkbox.dispatchEvent(new Event("change", { bubbles: true }));
      checkbox.dispatchEvent(new Event("click", { bubbles: true }));
      if (ctx.sourcePath) {
        ctx.addChild(new EmojiRenderChild(span));
      }
    };
    span.addEventListener("click", async (e) => {
      e.preventDefault();
      e.stopPropagation();
      await toggleCheckbox();
    });
    checkbox.addEventListener("change", () => {
      updateEmoji(checkbox.checked);
    });
  }
  static async processCheckbox(plugin, checkbox, index, editor, sectionInfo, ctx) {
    const listItem = checkbox.closest("li.task-list-item");
    if (!listItem)
      return;
    const tag = this.findTagInLine(listItem);
    const emoji = this.getEmojisForTag(plugin, tag, checkbox.checked);
    const span = this.createEmojiSpan(emoji);
    if (editor && sectionInfo) {
      this.updateEditorContent(editor, sectionInfo.lineStart + index, emoji);
    }
    this.setupEventListeners(plugin, checkbox, span, tag, index, editor, sectionInfo, ctx);
    this.styleContainer(checkbox.parentElement);
    checkbox.style.display = "none";
    checkbox.after(span);
  }
};
var processCheckboxes = function(el, ctx) {
  const checkboxes = el.querySelectorAll('li.task-list-item input[type="checkbox"]');
  const view = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
  const editor = view == null ? void 0 : view.editor;
  const sectionInfo = ctx.getSectionInfo(el);
  checkboxes.forEach((checkbox, index) => {
    if (!(checkbox instanceof HTMLInputElement))
      return;
    CheckboxProcessor.processCheckbox(this, checkbox, index, editor, sectionInfo, ctx);
  });
};

// src/jira.ts
var import_obsidian3 = __toModule(require("obsidian"));
var JiraClient = class {
  constructor(settings) {
    this.settings = settings;
  }
  getAuthHeader() {
    const credentials = `${this.settings.username}:${this.settings.apiToken}`;
    const base64Credentials = Buffer.from(credentials).toString("base64");
    return `Basic ${base64Credentials}`;
  }
  async testConnection() {
    const baseUrl = this.settings.baseUrl.replace(/\/$/, "");
    const apiUrl = `${baseUrl}/rest/api/2/myself`;
    try {
      const response = await (0, import_obsidian3.requestUrl)({
        url: apiUrl,
        method: "GET",
        headers: {
          "Authorization": this.getAuthHeader(),
          "Accept": "application/json"
        }
      });
      return response.status === 200;
    } catch (error) {
      console.error("Connection test failed:", error);
      return false;
    }
  }
  async searchTasks(query) {
    if (!this.settings.enabled || !this.settings.baseUrl || !this.settings.apiToken) {
      throw new Error("Jira integration is not properly configured");
    }
    const isConnected = await this.testConnection();
    if (!isConnected) {
      throw new Error("Could not authenticate with Jira. Please check your credentials.");
    }
    const baseUrl = this.settings.baseUrl.replace(/\/$/, "");
    const sanitizedQuery = query.replace(/["']/g, "");
    let jql;
    if (sanitizedQuery.toLowerCase() === "my tasks" || sanitizedQuery.toLowerCase() === "assigned to me") {
      jql = "assignee = currentUser()";
    } else if (sanitizedQuery.toLowerCase().startsWith("my")) {
      const status = sanitizedQuery.toLowerCase().includes("done") ? "Done" : sanitizedQuery.toLowerCase().includes("open") ? "Open" : null;
      jql = status ? `assignee = currentUser() AND status = "${status}"` : `assignee = currentUser() AND (summary ~ "${sanitizedQuery}" OR description ~ "${sanitizedQuery}")`;
    } else {
      jql = `assignee = currentUser() AND (summary ~ "${sanitizedQuery}" OR description ~ "${sanitizedQuery}")`;
    }
    jql += " ORDER BY updated DESC";
    console.log("JQL Query:", jql);
    const apiUrl = `${baseUrl}/rest/api/2/search?jql=${encodeURIComponent(jql)}&maxResults=10&fields=summary,status`;
    console.log("API URL:", apiUrl);
    const requestParams = {
      url: apiUrl,
      method: "GET",
      headers: {
        "Authorization": this.getAuthHeader(),
        "Accept": "application/json"
      }
    };
    try {
      console.log("Making request...");
      const response = await (0, import_obsidian3.requestUrl)(requestParams);
      console.log("Response status:", response.status);
      if (response.status !== 200) {
        console.error("Error response:", response.text);
        throw new Error(`Jira API returned status ${response.status}: ${response.text}`);
      }
      if (!response.json || !response.json.issues) {
        console.error("Invalid response format:", response);
        throw new Error("Invalid response format from Jira API");
      }
      console.log("Found issues:", response.json.issues.length);
      return response.json.issues.map((issue) => {
        var _a;
        return {
          key: issue.key,
          summary: issue.fields.summary,
          url: `${baseUrl}/browse/${issue.key}`,
          status: ((_a = issue.fields.status) == null ? void 0 : _a.name) || "Unknown"
        };
      });
    } catch (error) {
      console.error("Error details:", {
        message: error.message,
        status: error.status,
        response: error.response
      });
      if (error.status === 401 || error.status === 403) {
        throw new Error("Authentication failed. Please verify:\n1. Your email address is correct\n2. Your API token is correct\n3. You have the necessary permissions");
      }
      throw error;
    }
  }
  async formatTasksAsMarkdown(tasks) {
    return tasks.map((task) => `- [ ] [${task.key}: ${task.summary}](${task.url}) (${task.status})`).join("\n");
  }
};

// src/suggester.ts
var import_obsidian4 = __toModule(require("obsidian"));
var JiraTaskSuggester = class extends import_obsidian4.SuggestModal {
  constructor(app, tasks, onSelect) {
    super(app);
    this.tasks = [];
    console.log("JiraTaskSuggester constructor called");
    console.log("Tasks received:", tasks);
    this.tasks = tasks;
    this.onSelect = onSelect;
    this.setPlaceholder("Select a Jira task...");
    this.containerEl.addClass("jira-task-suggester");
    this.modalEl.style.maxWidth = "600px";
    this.modalEl.style.width = "80%";
    this.modalEl.style.top = "30%";
    this.modalEl.style.left = "50%";
    this.modalEl.style.transform = "translate(-50%, -30%)";
    this.modalEl.style.position = "fixed";
    const suggestionsContainer = this.modalEl.querySelector(".suggestion-container");
    if (suggestionsContainer instanceof HTMLElement) {
      suggestionsContainer.style.maxHeight = "400px";
      suggestionsContainer.style.width = "100%";
    }
    this.scope = new import_obsidian4.Scope();
    this.scope.register([], "Escape", () => {
      this.close();
      return false;
    });
    console.log("About to open modal");
    this.open();
  }
  open() {
    console.log("Explicitly opening modal");
    super.open();
    this.containerEl.style.display = "block";
    this.containerEl.style.visibility = "visible";
    this.containerEl.style.opacity = "1";
  }
  getSuggestions(query) {
    console.log("Getting suggestions for query:", query);
    const lowerQuery = query.toLowerCase();
    const filteredTasks = this.tasks.filter((task) => task.key.toLowerCase().includes(lowerQuery) || task.summary.toLowerCase().includes(lowerQuery));
    console.log("Filtered tasks:", filteredTasks);
    return filteredTasks;
  }
  renderSuggestion(task, el) {
    console.log("Rendering suggestion for task:", task);
    const container = el.createDiv({ cls: "jira-task-suggestion" });
    const keyEl = container.createDiv({ cls: "jira-key" });
    keyEl.setText(task.key);
    const summaryEl = container.createDiv({ cls: "jira-summary" });
    summaryEl.setText(task.summary);
    const statusEl = container.createDiv({ cls: "jira-status" });
    statusEl.setText(task.status);
    el.style.display = "flex";
    el.style.flexDirection = "column";
    el.style.gap = "4px";
    keyEl.style.fontWeight = "bold";
    keyEl.style.color = "var(--text-accent)";
    statusEl.style.fontSize = "0.8em";
    statusEl.style.color = "var(--text-muted)";
    statusEl.style.fontStyle = "italic";
  }
  onChooseSuggestion(task, evt) {
    console.log("Task chosen:", task);
    if (this.onSelect) {
      this.onSelect(task);
    }
    this.close();
  }
};

// src/main.ts
var EmojiChecklistPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    console.log("Plugin loaded with settings:", this.settings);
    this.registerEvent(this.app.workspace.on("editor-change", (editor) => {
      const cursor = editor.getCursor();
      const line = editor.getLine(cursor.line);
      const beforeCursor = line.slice(0, cursor.ch);
      const triggerWord = this.settings.jiraSettings.triggerWord;
      console.log("Checking for trigger:", {
        triggerWord,
        beforeCursor,
        endsWith: beforeCursor.endsWith(triggerWord),
        enabled: this.settings.jiraSettings.enabled
      });
      if (beforeCursor.endsWith(triggerWord)) {
        console.log("Trigger word detected, handling Jira trigger");
        this.handleJiraTrigger(editor);
      }
    }));
    this.addCommand({
      id: "insert-jira-issue",
      name: "Insert Jira Issue",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
        if (!view)
          return false;
        if (!checking) {
          this.insertJiraIssue(view);
        }
        return true;
      }
    });
    this.registerMarkdownPostProcessor(processCheckboxes.bind(this));
    this.addSettingTab(new EmojiChecklistSettingTab(this.app, this));
    this.registerEvent(this.app.workspace.on("editor-menu", (menu, editor) => {
      if (editor.getSelection()) {
        menu.addItem((item) => {
          item.setTitle("Copy as Formatted Report").setIcon("clipboard-copy").onClick(() => this.formatAndCopyToClipboard(editor));
        });
      }
    }));
  }
  formatAndCopyToClipboard(editor) {
    const selectedText = editor.getSelection();
    if (!selectedText) {
      new import_obsidian5.Notice("No text selected");
      return;
    }
    if (!this.settings.reportSettings.enabled) {
      new import_obsidian5.Notice("Report feature is disabled in settings");
      return;
    }
    const getEmoji = (line, isChecked) => {
      for (const mapping of this.settings.tagMappings) {
        if (line.toLowerCase().includes(`#${mapping.tag.toLowerCase()}`)) {
          return isChecked ? mapping.checkedEmoji : mapping.uncheckedEmoji;
        }
      }
      return isChecked ? this.settings.checkedEmoji : this.settings.uncheckedEmoji;
    };
    const lines = selectedText.split("\n");
    const processLine = (line) => {
      line = line.trim();
      if (line.startsWith("- [x]")) {
        return line.replace("- [x]", getEmoji(line, true));
      } else if (line.startsWith("- [ ]")) {
        return line.replace("- [ ]", getEmoji(line, false));
      }
      return line;
    };
    const tasks = lines.filter((line) => line.trim().length > 0).map(processLine);
    const stoppers = lines.filter((line) => line.toLowerCase().includes("#stopper")).map(processLine);
    const today = new Date().toLocaleDateString("en-US", {
      weekday: "long",
      year: "numeric",
      month: "long",
      day: "numeric"
    });
    const contentParts = [];
    for (const section of this.settings.reportSettings.sections) {
      if (!section.enabled)
        continue;
      if (this.settings.reportSettings.showHeaders && section.showHeader) {
        contentParts.push(`### ${section.name}`);
      }
      let sectionContent = section.content;
      switch (section.name) {
        case "DATE":
          sectionContent = `\u{1F4C5} ${today}`;
          break;
        case "BODY":
          sectionContent = tasks.filter((task) => !task.toLowerCase().includes("#stopper")).join("\n");
          break;
        case "STOPPERS":
          sectionContent = stoppers.join("\n");
          break;
      }
      if (sectionContent) {
        contentParts.push(sectionContent);
        contentParts.push("");
      }
    }
    const formattedContent = contentParts.join("\n");
    navigator.clipboard.writeText(formattedContent).then(() => {
      new import_obsidian5.Notice("Formatted content copied to clipboard");
    }).catch(() => {
      new import_obsidian5.Notice("Failed to copy to clipboard");
    });
  }
  async insertJiraIssue(view) {
    if (!this.settings.jiraSettings.enabled) {
      new import_obsidian5.Notice("Please enable and configure Jira integration in settings first");
      return;
    }
    try {
      const jiraClient = new JiraClient(this.settings.jiraSettings);
      const tasks = await jiraClient.searchTasks("my tasks");
      if (tasks.length === 0) {
        new import_obsidian5.Notice("No Jira tasks found assigned to you");
        return;
      }
      new JiraTaskSuggester(this.app, tasks, (selectedTask) => {
        const cursor = view.editor.getCursor();
        const taskMarkdown = `- [ ] [${selectedTask.key}: ${selectedTask.summary}](${selectedTask.url}) (${selectedTask.status})`;
        view.editor.replaceRange(taskMarkdown + "\n", cursor, cursor);
        view.editor.setCursor({
          line: cursor.line + 1,
          ch: 0
        });
      });
    } catch (error) {
      console.error("Error fetching Jira tasks:", error);
      new import_obsidian5.Notice(error.message || "Error fetching Jira tasks");
    }
  }
  async handleJiraTrigger(_editor) {
    console.log("handleJiraTrigger called");
    if (!this.settings.jiraSettings.enabled) {
      console.log("Jira integration not enabled");
      new import_obsidian5.Notice("Please enable and configure Jira integration in settings first");
      return;
    }
    try {
      console.log("Creating Jira client with settings:", this.settings.jiraSettings);
      const jiraClient = new JiraClient(this.settings.jiraSettings);
      console.log("Fetching tasks...");
      const tasks = await jiraClient.searchTasks("my tasks");
      console.log("Fetched tasks:", tasks);
      if (tasks.length === 0) {
        console.log("No tasks found");
        new import_obsidian5.Notice("No Jira tasks found assigned to you");
        return;
      }
      console.log("Opening task suggester with", tasks.length, "tasks");
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
      if (!activeView) {
        console.error("No active markdown view");
        new import_obsidian5.Notice("Please open a markdown note first");
        return;
      }
      try {
        const suggester = new JiraTaskSuggester(this.app, tasks, (selectedTask) => {
          console.log("Task selected:", selectedTask);
          const editor = activeView.editor;
          const cursor = editor.getCursor();
          const triggerWord = this.settings.jiraSettings.triggerWord;
          const currentLine = editor.getLine(cursor.line);
          const newLine = currentLine.slice(0, cursor.ch - triggerWord.length) + `[${selectedTask.key}: ${selectedTask.summary}](${selectedTask.url}) (${selectedTask.status})` + currentLine.slice(cursor.ch);
          editor.setLine(cursor.line, newLine);
          editor.setCursor({
            line: cursor.line,
            ch: cursor.ch - triggerWord.length + `[${selectedTask.key}: ${selectedTask.summary}](${selectedTask.url}) (${selectedTask.status})`.length
          });
        });
        console.log("Suggester created:", suggester);
      } catch (suggesterError) {
        console.error("Error creating suggester:", suggesterError);
        new import_obsidian5.Notice("Failed to create task suggester");
      }
    } catch (error) {
      console.error("Error in handleJiraTrigger:", error);
      new import_obsidian5.Notice(error.message || "Error fetching Jira tasks");
    }
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    console.log("Loaded data:", loadedData);
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData);
    console.log("Merged settings:", this.settings);
  }
  async saveSettings() {
    console.log("Saving settings:", this.settings);
    await this.saveData(this.settings);
  }
  refreshAllNotes() {
    this.app.workspace.trigger("markdown-preview-refresh");
    this.app.workspace.iterateAllLeaves((leaf) => {
      var _a;
      if (leaf.view.getViewType() === "markdown") {
        (_a = leaf.view.previewMode) == null ? void 0 : _a.rerender(true);
      }
    });
    new import_obsidian5.Notice("Applied emoji changes to all notes");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvcHJvY2Vzc29yLnRzIiwgInNyYy9qaXJhLnRzIiwgInNyYy9zdWdnZXN0ZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7RWRpdG9yLCBNYXJrZG93blByZXZpZXdWaWV3LCBNYXJrZG93blZpZXcsIE5vdGljZSwgUGx1Z2lufSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgdHlwZSB7RW1vamlDaGVja2xpc3RTZXR0aW5nc30gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge0RFRkFVTFRfU0VUVElOR1N9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtFbW9qaUNoZWNrbGlzdFNldHRpbmdUYWJ9IGZyb20gJy4vc2V0dGluZ3MnO1xuaW1wb3J0IHtwcm9jZXNzQ2hlY2tib3hlc30gZnJvbSAnLi9wcm9jZXNzb3InO1xuaW1wb3J0IHtKaXJhQ2xpZW50fSBmcm9tICcuL2ppcmEnO1xuaW1wb3J0IHtKaXJhVGFza1N1Z2dlc3Rlcn0gZnJvbSAnLi9zdWdnZXN0ZXInO1xuXG4vLyBBdWdtZW50IHRoZSBNYXJrZG93blZpZXcgdHlwZSBmcm9tIE9ic2lkaWFuXG5kZWNsYXJlIG1vZHVsZSAnb2JzaWRpYW4nIHtcbiAgICBpbnRlcmZhY2UgTWFya2Rvd25WaWV3IHtcbiAgICAgICAgcHJldmlld01vZGU6IE1hcmtkb3duUHJldmlld1ZpZXc7XG4gICAgICAgIGVkaXRvcjogRWRpdG9yO1xuICAgIH1cbn0gICBcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRW1vamlDaGVja2xpc3RQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBFbW9qaUNoZWNrbGlzdFNldHRpbmdzO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICBjb25zb2xlLmxvZygnUGx1Z2luIGxvYWRlZCB3aXRoIHNldHRpbmdzOicsIHRoaXMuc2V0dGluZ3MpO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIGVkaXRvciBjaGFuZ2UgaGFuZGxlciBmb3IgQCB0cmlnZ2Vyc1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1jaGFuZ2UnLCAoZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcbiAgICAgICAgICAgICAgICBjb25zdCBiZWZvcmVDdXJzb3IgPSBsaW5lLnNsaWNlKDAsIGN1cnNvci5jaCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBqdXN0IHR5cGVkIHRoZSB0cmlnZ2VyIHdvcmRcbiAgICAgICAgICAgICAgICBjb25zdCB0cmlnZ2VyV29yZCA9IHRoaXMuc2V0dGluZ3MuamlyYVNldHRpbmdzLnRyaWdnZXJXb3JkO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDaGVja2luZyBmb3IgdHJpZ2dlcjonLCB7XG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJXb3JkLFxuICAgICAgICAgICAgICAgICAgICBiZWZvcmVDdXJzb3IsXG4gICAgICAgICAgICAgICAgICAgIGVuZHNXaXRoOiBiZWZvcmVDdXJzb3IuZW5kc1dpdGgodHJpZ2dlcldvcmQpLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB0aGlzLnNldHRpbmdzLmppcmFTZXR0aW5ncy5lbmFibGVkXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYmVmb3JlQ3Vyc29yLmVuZHNXaXRoKHRyaWdnZXJXb3JkKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVHJpZ2dlciB3b3JkIGRldGVjdGVkLCBoYW5kbGluZyBKaXJhIHRyaWdnZXInKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVKaXJhVHJpZ2dlcihlZGl0b3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gQWRkIGNvbW1hbmQgdG8gaW5zZXJ0IEppcmEgaXNzdWVcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnaW5zZXJ0LWppcmEtaXNzdWUnLFxuICAgICAgICAgICAgbmFtZTogJ0luc2VydCBKaXJhIElzc3VlJyxcbiAgICAgICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgICAgIGlmICghdmlldykgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICghY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnRKaXJhSXNzdWUodmlldyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKHByb2Nlc3NDaGVja2JveGVzLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEVtb2ppQ2hlY2tsaXN0U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBlZGl0b3IgbWVudSBjb21tYW5kXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLW1lbnUnLCAobWVudSwgZWRpdG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVkaXRvci5nZXRTZWxlY3Rpb24oKSkge1xuICAgICAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoJ0NvcHkgYXMgRm9ybWF0dGVkIFJlcG9ydCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ2NsaXBib2FyZC1jb3B5JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB0aGlzLmZvcm1hdEFuZENvcHlUb0NsaXBib2FyZChlZGl0b3IpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZvcm1hdEFuZENvcHlUb0NsaXBib2FyZChlZGl0b3I6IEVkaXRvcikge1xuICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgIGlmICghc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyB0ZXh0IHNlbGVjdGVkJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MucmVwb3J0U2V0dGluZ3MuZW5hYmxlZCkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUmVwb3J0IGZlYXR1cmUgaXMgZGlzYWJsZWQgaW4gc2V0dGluZ3MnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgdGhlIGFwcHJvcHJpYXRlIGVtb2ppIGJhc2VkIG9uIHRhZyBhbmQgY2hlY2tlZCBzdGF0dXNcbiAgICAgICAgY29uc3QgZ2V0RW1vamkgPSAobGluZTogc3RyaW5nLCBpc0NoZWNrZWQ6IGJvb2xlYW4pOiBzdHJpbmcgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBtYXBwaW5nIG9mIHRoaXMuc2V0dGluZ3MudGFnTWFwcGluZ3MpIHtcbiAgICAgICAgICAgICAgICBpZiAobGluZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGAjJHttYXBwaW5nLnRhZy50b0xvd2VyQ2FzZSgpfWApKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpc0NoZWNrZWQgPyBtYXBwaW5nLmNoZWNrZWRFbW9qaSA6IG1hcHBpbmcudW5jaGVja2VkRW1vamk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGlzQ2hlY2tlZCA/IHRoaXMuc2V0dGluZ3MuY2hlY2tlZEVtb2ppIDogdGhpcy5zZXR0aW5ncy51bmNoZWNrZWRFbW9qaTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBQYXJzZSB0aGUgc2VsZWN0ZWQgdGV4dCB0byBmaW5kIHRhc2tzIGFuZCBzdG9wcGVyc1xuICAgICAgICBjb25zdCBsaW5lcyA9IHNlbGVjdGVkVGV4dC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGNvbnN0IHByb2Nlc3NMaW5lID0gKGxpbmU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgbGluZSA9IGxpbmUudHJpbSgpO1xuICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgnLSBbeF0nKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lLnJlcGxhY2UoJy0gW3hdJywgZ2V0RW1vamkobGluZSwgdHJ1ZSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lLnN0YXJ0c1dpdGgoJy0gWyBdJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGluZS5yZXBsYWNlKCctIFsgXScsIGdldEVtb2ppKGxpbmUsIGZhbHNlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCB0YXNrcyA9IGxpbmVzXG4gICAgICAgICAgICAuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMClcbiAgICAgICAgICAgIC5tYXAocHJvY2Vzc0xpbmUpO1xuXG4gICAgICAgIGNvbnN0IHN0b3BwZXJzID0gbGluZXNcbiAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJyNzdG9wcGVyJykpXG4gICAgICAgICAgICAubWFwKHByb2Nlc3NMaW5lKTtcblxuICAgICAgICAvLyBHZXQgdG9kYXkncyBkYXRlXG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLVVTJywgeyBcbiAgICAgICAgICAgIHdlZWtkYXk6ICdsb25nJyxcbiAgICAgICAgICAgIHllYXI6ICdudW1lcmljJyxcbiAgICAgICAgICAgIG1vbnRoOiAnbG9uZycsXG4gICAgICAgICAgICBkYXk6ICdudW1lcmljJ1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBCdWlsZCB0aGUgY29udGVudCBiYXNlZCBvbiBlbmFibGVkIHNlY3Rpb25zXG4gICAgICAgIGNvbnN0IGNvbnRlbnRQYXJ0czogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBmb3IgKGNvbnN0IHNlY3Rpb24gb2YgdGhpcy5zZXR0aW5ncy5yZXBvcnRTZXR0aW5ncy5zZWN0aW9ucykge1xuICAgICAgICAgICAgaWYgKCFzZWN0aW9uLmVuYWJsZWQpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAvLyBBZGQgc2VjdGlvbiBoZWFkZXIgaWYgZW5hYmxlZFxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MucmVwb3J0U2V0dGluZ3Muc2hvd0hlYWRlcnMgJiYgc2VjdGlvbi5zaG93SGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgY29udGVudFBhcnRzLnB1c2goYCMjIyAke3NlY3Rpb24ubmFtZX1gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWRkIHNlY3Rpb24gY29udGVudFxuICAgICAgICAgICAgbGV0IHNlY3Rpb25Db250ZW50ID0gc2VjdGlvbi5jb250ZW50O1xuICAgICAgICAgICAgc3dpdGNoIChzZWN0aW9uLm5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdEQVRFJzpcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbkNvbnRlbnQgPSBgXHVEODNEXHVEQ0M1ICR7dG9kYXl9YDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQk9EWSc6XG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb25Db250ZW50ID0gdGFza3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIodGFzayA9PiAhdGFzay50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCcjc3RvcHBlcicpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oJ1xcbicpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdTVE9QUEVSUyc6XG4gICAgICAgICAgICAgICAgICAgIHNlY3Rpb25Db250ZW50ID0gc3RvcHBlcnMuam9pbignXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc2VjdGlvbkNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50UGFydHMucHVzaChzZWN0aW9uQ29udGVudCk7XG4gICAgICAgICAgICAgICAgY29udGVudFBhcnRzLnB1c2goJycpOyAvLyBBZGQgZW1wdHkgbGluZSBhZnRlciBzZWN0aW9uXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRDb250ZW50ID0gY29udGVudFBhcnRzLmpvaW4oJ1xcbicpO1xuXG4gICAgICAgIC8vIENvcHkgdG8gY2xpcGJvYXJkXG4gICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGZvcm1hdHRlZENvbnRlbnQpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnRm9ybWF0dGVkIGNvbnRlbnQgY29waWVkIHRvIGNsaXBib2FyZCcpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnRmFpbGVkIHRvIGNvcHkgdG8gY2xpcGJvYXJkJyk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGluc2VydEppcmFJc3N1ZSh2aWV3OiBNYXJrZG93blZpZXcpIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmppcmFTZXR0aW5ncy5lbmFibGVkKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdQbGVhc2UgZW5hYmxlIGFuZCBjb25maWd1cmUgSmlyYSBpbnRlZ3JhdGlvbiBpbiBzZXR0aW5ncyBmaXJzdCcpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGppcmFDbGllbnQgPSBuZXcgSmlyYUNsaWVudCh0aGlzLnNldHRpbmdzLmppcmFTZXR0aW5ncyk7XG4gICAgICAgICAgICBjb25zdCB0YXNrcyA9IGF3YWl0IGppcmFDbGllbnQuc2VhcmNoVGFza3MoJ215IHRhc2tzJyk7XG5cbiAgICAgICAgICAgIGlmICh0YXNrcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdObyBKaXJhIHRhc2tzIGZvdW5kIGFzc2lnbmVkIHRvIHlvdScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbmV3IEppcmFUYXNrU3VnZ2VzdGVyKHRoaXMuYXBwLCB0YXNrcywgKHNlbGVjdGVkVGFzaykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvciA9IHZpZXcuZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhc2tNYXJrZG93biA9IGAtIFsgXSBbJHtzZWxlY3RlZFRhc2sua2V5fTogJHtzZWxlY3RlZFRhc2suc3VtbWFyeX1dKCR7c2VsZWN0ZWRUYXNrLnVybH0pICgke3NlbGVjdGVkVGFzay5zdGF0dXN9KWA7XG5cbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYXQgY3Vyc29yIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgdmlldy5lZGl0b3IucmVwbGFjZVJhbmdlKFxuICAgICAgICAgICAgICAgICAgICB0YXNrTWFya2Rvd24gKyAnXFxuJyxcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yLFxuICAgICAgICAgICAgICAgICAgICBjdXJzb3JcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgLy8gTW92ZSBjdXJzb3IgdG8gbmV4dCBsaW5lXG4gICAgICAgICAgICAgICAgdmlldy5lZGl0b3Iuc2V0Q3Vyc29yKHtcbiAgICAgICAgICAgICAgICAgICAgbGluZTogY3Vyc29yLmxpbmUgKyAxLFxuICAgICAgICAgICAgICAgICAgICBjaDogMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBKaXJhIHRhc2tzOicsIGVycm9yKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoZXJyb3IubWVzc2FnZSB8fCAnRXJyb3IgZmV0Y2hpbmcgSmlyYSB0YXNrcycpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVKaXJhVHJpZ2dlcihfZWRpdG9yOiBFZGl0b3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2hhbmRsZUppcmFUcmlnZ2VyIGNhbGxlZCcpO1xuXG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5qaXJhU2V0dGluZ3MuZW5hYmxlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ppcmEgaW50ZWdyYXRpb24gbm90IGVuYWJsZWQnKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1BsZWFzZSBlbmFibGUgYW5kIGNvbmZpZ3VyZSBKaXJhIGludGVncmF0aW9uIGluIHNldHRpbmdzIGZpcnN0Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NyZWF0aW5nIEppcmEgY2xpZW50IHdpdGggc2V0dGluZ3M6JywgdGhpcy5zZXR0aW5ncy5qaXJhU2V0dGluZ3MpO1xuICAgICAgICAgICAgY29uc3QgamlyYUNsaWVudCA9IG5ldyBKaXJhQ2xpZW50KHRoaXMuc2V0dGluZ3MuamlyYVNldHRpbmdzKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZldGNoaW5nIHRhc2tzLi4uJyk7XG4gICAgICAgICAgICBjb25zdCB0YXNrcyA9IGF3YWl0IGppcmFDbGllbnQuc2VhcmNoVGFza3MoJ215IHRhc2tzJyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRmV0Y2hlZCB0YXNrczonLCB0YXNrcyk7XG5cbiAgICAgICAgICAgIGlmICh0YXNrcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTm8gdGFza3MgZm91bmQnKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdObyBKaXJhIHRhc2tzIGZvdW5kIGFzc2lnbmVkIHRvIHlvdScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ09wZW5pbmcgdGFzayBzdWdnZXN0ZXIgd2l0aCcsIHRhc2tzLmxlbmd0aCwgJ3Rhc2tzJyk7XG5cbiAgICAgICAgICAgIC8vIEVuc3VyZSB3ZSdyZSBpbiB0aGUgY29ycmVjdCBjb250ZXh0XG4gICAgICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgIGlmICghYWN0aXZlVmlldykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIGFjdGl2ZSBtYXJrZG93biB2aWV3Jyk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIG9wZW4gYSBtYXJrZG93biBub3RlIGZpcnN0Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDcmVhdGUgc3VnZ2VzdGVyIHdpdGggbW9yZSByb2J1c3QgZXJyb3IgaGFuZGxpbmdcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGVyID0gbmV3IEppcmFUYXNrU3VnZ2VzdGVyKHRoaXMuYXBwLCB0YXNrcywgKHNlbGVjdGVkVGFzaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVGFzayBzZWxlY3RlZDonLCBzZWxlY3RlZFRhc2spO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmlnZ2VyV29yZCA9IHRoaXMuc2V0dGluZ3MuamlyYVNldHRpbmdzLnRyaWdnZXJXb3JkO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHRyaWdnZXIgd29yZCBhbmQgcmVwbGFjZSB3aXRoIHRoZSB0YXNrXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0xpbmUgPSBjdXJyZW50TGluZS5zbGljZSgwLCBjdXJzb3IuY2ggLSB0cmlnZ2VyV29yZC5sZW5ndGgpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgWyR7c2VsZWN0ZWRUYXNrLmtleX06ICR7c2VsZWN0ZWRUYXNrLnN1bW1hcnl9XSgke3NlbGVjdGVkVGFzay51cmx9KSAoJHtzZWxlY3RlZFRhc2suc3RhdHVzfSlgICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50TGluZS5zbGljZShjdXJzb3IuY2gpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIGN1cnJlbnQgbGluZVxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0TGluZShjdXJzb3IubGluZSwgbmV3TGluZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gTW92ZSBjdXJzb3IgdG8gZW5kIG9mIGluc2VydGVkIHRleHRcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiBjdXJzb3IubGluZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoOiBjdXJzb3IuY2ggLSB0cmlnZ2VyV29yZC5sZW5ndGggKyBgWyR7c2VsZWN0ZWRUYXNrLmtleX06ICR7c2VsZWN0ZWRUYXNrLnN1bW1hcnl9XSgke3NlbGVjdGVkVGFzay51cmx9KSAoJHtzZWxlY3RlZFRhc2suc3RhdHVzfSlgLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgbG9nZ2luZyB0byB2ZXJpZnkgc3VnZ2VzdGVyIGNyZWF0aW9uXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1N1Z2dlc3RlciBjcmVhdGVkOicsIHN1Z2dlc3Rlcik7XG4gICAgICAgICAgICB9IGNhdGNoIChzdWdnZXN0ZXJFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHN1Z2dlc3RlcjonLCBzdWdnZXN0ZXJFcnJvcik7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnRmFpbGVkIHRvIGNyZWF0ZSB0YXNrIHN1Z2dlc3RlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gaGFuZGxlSmlyYVRyaWdnZXI6JywgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShlcnJvci5tZXNzYWdlIHx8ICdFcnJvciBmZXRjaGluZyBKaXJhIHRhc2tzJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IGxvYWRlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdMb2FkZWQgZGF0YTonLCBsb2FkZWREYXRhKTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGxvYWRlZERhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZygnTWVyZ2VkIHNldHRpbmdzOicsIHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1NhdmluZyBzZXR0aW5nczonLCB0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICByZWZyZXNoQWxsTm90ZXMoKSB7XG4gICAgICAgIC8vIEZvcmNlIHJlZnJlc2ggYWxsIG1hcmtkb3duIHZpZXdzXG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS50cmlnZ2VyKCdtYXJrZG93bi1wcmV2aWV3LXJlZnJlc2gnKTtcblxuICAgICAgICAvLyBGb3JjZSByZS1yZW5kZXIgb2YgYWxsIGxlYWYgdmlld3NcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLml0ZXJhdGVBbGxMZWF2ZXMobGVhZiA9PiB7XG4gICAgICAgICAgICBpZiAobGVhZi52aWV3LmdldFZpZXdUeXBlKCkgPT09ICdtYXJrZG93bicpIHtcbiAgICAgICAgICAgICAgICAobGVhZi52aWV3IGFzIE1hcmtkb3duVmlldykucHJldmlld01vZGU/LnJlcmVuZGVyKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBuZXcgTm90aWNlKCdBcHBsaWVkIGVtb2ppIGNoYW5nZXMgdG8gYWxsIG5vdGVzJyk7XG4gICAgfVxufVxuIiwgImV4cG9ydCBpbnRlcmZhY2UgVGFnRW1vamlNYXBwaW5nIHtcbiAgICB0YWc6IHN0cmluZztcbiAgICB1bmNoZWNrZWRFbW9qaTogc3RyaW5nO1xuICAgIGNoZWNrZWRFbW9qaTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEppcmFTZXR0aW5ncyB7XG4gICAgZW5hYmxlZDogYm9vbGVhbjtcbiAgICBiYXNlVXJsOiBzdHJpbmc7XG4gICAgdXNlcm5hbWU6IHN0cmluZztcbiAgICBhcGlUb2tlbjogc3RyaW5nO1xuICAgIHRyaWdnZXJXb3JkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVwb3J0U2VjdGlvbiB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICBlbmFibGVkOiBib29sZWFuO1xuICAgIHNob3dIZWFkZXI6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVwb3J0U2V0dGluZ3Mge1xuICAgIGVuYWJsZWQ6IGJvb2xlYW47XG4gICAgc2VjdGlvbnM6IFJlcG9ydFNlY3Rpb25bXTtcbiAgICBzaG93SGVhZGVyczogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbW9qaUNoZWNrbGlzdFNldHRpbmdzIHtcbiAgICBjaGVja2VkRW1vamk6IHN0cmluZztcbiAgICB1bmNoZWNrZWRFbW9qaTogc3RyaW5nO1xuICAgIHRhZ01hcHBpbmdzOiBUYWdFbW9qaU1hcHBpbmdbXTtcbiAgICBqaXJhU2V0dGluZ3M6IEppcmFTZXR0aW5ncztcbiAgICByZXBvcnRTZXR0aW5nczogUmVwb3J0U2V0dGluZ3M7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBFbW9qaUNoZWNrbGlzdFNldHRpbmdzID0ge1xuICAgIGNoZWNrZWRFbW9qaTogJ1x1MjcwNScsXG4gICAgdW5jaGVja2VkRW1vamk6ICdcdTJCMUNcdUZFMEYnLFxuICAgIHRhZ01hcHBpbmdzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRhZzogJ3N0b3BwZXInLFxuICAgICAgICAgICAgdW5jaGVja2VkRW1vamk6ICdcdUQ4M0RcdURFRDEnLFxuICAgICAgICAgICAgY2hlY2tlZEVtb2ppOiAnXHUyNzA1J1xuICAgICAgICB9XG4gICAgXSxcbiAgICBqaXJhU2V0dGluZ3M6IHtcbiAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgIGJhc2VVcmw6ICcnLFxuICAgICAgICB1c2VybmFtZTogJycsXG4gICAgICAgIGFwaVRva2VuOiAnJyxcbiAgICAgICAgdHJpZ2dlcldvcmQ6ICdAamlyYSdcbiAgICB9LFxuICAgIHJlcG9ydFNldHRpbmdzOiB7XG4gICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgIHNob3dIZWFkZXJzOiB0cnVlLFxuICAgICAgICBzZWN0aW9uczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdHUkVFVElOR1MnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICdHb29kIE1vcm5pbmcgZXZlcnlvbmUnLFxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgc2hvd0hlYWRlcjogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnREFURScsXG4gICAgICAgICAgICAgICAgY29udGVudDogJycsXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzaG93SGVhZGVyOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnQk9EWScsXG4gICAgICAgICAgICAgICAgY29udGVudDogJycsXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzaG93SGVhZGVyOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdTVE9QUEVSUycsXG4gICAgICAgICAgICAgICAgY29udGVudDogJycsXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzaG93SGVhZGVyOiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICB9XG59OyIsICJpbXBvcnQge0FwcCwgTm90aWNlLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgRW1vamlDaGVja2xpc3RQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7REVGQVVMVF9TRVRUSU5HU30gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBFbW9qaUNoZWNrbGlzdFNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IEVtb2ppQ2hlY2tsaXN0UGx1Z2luO1xuICAgIHRlc3RFbDogSFRNTEVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBFbW9qaUNoZWNrbGlzdFBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIHVwZGF0ZVRlc3RTZWN0aW9uKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy50ZXN0RWwpIHtcbiAgICAgICAgICAgIHRoaXMudGVzdEVsLmVtcHR5KCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IHRoaXMudGVzdEVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0xpdmUgUHJldmlldycgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHVuY2hlY2tlZEV4YW1wbGUgPSB0aGlzLnRlc3RFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdzZXR0aW5nLWl0ZW0nIH0pO1xuICAgICAgICAgICAgdW5jaGVja2VkRXhhbXBsZS5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogJ1VuY2hlY2tlZCBleGFtcGxlOiAnIH0pO1xuICAgICAgICAgICAgY29uc3QgdW5jaGVja2VkQ29udGFpbmVyID0gdW5jaGVja2VkRXhhbXBsZS5jcmVhdGVFbCgnc3BhbicsIHsgY2xzOiAndGFzay1wcmV2aWV3JyB9KTtcbiAgICAgICAgICAgIHVuY2hlY2tlZENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnBsdWdpbi5zZXR0aW5ncy51bmNoZWNrZWRFbW9qaSxcbiAgICAgICAgICAgICAgICBjbHM6ICdlbW9qaS1wcmV2aWV3J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB1bmNoZWNrZWRDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICcgU2FtcGxlIHRhc2snIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBjaGVja2VkRXhhbXBsZSA9IHRoaXMudGVzdEVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3NldHRpbmctaXRlbScgfSk7XG4gICAgICAgICAgICBjaGVja2VkRXhhbXBsZS5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogJ0NoZWNrZWQgZXhhbXBsZTogJyB9KTtcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrZWRDb250YWluZXIgPSBjaGVja2VkRXhhbXBsZS5jcmVhdGVFbCgnc3BhbicsIHsgY2xzOiAndGFzay1wcmV2aWV3JyB9KTtcbiAgICAgICAgICAgIGNoZWNrZWRDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2hlY2tlZEVtb2ppLFxuICAgICAgICAgICAgICAgIGNsczogJ2Vtb2ppLXByZXZpZXcnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrZWRUZXh0ID0gY2hlY2tlZENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogJyBTYW1wbGUgdGFzaycgfSk7XG4gICAgICAgICAgICBjaGVja2VkVGV4dC5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9ICdsaW5lLXRocm91Z2gnO1xuICAgICAgICAgICAgY2hlY2tlZFRleHQuc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1tdXRlZCknO1xuXG4gICAgICAgICAgICAvLyBBZGQgdGFnIGV4YW1wbGVzXG4gICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ0hlYWRlciA9IHRoaXMudGVzdEVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1RhZyBFeGFtcGxlcycgfSk7XG4gICAgICAgICAgICAgICAgdGFnSGVhZGVyLnN0eWxlLm1hcmdpblRvcCA9ICcyZW0nO1xuICAgICAgICAgICAgICAgIHRhZ0hlYWRlci5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMWVtJztcblxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbWFwcGluZyBvZiB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdVbmNoZWNrZWRFeGFtcGxlID0gdGhpcy50ZXN0RWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnc2V0dGluZy1pdGVtJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFnVW5jaGVja2VkRXhhbXBsZS5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogYCMke21hcHBpbmcudGFnfSB1bmNoZWNrZWQ6IGAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ1VuY2hlY2tlZENvbnRhaW5lciA9IHRhZ1VuY2hlY2tlZEV4YW1wbGUuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ3Rhc2stcHJldmlldycgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ1VuY2hlY2tlZENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1hcHBpbmcudW5jaGVja2VkRW1vamksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHM6ICdlbW9qaS1wcmV2aWV3J1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFnVW5jaGVja2VkQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBgIFNhbXBsZSAjJHttYXBwaW5nLnRhZ30gdGFza2AgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnQ2hlY2tlZEV4YW1wbGUgPSB0aGlzLnRlc3RFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdzZXR0aW5nLWl0ZW0nIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YWdDaGVja2VkRXhhbXBsZS5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogYCMke21hcHBpbmcudGFnfSBjaGVja2VkOiBgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdDaGVja2VkQ29udGFpbmVyID0gdGFnQ2hlY2tlZEV4YW1wbGUuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ3Rhc2stcHJldmlldycgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NoZWNrZWRDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtYXBwaW5nLmNoZWNrZWRFbW9qaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsczogJ2Vtb2ppLXByZXZpZXcnXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdDaGVja2VkVGV4dCA9IHRhZ0NoZWNrZWRDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IGAgU2FtcGxlICMke21hcHBpbmcudGFnfSB0YXNrYCB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2hlY2tlZFRleHQuc3R5bGUudGV4dERlY29yYXRpb24gPSAnbGluZS10aHJvdWdoJztcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2hlY2tlZFRleHQuc3R5bGUuY29sb3IgPSAndmFyKC0tdGV4dC1tdXRlZCknO1xuXG4gICAgICAgICAgICAgICAgICAgIHRhZ1VuY2hlY2tlZEV4YW1wbGUuc3R5bGUubWFyZ2luQm90dG9tID0gJzAuNWVtJztcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2hlY2tlZEV4YW1wbGUuc3R5bGUubWFyZ2luQm90dG9tID0gJzAuNWVtJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGhlYWRlci5zdHlsZS5tYXJnaW5Ub3AgPSAnMmVtJztcbiAgICAgICAgICAgIGhlYWRlci5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMWVtJztcbiAgICAgICAgICAgIHVuY2hlY2tlZEV4YW1wbGUuc3R5bGUubWFyZ2luQm90dG9tID0gJzAuNWVtJztcbiAgICAgICAgICAgIGNoZWNrZWRFeGFtcGxlLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwLjVlbSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0Vtb2ppIENoZWNrbGlzdCBTZXR0aW5ncycgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGVmYXVsdCBVbmNoZWNrZWQgRW1vamknKVxuICAgICAgICAgICAgLnNldERlc2MoJ0Vtb2ppIHRvIGRpc3BsYXkgZm9yIHVuY2hlY2tlZCB0YXNrcycpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudW5jaGVja2VkRW1vamkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy51bmNoZWNrZWRFbW9qaSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUZXN0U2VjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBkYXRlZCBkZWZhdWx0IHVuY2hlY2tlZCBlbW9qaTonLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy51bmNoZWNrZWRFbW9qaSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0RlZmF1bHQgQ2hlY2tlZCBFbW9qaScpXG4gICAgICAgICAgICAuc2V0RGVzYygnRW1vamkgdG8gZGlzcGxheSBmb3IgY2hlY2tlZCB0YXNrcycpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY2hlY2tlZEVtb2ppKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2hlY2tlZEVtb2ppID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRlc3RTZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGVkIGRlZmF1bHQgY2hlY2tlZCBlbW9qaTonLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jaGVja2VkRW1vamkpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdUYWcgTWFwcGluZ3MnIH0pO1xuXG4gICAgICAgIGNvbnN0IHRhZ01hcHBpbmdzQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCd0YWctbWFwcGluZ3MnKTtcblxuICAgICAgICAvLyBBZGQgZXhpc3RpbmcgdGFnIG1hcHBpbmdzXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzLmZvckVhY2goKG1hcHBpbmcsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtYXBwaW5nQ29udGFpbmVyID0gdGFnTWFwcGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCd0YWctbWFwcGluZycpO1xuXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhtYXBwaW5nQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKGBUYWcgIyR7bWFwcGluZy50YWd9YClcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd0YWcgbmFtZScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShtYXBwaW5nLnRhZylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3NbaW5kZXhdLnRhZyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRlc3RTZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBkYXRlZCB0YWcgbWFwcGluZzonLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3VuY2hlY2tlZCBlbW9qaScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShtYXBwaW5nLnVuY2hlY2tlZEVtb2ppKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5nc1tpbmRleF0udW5jaGVja2VkRW1vamkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUZXN0U2VjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VwZGF0ZWQgdGFnIG1hcHBpbmc6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdjaGVja2VkIGVtb2ppJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKG1hcHBpbmcuY2hlY2tlZEVtb2ppKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5nc1tpbmRleF0uY2hlY2tlZEVtb2ppID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGVzdFNlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGVkIHRhZyBtYXBwaW5nOicsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCd0cmFzaCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbW92ZWQgdGFnIG1hcHBpbmcsIHJlbWFpbmluZzonLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQnV0dG9uIHRvIGFkZCBuZXcgdGFnIG1hcHBpbmdcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQWRkIFRhZyBNYXBwaW5nJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdBZGQgYSBuZXcgdGFnLWVtb2ppIG1hcHBpbmcnKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0FkZCBOZXcgVGFnJylcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnOiAnbmV3dGFnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuY2hlY2tlZEVtb2ppOiAnXHUyQjU1JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWRFbW9qaTogJ1x1MjcwNSdcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQWRkZWQgbmV3IHRhZyBtYXBwaW5nOicsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1Jlc2V0IFNldHRpbmdzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdSZXN0b3JlIGFsbCBzZXR0aW5ncyB0byB0aGVpciBkZWZhdWx0cycpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVzdG9yZSBEZWZhdWx0cycpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1Jlc2V0IHNldHRpbmdzIHRvIGRlZmF1bHRzOicsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1NldHRpbmdzIHJlc3RvcmVkIHRvIGRlZmF1bHRzJyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIEppcmEgU2V0dGluZ3NcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnSmlyYSBJbnRlZ3JhdGlvbicgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRW5hYmxlIEppcmEgSW50ZWdyYXRpb24nKVxuICAgICAgICAgICAgLnNldERlc2MoJ0VuYWJsZSBvciBkaXNhYmxlIEppcmEgaW50ZWdyYXRpb24nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmppcmFTZXR0aW5ncy5lbmFibGVkKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuamlyYVNldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1RyaWdnZXIgV29yZCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnV29yZCB0aGF0IHRyaWdnZXJzIEppcmEgdGFzayBpbnNlcnRpb24gKGUuZy4sIEBqaXJhKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0BqaXJhJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuamlyYVNldHRpbmdzLnRyaWdnZXJXb3JkKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuamlyYVNldHRpbmdzLnRyaWdnZXJXb3JkID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdKaXJhIEJhc2UgVVJMJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdZb3VyIEppcmEgaW5zdGFuY2UgVVJMIChlLmcuLCBodHRwczovL3lvdXItZG9tYWluLmF0bGFzc2lhbi5uZXQpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignaHR0cHM6Ly95b3VyLWRvbWFpbi5hdGxhc3NpYW4ubmV0JylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuamlyYVNldHRpbmdzLmJhc2VVcmwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5qaXJhU2V0dGluZ3MuYmFzZVVybCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVXNlcm5hbWUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgSmlyYSBlbWFpbCBhZGRyZXNzJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZW1haWxAZXhhbXBsZS5jb20nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5qaXJhU2V0dGluZ3MudXNlcm5hbWUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5qaXJhU2V0dGluZ3MudXNlcm5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0FQSSBUb2tlbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnWW91ciBKaXJhIEFQSSB0b2tlbiAoZnJvbSBodHRwczovL2lkLmF0bGFzc2lhbi5jb20vbWFuYWdlLXByb2ZpbGUvc2VjdXJpdHkvYXBpLXRva2VucyknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciB5b3VyIEFQSSB0b2tlbicpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmppcmFTZXR0aW5ncy5hcGlUb2tlbilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmppcmFTZXR0aW5ncy5hcGlUb2tlbiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gUmVwb3J0IFNldHRpbmdzXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHt0ZXh0OiAnUmVwb3J0IFNldHRpbmdzJ30pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBSZXBvcnQgRmVhdHVyZScpXG4gICAgICAgICAgICAuc2V0RGVzYygnRW5hYmxlL2Rpc2FibGUgdGhlIHJlcG9ydCBmb3JtYXR0aW5nIGZlYXR1cmUnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcG9ydFNldHRpbmdzLmVuYWJsZWQpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXBvcnRTZXR0aW5ncy5lbmFibGVkID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdTaG93IFNlY3Rpb24gSGVhZGVycycpXG4gICAgICAgICAgICAuc2V0RGVzYygnU2hvdy9oaWRlIHNlY3Rpb24gaGVhZGVycyBpbiB0aGUgcmVwb3J0JylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXBvcnRTZXR0aW5ncy5zaG93SGVhZGVycylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcG9ydFNldHRpbmdzLnNob3dIZWFkZXJzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyBTZWN0aW9uIFNldHRpbmdzXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHt0ZXh0OiAnUmVwb3J0IFNlY3Rpb25zJ30pO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVwb3J0U2V0dGluZ3Muc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXBvcnRTZXR0aW5ncy5zZWN0aW9uc1tpXTtcbiAgICAgICAgICAgIGNvbnN0IHNlY3Rpb25Db250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgICAgIHNlY3Rpb25Db250YWluZXIuYWRkQ2xhc3MoJ3JlcG9ydC1zZWN0aW9uLXNldHRpbmdzJyk7XG5cbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKHNlY3Rpb25Db250YWluZXIpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoYFNlY3Rpb246ICR7c2VjdGlvbi5uYW1lfWApXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ0NvbmZpZ3VyZSB0aGlzIHNlY3Rpb24nKVxuICAgICAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoc2VjdGlvbi5lbmFibGVkKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLmVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1Nob3cgc2VjdGlvbiBoZWFkZXInKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoc2VjdGlvbi5zaG93SGVhZGVyKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnNob3dIZWFkZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdTZWN0aW9uIGNvbnRlbnQnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoc2VjdGlvbi5jb250ZW50KVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLmNvbnRlbnQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgTmV3IFNlY3Rpb24gQnV0dG9uXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0FkZCBOZXcgU2VjdGlvbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnQWRkIGEgbmV3IHNlY3Rpb24gdG8gdGhlIHJlcG9ydCcpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQWRkIFNlY3Rpb24nKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVwb3J0U2V0dGluZ3Muc2VjdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnTmV3IFNlY3Rpb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogJycsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0hlYWRlcjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyBBZGQgQXBwbHkgQ2hhbmdlcyBidXR0b25cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQXBwbHkgQ2hhbmdlcycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQXBwbHkgZW1vamkgY2hhbmdlcyB0byBhbGwgb3BlbiBub3RlcycpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQXBwbHkgQ2hhbmdlcycpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5yZWZyZXNoQWxsTm90ZXMoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgdGhpcy50ZXN0RWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXN0U2VjdGlvbigpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgdHlwZSB7TWFya2Rvd25Qb3N0UHJvY2Vzc29yLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0fSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQge01hcmtkb3duUmVuZGVyQ2hpbGQsIE1hcmtkb3duVmlld30gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHR5cGUgRW1vamlDaGVja2xpc3RQbHVnaW4gZnJvbSAnLi9tYWluJztcblxuaW50ZXJmYWNlIEVkaXRvckNoYW5nZSB7XG4gICAgZnJvbTogeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfTtcbiAgICB0bzogeyBsaW5lOiBudW1iZXI7IGNoOiBudW1iZXIgfTtcbiAgICB0ZXh0OiBzdHJpbmc7XG59XG5cbmNsYXNzIEVtb2ppUmVuZGVyQ2hpbGQgZXh0ZW5kcyBNYXJrZG93blJlbmRlckNoaWxkIHtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IHNwYW46IEhUTUxTcGFuRWxlbWVudCkge1xuICAgICAgICBzdXBlcihzcGFuKTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpOiB2b2lkIHtcbiAgICAgICAgLy8gQ2xlYW51cCBoYW5kbGVkIGJ5IHBhcmVudFxuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIENoZWNrYm94UHJvY2Vzc29yIHtcbiAgICBwcml2YXRlIHN0YXRpYyBmaW5kVGFnSW5MaW5lKGxpc3RJdGVtOiBIVE1MRWxlbWVudCk6IHN0cmluZyB8IG51bGwge1xuICAgICAgICBjb25zdCB0ZXh0ID0gbGlzdEl0ZW0udGV4dENvbnRlbnQgfHwgJyc7XG4gICAgICAgIGNvbnN0IHRhZ01hdGNoID0gdGV4dC5yZXBsYWNlKC9eW15cXHdcXHMjXSpcXHMqLywgJycpLm1hdGNoKC8jKFxcdyspLyk7XG4gICAgICAgIHJldHVybiB0YWdNYXRjaCA/IHRhZ01hdGNoWzFdIDogbnVsbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBnZXRFbW9qaXNGb3JUYWcoXG4gICAgICAgIHBsdWdpbjogRW1vamlDaGVja2xpc3RQbHVnaW4sXG4gICAgICAgIHRhZzogc3RyaW5nIHwgbnVsbCxcbiAgICAgICAgaXNDaGVja2VkOiBib29sZWFuXG4gICAgKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF0YWcpIHtcbiAgICAgICAgICAgIHJldHVybiBpc0NoZWNrZWQgPyBwbHVnaW4uc2V0dGluZ3MuY2hlY2tlZEVtb2ppIDogcGx1Z2luLnNldHRpbmdzLnVuY2hlY2tlZEVtb2ppO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbWFwcGluZyA9IHBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncy5maW5kKChtKSA9PiBtLnRhZyA9PT0gdGFnKTtcbiAgICAgICAgaWYgKCFtYXBwaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNDaGVja2VkID8gcGx1Z2luLnNldHRpbmdzLmNoZWNrZWRFbW9qaSA6IHBsdWdpbi5zZXR0aW5ncy51bmNoZWNrZWRFbW9qaTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpc0NoZWNrZWQgPyBtYXBwaW5nLmNoZWNrZWRFbW9qaSA6IG1hcHBpbmcudW5jaGVja2VkRW1vamk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgdXBkYXRlRWRpdG9yQ29udGVudChcbiAgICAgICAgZWRpdG9yOiBhbnksXG4gICAgICAgIGxpbmVJbmRleDogbnVtYmVyLFxuICAgICAgICBuZXdFbW9qaTogc3RyaW5nXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGxpbmVUZXh0ID0gZWRpdG9yLmdldExpbmUobGluZUluZGV4KTtcbiAgICAgICAgY29uc3QgbmV3VGV4dCA9IGxpbmVUZXh0LnJlcGxhY2UoL15bXlxcd1xccyNdKlxccyovLCBgJHtuZXdFbW9qaX0gYCk7XG5cbiAgICAgICAgY29uc3QgY2hhbmdlOiBFZGl0b3JDaGFuZ2UgPSB7XG4gICAgICAgICAgICBmcm9tOiB7IGxpbmU6IGxpbmVJbmRleCwgY2g6IDAgfSxcbiAgICAgICAgICAgIHRvOiB7IGxpbmU6IGxpbmVJbmRleCwgY2g6IGxpbmVUZXh0Lmxlbmd0aCB9LFxuICAgICAgICAgICAgdGV4dDogbmV3VGV4dFxuICAgICAgICB9O1xuXG4gICAgICAgIGVkaXRvci50cmFuc2FjdGlvbih7IGNoYW5nZXM6IFtjaGFuZ2VdIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIGNyZWF0ZUVtb2ppU3BhbihlbW9qaTogc3RyaW5nKTogSFRNTFNwYW5FbGVtZW50IHtcbiAgICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgc3Bhbi5jbGFzc05hbWUgPSAndGFzay1saXN0LWVtb2ppJztcbiAgICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IGVtb2ppO1xuICAgICAgICByZXR1cm4gc3BhbjtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBzdHlsZUNvbnRhaW5lcihjb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCk6IHZvaWQge1xuICAgICAgICBpZiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snO1xuICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLnZlcnRpY2FsQWxpZ24gPSAndG9wJztcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5tYXJnaW5SaWdodCA9ICcwLjVlbSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBzZXR1cEV2ZW50TGlzdGVuZXJzKFxuICAgICAgICBwbHVnaW46IEVtb2ppQ2hlY2tsaXN0UGx1Z2luLFxuICAgICAgICBjaGVja2JveDogSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgc3BhbjogSFRNTFNwYW5FbGVtZW50LFxuICAgICAgICB0YWc6IHN0cmluZyB8IG51bGwsXG4gICAgICAgIGluZGV4OiBudW1iZXIsXG4gICAgICAgIGVkaXRvcjogYW55LFxuICAgICAgICBzZWN0aW9uSW5mbzogYW55LFxuICAgICAgICBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHRcbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdXBkYXRlRW1vamkgPSAoaXNDaGVja2VkOiBib29sZWFuKTogdm9pZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdFbW9qaSA9IHRoaXMuZ2V0RW1vamlzRm9yVGFnKHBsdWdpbiwgdGFnLCBpc0NoZWNrZWQpO1xuICAgICAgICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IG5ld0Vtb2ppO1xuXG4gICAgICAgICAgICBpZiAoZWRpdG9yICYmIHNlY3Rpb25JbmZvKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFZGl0b3JDb250ZW50KGVkaXRvciwgc2VjdGlvbkluZm8ubGluZVN0YXJ0ICsgaW5kZXgsIG5ld0Vtb2ppKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCB0b2dnbGVDaGVja2JveCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSAhY2hlY2tib3guY2hlY2tlZDtcbiAgICAgICAgICAgIHVwZGF0ZUVtb2ppKGNoZWNrYm94LmNoZWNrZWQpO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgYW5kIGRpc3BhdGNoIGJvdGggY2hhbmdlIGFuZCBjbGljayBldmVudHNcbiAgICAgICAgICAgIGNoZWNrYm94LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdjaGFuZ2UnLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICAgICAgICAgICAgY2hlY2tib3guZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2NsaWNrJywgeyBidWJibGVzOiB0cnVlIH0pKTtcblxuICAgICAgICAgICAgaWYgKGN0eC5zb3VyY2VQYXRoKSB7XG4gICAgICAgICAgICAgICAgY3R4LmFkZENoaWxkKG5ldyBFbW9qaVJlbmRlckNoaWxkKHNwYW4pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBzcGFuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBhd2FpdCB0b2dnbGVDaGVja2JveCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICB1cGRhdGVFbW9qaShjaGVja2JveC5jaGVja2VkKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBwcm9jZXNzQ2hlY2tib3goXG4gICAgICAgIHBsdWdpbjogRW1vamlDaGVja2xpc3RQbHVnaW4sXG4gICAgICAgIGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBpbmRleDogbnVtYmVyLFxuICAgICAgICBlZGl0b3I6IGFueSxcbiAgICAgICAgc2VjdGlvbkluZm86IGFueSxcbiAgICAgICAgY3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0XG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGxpc3RJdGVtID0gY2hlY2tib3guY2xvc2VzdCgnbGkudGFzay1saXN0LWl0ZW0nKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgaWYgKCFsaXN0SXRlbSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IHRhZyA9IHRoaXMuZmluZFRhZ0luTGluZShsaXN0SXRlbSk7XG4gICAgICAgIGNvbnN0IGVtb2ppID0gdGhpcy5nZXRFbW9qaXNGb3JUYWcocGx1Z2luLCB0YWcsIGNoZWNrYm94LmNoZWNrZWQpO1xuICAgICAgICBjb25zdCBzcGFuID0gdGhpcy5jcmVhdGVFbW9qaVNwYW4oZW1vamkpO1xuXG4gICAgICAgIGlmIChlZGl0b3IgJiYgc2VjdGlvbkluZm8pIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRWRpdG9yQ29udGVudChlZGl0b3IsIHNlY3Rpb25JbmZvLmxpbmVTdGFydCArIGluZGV4LCBlbW9qaSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldHVwRXZlbnRMaXN0ZW5lcnMoXG4gICAgICAgICAgICBwbHVnaW4sXG4gICAgICAgICAgICBjaGVja2JveCxcbiAgICAgICAgICAgIHNwYW4sXG4gICAgICAgICAgICB0YWcsXG4gICAgICAgICAgICBpbmRleCxcbiAgICAgICAgICAgIGVkaXRvcixcbiAgICAgICAgICAgIHNlY3Rpb25JbmZvLFxuICAgICAgICAgICAgY3R4XG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5zdHlsZUNvbnRhaW5lcihjaGVja2JveC5wYXJlbnRFbGVtZW50KTtcbiAgICAgICAgY2hlY2tib3guc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgY2hlY2tib3guYWZ0ZXIoc3Bhbik7XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgcHJvY2Vzc0NoZWNrYm94ZXM6IE1hcmtkb3duUG9zdFByb2Nlc3NvciA9IGZ1bmN0aW9uKFxuICAgIHRoaXM6IEVtb2ppQ2hlY2tsaXN0UGx1Z2luLFxuICAgIGVsOiBIVE1MRWxlbWVudCxcbiAgICBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHRcbik6IHZvaWQge1xuICAgIGNvbnN0IGNoZWNrYm94ZXMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxJbnB1dEVsZW1lbnQ+KCdsaS50YXNrLWxpc3QtaXRlbSBpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcbiAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICBjb25zdCBlZGl0b3IgPSB2aWV3Py5lZGl0b3I7XG4gICAgY29uc3Qgc2VjdGlvbkluZm8gPSBjdHguZ2V0U2VjdGlvbkluZm8oZWwpO1xuXG4gICAgY2hlY2tib3hlcy5mb3JFYWNoKChjaGVja2JveCwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKCEoY2hlY2tib3ggaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSkgcmV0dXJuO1xuXG4gICAgICAgIENoZWNrYm94UHJvY2Vzc29yLnByb2Nlc3NDaGVja2JveChcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICBjaGVja2JveCxcbiAgICAgICAgICAgIGluZGV4LFxuICAgICAgICAgICAgZWRpdG9yLFxuICAgICAgICAgICAgc2VjdGlvbkluZm8sXG4gICAgICAgICAgICBjdHhcbiAgICAgICAgKTtcbiAgICB9KTtcbn07XG4iLCAiaW1wb3J0IHsgcmVxdWVzdFVybCwgUmVxdWVzdFVybFBhcmFtIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHR5cGUgeyBKaXJhU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBKaXJhVGFzayB7XG4gICAga2V5OiBzdHJpbmc7XG4gICAgc3VtbWFyeTogc3RyaW5nO1xuICAgIHVybDogc3RyaW5nO1xuICAgIHN0YXR1czogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgSmlyYUNsaWVudCB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzZXR0aW5nczogSmlyYVNldHRpbmdzKSB7fVxuXG4gICAgcHJpdmF0ZSBnZXRBdXRoSGVhZGVyKCk6IHN0cmluZyB7XG4gICAgICAgIC8vIEVuc3VyZSB3ZSdyZSB1c2luZyB0aGUgZW1haWwgYWRkcmVzcyBhbmQgQVBJIHRva2VuXG4gICAgICAgIGNvbnN0IGNyZWRlbnRpYWxzID0gYCR7dGhpcy5zZXR0aW5ncy51c2VybmFtZX06JHt0aGlzLnNldHRpbmdzLmFwaVRva2VufWA7XG4gICAgICAgIC8vIENvbnZlcnQgdG8gYmFzZTY0LCBoYW5kbGluZyBVbmljb2RlIGNoYXJhY3RlcnMgY29ycmVjdGx5XG4gICAgICAgIGNvbnN0IGJhc2U2NENyZWRlbnRpYWxzID0gQnVmZmVyLmZyb20oY3JlZGVudGlhbHMpLnRvU3RyaW5nKCdiYXNlNjQnKTtcbiAgICAgICAgcmV0dXJuIGBCYXNpYyAke2Jhc2U2NENyZWRlbnRpYWxzfWA7XG4gICAgfVxuXG4gICAgYXN5bmMgdGVzdENvbm5lY3Rpb24oKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IGJhc2VVcmwgPSB0aGlzLnNldHRpbmdzLmJhc2VVcmwucmVwbGFjZSgvXFwvJC8sICcnKTtcbiAgICAgICAgY29uc3QgYXBpVXJsID0gYCR7YmFzZVVybH0vcmVzdC9hcGkvMi9teXNlbGZgO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgIHVybDogYXBpVXJsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IHRoaXMuZ2V0QXV0aEhlYWRlcigpLFxuICAgICAgICAgICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMgPT09IDIwMDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Nvbm5lY3Rpb24gdGVzdCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgc2VhcmNoVGFza3MocXVlcnk6IHN0cmluZyk6IFByb21pc2U8SmlyYVRhc2tbXT4ge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuZW5hYmxlZCB8fCAhdGhpcy5zZXR0aW5ncy5iYXNlVXJsIHx8ICF0aGlzLnNldHRpbmdzLmFwaVRva2VuKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ppcmEgaW50ZWdyYXRpb24gaXMgbm90IHByb3Blcmx5IGNvbmZpZ3VyZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRlc3QgY29ubmVjdGlvbiBmaXJzdFxuICAgICAgICBjb25zdCBpc0Nvbm5lY3RlZCA9IGF3YWl0IHRoaXMudGVzdENvbm5lY3Rpb24oKTtcbiAgICAgICAgaWYgKCFpc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgYXV0aGVudGljYXRlIHdpdGggSmlyYS4gUGxlYXNlIGNoZWNrIHlvdXIgY3JlZGVudGlhbHMuJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFbnN1cmUgdGhlIGJhc2UgVVJMIGRvZXNuJ3QgZW5kIHdpdGggYSBzbGFzaFxuICAgICAgICBjb25zdCBiYXNlVXJsID0gdGhpcy5zZXR0aW5ncy5iYXNlVXJsLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBDbGVhbiB1cCB0aGUgcXVlcnkgdG8gcHJldmVudCBKUUwgaW5qZWN0aW9uXG4gICAgICAgIGNvbnN0IHNhbml0aXplZFF1ZXJ5ID0gcXVlcnkucmVwbGFjZSgvW1wiJ10vZywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gSGFuZGxlIHNwZWNpYWwgcXVlcmllc1xuICAgICAgICBsZXQganFsOiBzdHJpbmc7XG4gICAgICAgIGlmIChzYW5pdGl6ZWRRdWVyeS50b0xvd2VyQ2FzZSgpID09PSAnbXkgdGFza3MnIHx8IHNhbml0aXplZFF1ZXJ5LnRvTG93ZXJDYXNlKCkgPT09ICdhc3NpZ25lZCB0byBtZScpIHtcbiAgICAgICAgICAgIGpxbCA9ICdhc3NpZ25lZSA9IGN1cnJlbnRVc2VyKCknO1xuICAgICAgICB9IGVsc2UgaWYgKHNhbml0aXplZFF1ZXJ5LnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnbXknKSkge1xuICAgICAgICAgICAgLy8gSGFuZGxlIFwibXkgb3BlbiB0YXNrc1wiLCBcIm15IGRvbmUgdGFza3NcIiwgZXRjLlxuICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gc2FuaXRpemVkUXVlcnkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnZG9uZScpID8gJ0RvbmUnIDogXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNhbml0aXplZFF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ29wZW4nKSA/ICdPcGVuJyA6IG51bGw7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGpxbCA9IHN0YXR1cyBcbiAgICAgICAgICAgICAgICA/IGBhc3NpZ25lZSA9IGN1cnJlbnRVc2VyKCkgQU5EIHN0YXR1cyA9IFwiJHtzdGF0dXN9XCJgXG4gICAgICAgICAgICAgICAgOiBgYXNzaWduZWUgPSBjdXJyZW50VXNlcigpIEFORCAoc3VtbWFyeSB+IFwiJHtzYW5pdGl6ZWRRdWVyeX1cIiBPUiBkZXNjcmlwdGlvbiB+IFwiJHtzYW5pdGl6ZWRRdWVyeX1cIilgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAganFsID0gYGFzc2lnbmVlID0gY3VycmVudFVzZXIoKSBBTkQgKHN1bW1hcnkgfiBcIiR7c2FuaXRpemVkUXVlcnl9XCIgT1IgZGVzY3JpcHRpb24gfiBcIiR7c2FuaXRpemVkUXVlcnl9XCIpYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGpxbCArPSAnIE9SREVSIEJZIHVwZGF0ZWQgREVTQyc7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnSlFMIFF1ZXJ5OicsIGpxbCk7XG4gICAgICAgIGNvbnN0IGFwaVVybCA9IGAke2Jhc2VVcmx9L3Jlc3QvYXBpLzIvc2VhcmNoP2pxbD0ke2VuY29kZVVSSUNvbXBvbmVudChqcWwpfSZtYXhSZXN1bHRzPTEwJmZpZWxkcz1zdW1tYXJ5LHN0YXR1c2A7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBUEkgVVJMOicsIGFwaVVybCk7XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdFBhcmFtczogUmVxdWVzdFVybFBhcmFtID0ge1xuICAgICAgICAgICAgdXJsOiBhcGlVcmwsXG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogdGhpcy5nZXRBdXRoSGVhZGVyKCksXG4gICAgICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTWFraW5nIHJlcXVlc3QuLi4nKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybChyZXF1ZXN0UGFyYW1zKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSBzdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVzcG9uc2U6JywgcmVzcG9uc2UudGV4dCk7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBKaXJhIEFQSSByZXR1cm5lZCBzdGF0dXMgJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnRleHR9YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2UuanNvbiB8fCAhcmVzcG9uc2UuanNvbi5pc3N1ZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIHJlc3BvbnNlIGZvcm1hdDonLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHJlc3BvbnNlIGZvcm1hdCBmcm9tIEppcmEgQVBJJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBpc3N1ZXM6JywgcmVzcG9uc2UuanNvbi5pc3N1ZXMubGVuZ3RoKTtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uLmlzc3Vlcy5tYXAoKGlzc3VlOiBhbnkpID0+ICh7XG4gICAgICAgICAgICAgICAga2V5OiBpc3N1ZS5rZXksXG4gICAgICAgICAgICAgICAgc3VtbWFyeTogaXNzdWUuZmllbGRzLnN1bW1hcnksXG4gICAgICAgICAgICAgICAgdXJsOiBgJHtiYXNlVXJsfS9icm93c2UvJHtpc3N1ZS5rZXl9YCxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGlzc3VlLmZpZWxkcy5zdGF0dXM/Lm5hbWUgfHwgJ1Vua25vd24nXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZXRhaWxzOicsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgICAgIHN0YXR1czogZXJyb3Iuc3RhdHVzLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlOiBlcnJvci5yZXNwb25zZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMSB8fCBlcnJvci5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQXV0aGVudGljYXRpb24gZmFpbGVkLiBQbGVhc2UgdmVyaWZ5OlxcbjEuIFlvdXIgZW1haWwgYWRkcmVzcyBpcyBjb3JyZWN0XFxuMi4gWW91ciBBUEkgdG9rZW4gaXMgY29ycmVjdFxcbjMuIFlvdSBoYXZlIHRoZSBuZWNlc3NhcnkgcGVybWlzc2lvbnMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZm9ybWF0VGFza3NBc01hcmtkb3duKHRhc2tzOiBKaXJhVGFza1tdKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIHRhc2tzLm1hcCh0YXNrID0+IFxuICAgICAgICAgICAgYC0gWyBdIFske3Rhc2sua2V5fTogJHt0YXNrLnN1bW1hcnl9XSgke3Rhc2sudXJsfSkgKCR7dGFzay5zdGF0dXN9KWBcbiAgICAgICAgKS5qb2luKCdcXG4nKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBJU3VnZ2VzdE93bmVyLCBTY29wZSwgU3VnZ2VzdE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHR5cGUgeyBKaXJhVGFzayB9IGZyb20gJy4vamlyYSc7XG5cbmV4cG9ydCBjbGFzcyBKaXJhVGFza1N1Z2dlc3RlciBleHRlbmRzIFN1Z2dlc3RNb2RhbDxKaXJhVGFzaz4ge1xuICAgIHByaXZhdGUgdGFza3M6IEppcmFUYXNrW10gPSBbXTtcbiAgICBwcml2YXRlIG9uU2VsZWN0OiAodGFzazogSmlyYVRhc2spID0+IHZvaWQ7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGFza3M6IEppcmFUYXNrW10sIG9uU2VsZWN0OiAodGFzazogSmlyYVRhc2spID0+IHZvaWQpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgY29uc29sZS5sb2coJ0ppcmFUYXNrU3VnZ2VzdGVyIGNvbnN0cnVjdG9yIGNhbGxlZCcpO1xuICAgICAgICBjb25zb2xlLmxvZygnVGFza3MgcmVjZWl2ZWQ6JywgdGFza3MpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy50YXNrcyA9IHRhc2tzO1xuICAgICAgICB0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XG4gICAgICAgIFxuICAgICAgICAvLyBFeHBsaWNpdGx5IHNldCBwbGFjZWhvbGRlciBhbmQgc3R5bGluZ1xuICAgICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKFwiU2VsZWN0IGEgSmlyYSB0YXNrLi4uXCIpO1xuICAgICAgICBcbiAgICAgICAgLy8gRW5zdXJlIHRoZSBtb2RhbCBpcyBzdHlsZWQgYW5kIHZpc2libGVcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcygnamlyYS10YXNrLXN1Z2dlc3RlcicpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2VudGVyIHRoZSBtb2RhbFxuICAgICAgICB0aGlzLm1vZGFsRWwuc3R5bGUubWF4V2lkdGggPSAnNjAwcHgnO1xuICAgICAgICB0aGlzLm1vZGFsRWwuc3R5bGUud2lkdGggPSAnODAlJztcbiAgICAgICAgdGhpcy5tb2RhbEVsLnN0eWxlLnRvcCA9ICczMCUnO1xuICAgICAgICB0aGlzLm1vZGFsRWwuc3R5bGUubGVmdCA9ICc1MCUnO1xuICAgICAgICB0aGlzLm1vZGFsRWwuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgtNTAlLCAtMzAlKSc7XG4gICAgICAgIHRoaXMubW9kYWxFbC5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XG4gICAgICAgIFxuICAgICAgICAvLyBTdHlsZSB0aGUgc3VnZ2VzdGlvbnMgY29udGFpbmVyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zQ29udGFpbmVyID0gdGhpcy5tb2RhbEVsLnF1ZXJ5U2VsZWN0b3IoJy5zdWdnZXN0aW9uLWNvbnRhaW5lcicpO1xuICAgICAgICBpZiAoc3VnZ2VzdGlvbnNDb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnNDb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gJzQwMHB4JztcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zQ29udGFpbmVyLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDbG9zZSBvbiBFc2NhcGVcbiAgICAgICAgdGhpcy5zY29wZSA9IG5ldyBTY29wZSgpO1xuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVzY2FwZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEV4cGxpY2l0bHkgb3BlbiB0aGUgbW9kYWxcbiAgICAgICAgY29uc29sZS5sb2coJ0Fib3V0IHRvIG9wZW4gbW9kYWwnKTtcbiAgICAgICAgdGhpcy5vcGVuKCk7XG4gICAgfVxuXG4gICAgLy8gT3ZlcnJpZGUgb3BlbiBtZXRob2QgdG8gZW5zdXJlIGl0J3MgZnVsbHkgdmlzaWJsZVxuICAgIG9wZW4oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdFeHBsaWNpdGx5IG9wZW5pbmcgbW9kYWwnKTtcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkaXRpb25hbCB2aXNpYmlsaXR5IGNoZWNrc1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuc3R5bGUub3BhY2l0eSA9ICcxJztcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogSmlyYVRhc2tbXSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdHZXR0aW5nIHN1Z2dlc3Rpb25zIGZvciBxdWVyeTonLCBxdWVyeSk7XG4gICAgICAgIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFRhc2tzID0gdGhpcy50YXNrcy5maWx0ZXIodGFzayA9PiBcbiAgICAgICAgICAgIHRhc2sua2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSkgfHxcbiAgICAgICAgICAgIHRhc2suc3VtbWFyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpXG4gICAgICAgICk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdGaWx0ZXJlZCB0YXNrczonLCBmaWx0ZXJlZFRhc2tzKTtcbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkVGFza3M7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih0YXNrOiBKaXJhVGFzaywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdSZW5kZXJpbmcgc3VnZ2VzdGlvbiBmb3IgdGFzazonLCB0YXNrKTtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcImppcmEtdGFzay1zdWdnZXN0aW9uXCIgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBrZXlFbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiamlyYS1rZXlcIiB9KTtcbiAgICAgICAga2V5RWwuc2V0VGV4dCh0YXNrLmtleSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdW1tYXJ5RWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImppcmEtc3VtbWFyeVwiIH0pO1xuICAgICAgICBzdW1tYXJ5RWwuc2V0VGV4dCh0YXNrLnN1bW1hcnkpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3RhdHVzRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImppcmEtc3RhdHVzXCIgfSk7XG4gICAgICAgIHN0YXR1c0VsLnNldFRleHQodGFzay5zdGF0dXMpO1xuXG4gICAgICAgIC8vIEFkZCBzdHlsZXMgaW5saW5lIHNpbmNlIHdlIGNhbid0IG1vZGlmeSB0aGUgQ1NTIGZpbGVcbiAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuICAgICAgICBlbC5zdHlsZS5mbGV4RGlyZWN0aW9uID0gXCJjb2x1bW5cIjtcbiAgICAgICAgZWwuc3R5bGUuZ2FwID0gXCI0cHhcIjtcbiAgICAgICAga2V5RWwuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xuICAgICAgICBrZXlFbC5zdHlsZS5jb2xvciA9IFwidmFyKC0tdGV4dC1hY2NlbnQpXCI7XG4gICAgICAgIHN0YXR1c0VsLnN0eWxlLmZvbnRTaXplID0gXCIwLjhlbVwiO1xuICAgICAgICBzdGF0dXNFbC5zdHlsZS5jb2xvciA9IFwidmFyKC0tdGV4dC1tdXRlZClcIjtcbiAgICAgICAgc3RhdHVzRWwuc3R5bGUuZm9udFN0eWxlID0gXCJpdGFsaWNcIjtcbiAgICB9XG5cbiAgICBvbkNob29zZVN1Z2dlc3Rpb24odGFzazogSmlyYVRhc2ssIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1Rhc2sgY2hvc2VuOicsIHRhc2spO1xuICAgICAgICAvLyBFbnN1cmUgdGhlIG9uU2VsZWN0IGNhbGxiYWNrIGlzIGNhbGxlZFxuICAgICAgICBpZiAodGhpcy5vblNlbGVjdCkge1xuICAgICAgICAgICAgdGhpcy5vblNlbGVjdCh0YXNrKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQSx1QkFBd0U7OztBQ21DakUsSUFBTSxtQkFBMkM7QUFBQSxFQUNwRCxjQUFjO0FBQUEsRUFDZCxnQkFBZ0I7QUFBQSxFQUNoQixhQUFhO0FBQUEsSUFDVDtBQUFBLE1BQ0ksS0FBSztBQUFBLE1BQ0wsZ0JBQWdCO0FBQUEsTUFDaEIsY0FBYztBQUFBO0FBQUE7QUFBQSxFQUd0QixjQUFjO0FBQUEsSUFDVixTQUFTO0FBQUEsSUFDVCxTQUFTO0FBQUEsSUFDVCxVQUFVO0FBQUEsSUFDVixVQUFVO0FBQUEsSUFDVixhQUFhO0FBQUE7QUFBQSxFQUVqQixnQkFBZ0I7QUFBQSxJQUNaLFNBQVM7QUFBQSxJQUNULGFBQWE7QUFBQSxJQUNiLFVBQVU7QUFBQSxNQUNOO0FBQUEsUUFDSSxNQUFNO0FBQUEsUUFDTixTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsUUFDVCxZQUFZO0FBQUE7QUFBQSxNQUVoQjtBQUFBLFFBQ0ksTUFBTTtBQUFBLFFBQ04sU0FBUztBQUFBLFFBQ1QsU0FBUztBQUFBLFFBQ1QsWUFBWTtBQUFBO0FBQUEsTUFFaEI7QUFBQSxRQUNJLE1BQU07QUFBQSxRQUNOLFNBQVM7QUFBQSxRQUNULFNBQVM7QUFBQSxRQUNULFlBQVk7QUFBQTtBQUFBLE1BRWhCO0FBQUEsUUFDSSxNQUFNO0FBQUEsUUFDTixTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsUUFDVCxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBQUE7OztBQzlFNUIsc0JBQXFEO0FBSTlDLDZDQUF1QyxpQ0FBaUI7QUFBQSxFQUkzRCxZQUFZLEtBQVUsUUFBOEI7QUFDaEQsVUFBTSxLQUFLO0FBQ1gsU0FBSyxTQUFTO0FBQUE7QUFBQSxFQUdsQixvQkFBMEI7QUFDdEIsUUFBSSxLQUFLLFFBQVE7QUFDYixXQUFLLE9BQU87QUFFWixZQUFNLFNBQVMsS0FBSyxPQUFPLFNBQVMsTUFBTSxFQUFFLE1BQU07QUFFbEQsWUFBTSxtQkFBbUIsS0FBSyxPQUFPLFNBQVMsT0FBTyxFQUFFLEtBQUs7QUFDNUQsdUJBQWlCLFNBQVMsUUFBUSxFQUFFLE1BQU07QUFDMUMsWUFBTSxxQkFBcUIsaUJBQWlCLFNBQVMsUUFBUSxFQUFFLEtBQUs7QUFDcEUseUJBQW1CLFNBQVMsUUFBUTtBQUFBLFFBQ2hDLE1BQU0sS0FBSyxPQUFPLFNBQVM7QUFBQSxRQUMzQixLQUFLO0FBQUE7QUFFVCx5QkFBbUIsU0FBUyxRQUFRLEVBQUUsTUFBTTtBQUU1QyxZQUFNLGlCQUFpQixLQUFLLE9BQU8sU0FBUyxPQUFPLEVBQUUsS0FBSztBQUMxRCxxQkFBZSxTQUFTLFFBQVEsRUFBRSxNQUFNO0FBQ3hDLFlBQU0sbUJBQW1CLGVBQWUsU0FBUyxRQUFRLEVBQUUsS0FBSztBQUNoRSx1QkFBaUIsU0FBUyxRQUFRO0FBQUEsUUFDOUIsTUFBTSxLQUFLLE9BQU8sU0FBUztBQUFBLFFBQzNCLEtBQUs7QUFBQTtBQUVULFlBQU0sY0FBYyxpQkFBaUIsU0FBUyxRQUFRLEVBQUUsTUFBTTtBQUM5RCxrQkFBWSxNQUFNLGlCQUFpQjtBQUNuQyxrQkFBWSxNQUFNLFFBQVE7QUFHMUIsVUFBSSxLQUFLLE9BQU8sU0FBUyxZQUFZLFNBQVMsR0FBRztBQUM3QyxjQUFNLFlBQVksS0FBSyxPQUFPLFNBQVMsTUFBTSxFQUFFLE1BQU07QUFDckQsa0JBQVUsTUFBTSxZQUFZO0FBQzVCLGtCQUFVLE1BQU0sZUFBZTtBQUUvQixtQkFBVyxXQUFXLEtBQUssT0FBTyxTQUFTLGFBQWE7QUFDcEQsZ0JBQU0sc0JBQXNCLEtBQUssT0FBTyxTQUFTLE9BQU8sRUFBRSxLQUFLO0FBQy9ELDhCQUFvQixTQUFTLFFBQVEsRUFBRSxNQUFNLElBQUksUUFBUTtBQUN6RCxnQkFBTSx3QkFBd0Isb0JBQW9CLFNBQVMsUUFBUSxFQUFFLEtBQUs7QUFDMUUsZ0NBQXNCLFNBQVMsUUFBUTtBQUFBLFlBQ25DLE1BQU0sUUFBUTtBQUFBLFlBQ2QsS0FBSztBQUFBO0FBRVQsZ0NBQXNCLFNBQVMsUUFBUSxFQUFFLE1BQU0sWUFBWSxRQUFRO0FBRW5FLGdCQUFNLG9CQUFvQixLQUFLLE9BQU8sU0FBUyxPQUFPLEVBQUUsS0FBSztBQUM3RCw0QkFBa0IsU0FBUyxRQUFRLEVBQUUsTUFBTSxJQUFJLFFBQVE7QUFDdkQsZ0JBQU0sc0JBQXNCLGtCQUFrQixTQUFTLFFBQVEsRUFBRSxLQUFLO0FBQ3RFLDhCQUFvQixTQUFTLFFBQVE7QUFBQSxZQUNqQyxNQUFNLFFBQVE7QUFBQSxZQUNkLEtBQUs7QUFBQTtBQUVULGdCQUFNLGlCQUFpQixvQkFBb0IsU0FBUyxRQUFRLEVBQUUsTUFBTSxZQUFZLFFBQVE7QUFDeEYseUJBQWUsTUFBTSxpQkFBaUI7QUFDdEMseUJBQWUsTUFBTSxRQUFRO0FBRTdCLDhCQUFvQixNQUFNLGVBQWU7QUFDekMsNEJBQWtCLE1BQU0sZUFBZTtBQUFBO0FBQUE7QUFJL0MsYUFBTyxNQUFNLFlBQVk7QUFDekIsYUFBTyxNQUFNLGVBQWU7QUFDNUIsdUJBQWlCLE1BQU0sZUFBZTtBQUN0QyxxQkFBZSxNQUFNLGVBQWU7QUFBQTtBQUFBO0FBQUEsRUFJNUMsVUFBZ0I7QUFDWixVQUFNLEVBQUUsZ0JBQWdCO0FBQ3hCLGdCQUFZO0FBRVosZ0JBQVksU0FBUyxNQUFNLEVBQUUsTUFBTTtBQUVuQyxRQUFJLHdCQUFRLGFBQ1AsUUFBUSwyQkFDUixRQUFRLHdDQUNSLFFBQVEsVUFBUSxLQUNaLFNBQVMsS0FBSyxPQUFPLFNBQVMsZ0JBQzlCLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLFdBQUssT0FBTyxTQUFTLGlCQUFpQjtBQUN0QyxZQUFNLEtBQUssT0FBTztBQUNsQixXQUFLO0FBQ0wsY0FBUSxJQUFJLG9DQUFvQyxLQUFLLE9BQU8sU0FBUztBQUFBO0FBR2pGLFFBQUksd0JBQVEsYUFDUCxRQUFRLHlCQUNSLFFBQVEsc0NBQ1IsUUFBUSxVQUFRLEtBQ1osU0FBUyxLQUFLLE9BQU8sU0FBUyxjQUM5QixTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLFlBQU0sS0FBSyxPQUFPO0FBQ2xCLFdBQUs7QUFDTCxjQUFRLElBQUksa0NBQWtDLEtBQUssT0FBTyxTQUFTO0FBQUE7QUFHL0UsZ0JBQVksU0FBUyxNQUFNLEVBQUUsTUFBTTtBQUVuQyxVQUFNLHVCQUF1QixZQUFZLFVBQVU7QUFHbkQsU0FBSyxPQUFPLFNBQVMsWUFBWSxRQUFRLENBQUMsU0FBUyxVQUFVO0FBQ3pELFlBQU0sbUJBQW1CLHFCQUFxQixVQUFVO0FBRXhELFVBQUksd0JBQVEsa0JBQ1AsUUFBUSxRQUFRLFFBQVEsT0FDeEIsUUFBUSxVQUFRLEtBQ1osZUFBZSxZQUNmLFNBQVMsUUFBUSxLQUNqQixTQUFTLE9BQU8sVUFBVTtBQUN2QixhQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sTUFBTTtBQUM5QyxjQUFNLEtBQUssT0FBTztBQUNsQixhQUFLO0FBQ0wsZ0JBQVEsSUFBSSx3QkFBd0IsS0FBSyxPQUFPLFNBQVM7QUFBQSxVQUVoRSxRQUFRLFVBQVEsS0FDWixlQUFlLG1CQUNmLFNBQVMsUUFBUSxnQkFDakIsU0FBUyxPQUFPLFVBQVU7QUFDdkIsYUFBSyxPQUFPLFNBQVMsWUFBWSxPQUFPLGlCQUFpQjtBQUN6RCxjQUFNLEtBQUssT0FBTztBQUNsQixhQUFLO0FBQ0wsZ0JBQVEsSUFBSSx3QkFBd0IsS0FBSyxPQUFPLFNBQVM7QUFBQSxVQUVoRSxRQUFRLFVBQVEsS0FDWixlQUFlLGlCQUNmLFNBQVMsUUFBUSxjQUNqQixTQUFTLE9BQU8sVUFBVTtBQUN2QixhQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sZUFBZTtBQUN2RCxjQUFNLEtBQUssT0FBTztBQUNsQixhQUFLO0FBQ0wsZ0JBQVEsSUFBSSx3QkFBd0IsS0FBSyxPQUFPLFNBQVM7QUFBQSxVQUVoRSxVQUFVLFlBQVUsT0FDaEIsUUFBUSxTQUNSLFFBQVEsWUFBWTtBQUNqQixhQUFLLE9BQU8sU0FBUyxZQUFZLE9BQU8sT0FBTztBQUMvQyxjQUFNLEtBQUssT0FBTztBQUNsQixhQUFLO0FBQ0wsZ0JBQVEsSUFBSSxtQ0FBbUMsS0FBSyxPQUFPLFNBQVM7QUFBQTtBQUFBO0FBS3BGLFFBQUksd0JBQVEsYUFDUCxRQUFRLG1CQUNSLFFBQVEsK0JBQ1IsVUFBVSxZQUFVLE9BQ2hCLGNBQWMsZUFDZCxRQUFRLFlBQVk7QUFDakIsV0FBSyxPQUFPLFNBQVMsWUFBWSxLQUFLO0FBQUEsUUFDbEMsS0FBSztBQUFBLFFBQ0wsZ0JBQWdCO0FBQUEsUUFDaEIsY0FBYztBQUFBO0FBRWxCLFlBQU0sS0FBSyxPQUFPO0FBQ2xCLGNBQVEsSUFBSSwwQkFBMEIsS0FBSyxPQUFPLFNBQVM7QUFDM0QsV0FBSztBQUFBO0FBR2pCLFFBQUksd0JBQVEsYUFDUCxRQUFRLGtCQUNSLFFBQVEsMENBQ1IsVUFBVSxZQUFVLE9BQ2hCLGNBQWMsb0JBQ2QsUUFBUSxZQUFZO0FBQ2pCLFdBQUssT0FBTyxXQUFXLE9BQU8sT0FBTyxJQUFJO0FBQ3pDLFlBQU0sS0FBSyxPQUFPO0FBQ2xCLGNBQVEsSUFBSSwrQkFBK0IsS0FBSyxPQUFPO0FBQ3ZELFdBQUs7QUFDTCxVQUFJLHVCQUFPO0FBQUE7QUFJdkIsZ0JBQVksU0FBUyxNQUFNLEVBQUUsTUFBTTtBQUVuQyxRQUFJLHdCQUFRLGFBQ1AsUUFBUSwyQkFDUixRQUFRLHNDQUNSLFVBQVUsWUFBVSxPQUNoQixTQUFTLEtBQUssT0FBTyxTQUFTLGFBQWEsU0FDM0MsU0FBUyxPQUFPLFVBQVU7QUFDdkIsV0FBSyxPQUFPLFNBQVMsYUFBYSxVQUFVO0FBQzVDLFlBQU0sS0FBSyxPQUFPO0FBQUE7QUFHOUIsUUFBSSx3QkFBUSxhQUNQLFFBQVEsZ0JBQ1IsUUFBUSx3REFDUixRQUFRLFVBQVEsS0FDWixlQUFlLFNBQ2YsU0FBUyxLQUFLLE9BQU8sU0FBUyxhQUFhLGFBQzNDLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLFdBQUssT0FBTyxTQUFTLGFBQWEsY0FBYztBQUNoRCxZQUFNLEtBQUssT0FBTztBQUFBO0FBRzlCLFFBQUksd0JBQVEsYUFDUCxRQUFRLGlCQUNSLFFBQVEsb0VBQ1IsUUFBUSxVQUFRLEtBQ1osZUFBZSxxQ0FDZixTQUFTLEtBQUssT0FBTyxTQUFTLGFBQWEsU0FDM0MsU0FBUyxPQUFPLFVBQVU7QUFDdkIsV0FBSyxPQUFPLFNBQVMsYUFBYSxVQUFVO0FBQzVDLFlBQU0sS0FBSyxPQUFPO0FBQUE7QUFHOUIsUUFBSSx3QkFBUSxhQUNQLFFBQVEsWUFDUixRQUFRLDJCQUNSLFFBQVEsVUFBUSxLQUNaLGVBQWUscUJBQ2YsU0FBUyxLQUFLLE9BQU8sU0FBUyxhQUFhLFVBQzNDLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLFdBQUssT0FBTyxTQUFTLGFBQWEsV0FBVztBQUM3QyxZQUFNLEtBQUssT0FBTztBQUFBO0FBRzlCLFFBQUksd0JBQVEsYUFDUCxRQUFRLGFBQ1IsUUFBUSwwRkFDUixRQUFRLFVBQVEsS0FDWixlQUFlLHdCQUNmLFNBQVMsS0FBSyxPQUFPLFNBQVMsYUFBYSxVQUMzQyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxhQUFhLFdBQVc7QUFDN0MsWUFBTSxLQUFLLE9BQU87QUFBQTtBQUk5QixnQkFBWSxTQUFTLE1BQU0sRUFBQyxNQUFNO0FBRWxDLFFBQUksd0JBQVEsYUFDUCxRQUFRLHlCQUNSLFFBQVEsZ0RBQ1IsVUFBVSxZQUFVLE9BQ2hCLFNBQVMsS0FBSyxPQUFPLFNBQVMsZUFBZSxTQUM3QyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxlQUFlLFVBQVU7QUFDOUMsWUFBTSxLQUFLLE9BQU87QUFBQTtBQUc5QixRQUFJLHdCQUFRLGFBQ1AsUUFBUSx3QkFDUixRQUFRLDJDQUNSLFVBQVUsWUFBVSxPQUNoQixTQUFTLEtBQUssT0FBTyxTQUFTLGVBQWUsYUFDN0MsU0FBUyxPQUFPLFVBQVU7QUFDdkIsV0FBSyxPQUFPLFNBQVMsZUFBZSxjQUFjO0FBQ2xELFlBQU0sS0FBSyxPQUFPO0FBQUE7QUFJOUIsZ0JBQVksU0FBUyxNQUFNLEVBQUMsTUFBTTtBQUVsQyxhQUFTLElBQUksR0FBRyxJQUFJLEtBQUssT0FBTyxTQUFTLGVBQWUsU0FBUyxRQUFRLEtBQUs7QUFDMUUsWUFBTSxVQUFVLEtBQUssT0FBTyxTQUFTLGVBQWUsU0FBUztBQUM3RCxZQUFNLG1CQUFtQixZQUFZO0FBQ3JDLHVCQUFpQixTQUFTO0FBRTFCLFVBQUksd0JBQVEsa0JBQ1AsUUFBUSxZQUFZLFFBQVEsUUFDNUIsUUFBUSwwQkFDUixVQUFVLFlBQVUsT0FDaEIsU0FBUyxRQUFRLFNBQ2pCLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLGdCQUFRLFVBQVU7QUFDbEIsY0FBTSxLQUFLLE9BQU87QUFBQSxVQUV6QixVQUFVLFlBQVUsT0FDaEIsV0FBVyx1QkFDWCxTQUFTLFFBQVEsWUFDakIsU0FBUyxPQUFPLFVBQVU7QUFDdkIsZ0JBQVEsYUFBYTtBQUNyQixjQUFNLEtBQUssT0FBTztBQUFBLFVBRXpCLFFBQVEsVUFBUSxLQUNaLGVBQWUsbUJBQ2YsU0FBUyxRQUFRLFNBQ2pCLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLGdCQUFRLFVBQVU7QUFDbEIsY0FBTSxLQUFLLE9BQU87QUFBQTtBQUFBO0FBS2xDLFFBQUksd0JBQVEsYUFDUCxRQUFRLG1CQUNSLFFBQVEsbUNBQ1IsVUFBVSxZQUFVLE9BQ2hCLGNBQWMsZUFDZCxRQUFRLFlBQVk7QUFDakIsV0FBSyxPQUFPLFNBQVMsZUFBZSxTQUFTLEtBQUs7QUFBQSxRQUM5QyxNQUFNO0FBQUEsUUFDTixTQUFTO0FBQUEsUUFDVCxTQUFTO0FBQUEsUUFDVCxZQUFZO0FBQUE7QUFFaEIsWUFBTSxLQUFLLE9BQU87QUFDbEIsV0FBSztBQUFBO0FBSWpCLFFBQUksd0JBQVEsYUFDUCxRQUFRLGlCQUNSLFFBQVEseUNBQ1IsVUFBVSxZQUFVLE9BQ2hCLGNBQWMsaUJBQ2QsUUFBUSxNQUFNO0FBQ1gsV0FBSyxPQUFPO0FBQUE7QUFHeEIsU0FBSyxTQUFTLFlBQVk7QUFDMUIsU0FBSztBQUFBO0FBQUE7OztBQ3JVYix1QkFBZ0Q7QUFTaEQscUNBQStCLHFDQUFvQjtBQUFBLEVBQy9DLFlBQTZCLE1BQXVCO0FBQ2hELFVBQU07QUFEbUI7QUFBQTtBQUFBLEVBSTdCLFdBQWlCO0FBQUE7QUFBQTtBQUtkLDhCQUF3QjtBQUFBLFNBQ1osY0FBYyxVQUFzQztBQUMvRCxVQUFNLE9BQU8sU0FBUyxlQUFlO0FBQ3JDLFVBQU0sV0FBVyxLQUFLLFFBQVEsaUJBQWlCLElBQUksTUFBTTtBQUN6RCxXQUFPLFdBQVcsU0FBUyxLQUFLO0FBQUE7QUFBQSxTQUdyQixnQkFDWCxRQUNBLEtBQ0EsV0FDTTtBQUNOLFFBQUksQ0FBQyxLQUFLO0FBQ04sYUFBTyxZQUFZLE9BQU8sU0FBUyxlQUFlLE9BQU8sU0FBUztBQUFBO0FBR3RFLFVBQU0sVUFBVSxPQUFPLFNBQVMsWUFBWSxLQUFLLENBQUMsTUFBTSxFQUFFLFFBQVE7QUFDbEUsUUFBSSxDQUFDLFNBQVM7QUFDVixhQUFPLFlBQVksT0FBTyxTQUFTLGVBQWUsT0FBTyxTQUFTO0FBQUE7QUFHdEUsV0FBTyxZQUFZLFFBQVEsZUFBZSxRQUFRO0FBQUE7QUFBQSxTQUd2QyxvQkFDWCxRQUNBLFdBQ0EsVUFDSTtBQUNKLFVBQU0sV0FBVyxPQUFPLFFBQVE7QUFDaEMsVUFBTSxVQUFVLFNBQVMsUUFBUSxpQkFBaUIsR0FBRztBQUVyRCxVQUFNLFNBQXVCO0FBQUEsTUFDekIsTUFBTSxFQUFFLE1BQU0sV0FBVyxJQUFJO0FBQUEsTUFDN0IsSUFBSSxFQUFFLE1BQU0sV0FBVyxJQUFJLFNBQVM7QUFBQSxNQUNwQyxNQUFNO0FBQUE7QUFHVixXQUFPLFlBQVksRUFBRSxTQUFTLENBQUM7QUFBQTtBQUFBLFNBR3BCLGdCQUFnQixPQUFnQztBQUMzRCxVQUFNLE9BQU8sU0FBUyxjQUFjO0FBQ3BDLFNBQUssWUFBWTtBQUNqQixTQUFLLGNBQWM7QUFDbkIsV0FBTztBQUFBO0FBQUEsU0FHSSxlQUFlLFdBQXFDO0FBQy9ELFFBQUksV0FBVztBQUNYLGdCQUFVLE1BQU0sVUFBVTtBQUMxQixnQkFBVSxNQUFNLGdCQUFnQjtBQUNoQyxnQkFBVSxNQUFNLGNBQWM7QUFBQTtBQUFBO0FBQUEsU0FJdkIsb0JBQ1gsUUFDQSxVQUNBLE1BQ0EsS0FDQSxPQUNBLFFBQ0EsYUFDQSxLQUNJO0FBQ0osVUFBTSxjQUFjLENBQUMsY0FBNkI7QUFDOUMsWUFBTSxXQUFXLEtBQUssZ0JBQWdCLFFBQVEsS0FBSztBQUNuRCxXQUFLLGNBQWM7QUFFbkIsVUFBSSxVQUFVLGFBQWE7QUFDdkIsYUFBSyxvQkFBb0IsUUFBUSxZQUFZLFlBQVksT0FBTztBQUFBO0FBQUE7QUFJeEUsVUFBTSxpQkFBaUIsWUFBWTtBQUMvQixlQUFTLFVBQVUsQ0FBQyxTQUFTO0FBQzdCLGtCQUFZLFNBQVM7QUFHckIsZUFBUyxjQUFjLElBQUksTUFBTSxVQUFVLEVBQUUsU0FBUztBQUN0RCxlQUFTLGNBQWMsSUFBSSxNQUFNLFNBQVMsRUFBRSxTQUFTO0FBRXJELFVBQUksSUFBSSxZQUFZO0FBQ2hCLFlBQUksU0FBUyxJQUFJLGlCQUFpQjtBQUFBO0FBQUE7QUFJMUMsU0FBSyxpQkFBaUIsU0FBUyxPQUFPLE1BQU07QUFDeEMsUUFBRTtBQUNGLFFBQUU7QUFDRixZQUFNO0FBQUE7QUFHVixhQUFTLGlCQUFpQixVQUFVLE1BQU07QUFDdEMsa0JBQVksU0FBUztBQUFBO0FBQUE7QUFBQSxlQUlULGdCQUNoQixRQUNBLFVBQ0EsT0FDQSxRQUNBLGFBQ0EsS0FDYTtBQUNiLFVBQU0sV0FBVyxTQUFTLFFBQVE7QUFDbEMsUUFBSSxDQUFDO0FBQVU7QUFFZixVQUFNLE1BQU0sS0FBSyxjQUFjO0FBQy9CLFVBQU0sUUFBUSxLQUFLLGdCQUFnQixRQUFRLEtBQUssU0FBUztBQUN6RCxVQUFNLE9BQU8sS0FBSyxnQkFBZ0I7QUFFbEMsUUFBSSxVQUFVLGFBQWE7QUFDdkIsV0FBSyxvQkFBb0IsUUFBUSxZQUFZLFlBQVksT0FBTztBQUFBO0FBR3BFLFNBQUssb0JBQ0QsUUFDQSxVQUNBLE1BQ0EsS0FDQSxPQUNBLFFBQ0EsYUFDQTtBQUdKLFNBQUssZUFBZSxTQUFTO0FBQzdCLGFBQVMsTUFBTSxVQUFVO0FBQ3pCLGFBQVMsTUFBTTtBQUFBO0FBQUE7QUFJaEIsSUFBTSxvQkFBMkMsU0FFcEQsSUFDQSxLQUNJO0FBQ0osUUFBTSxhQUFhLEdBQUcsaUJBQW1DO0FBQ3pELFFBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxvQkFBb0I7QUFDcEQsUUFBTSxTQUFTLDZCQUFNO0FBQ3JCLFFBQU0sY0FBYyxJQUFJLGVBQWU7QUFFdkMsYUFBVyxRQUFRLENBQUMsVUFBVSxVQUFVO0FBQ3BDLFFBQUksQ0FBRSxxQkFBb0I7QUFBbUI7QUFFN0Msc0JBQWtCLGdCQUNkLE1BQ0EsVUFDQSxPQUNBLFFBQ0EsYUFDQTtBQUFBO0FBQUE7OztBQzlLWix1QkFBNEM7QUFVckMsdUJBQWlCO0FBQUEsRUFDcEIsWUFBb0IsVUFBd0I7QUFBeEI7QUFBQTtBQUFBLEVBRVosZ0JBQXdCO0FBRTVCLFVBQU0sY0FBYyxHQUFHLEtBQUssU0FBUyxZQUFZLEtBQUssU0FBUztBQUUvRCxVQUFNLG9CQUFvQixPQUFPLEtBQUssYUFBYSxTQUFTO0FBQzVELFdBQU8sU0FBUztBQUFBO0FBQUEsUUFHZCxpQkFBbUM7QUFDckMsVUFBTSxVQUFVLEtBQUssU0FBUyxRQUFRLFFBQVEsT0FBTztBQUNyRCxVQUFNLFNBQVMsR0FBRztBQUVsQixRQUFJO0FBQ0EsWUFBTSxXQUFXLE1BQU0saUNBQVc7QUFBQSxRQUM5QixLQUFLO0FBQUEsUUFDTCxRQUFRO0FBQUEsUUFDUixTQUFTO0FBQUEsVUFDTCxpQkFBaUIsS0FBSztBQUFBLFVBQ3RCLFVBQVU7QUFBQTtBQUFBO0FBSWxCLGFBQU8sU0FBUyxXQUFXO0FBQUEsYUFDdEIsT0FBUDtBQUNFLGNBQVEsTUFBTSwyQkFBMkI7QUFDekMsYUFBTztBQUFBO0FBQUE7QUFBQSxRQUlULFlBQVksT0FBb0M7QUFDbEQsUUFBSSxDQUFDLEtBQUssU0FBUyxXQUFXLENBQUMsS0FBSyxTQUFTLFdBQVcsQ0FBQyxLQUFLLFNBQVMsVUFBVTtBQUM3RSxZQUFNLElBQUksTUFBTTtBQUFBO0FBSXBCLFVBQU0sY0FBYyxNQUFNLEtBQUs7QUFDL0IsUUFBSSxDQUFDLGFBQWE7QUFDZCxZQUFNLElBQUksTUFBTTtBQUFBO0FBSXBCLFVBQU0sVUFBVSxLQUFLLFNBQVMsUUFBUSxRQUFRLE9BQU87QUFHckQsVUFBTSxpQkFBaUIsTUFBTSxRQUFRLFNBQVM7QUFHOUMsUUFBSTtBQUNKLFFBQUksZUFBZSxrQkFBa0IsY0FBYyxlQUFlLGtCQUFrQixrQkFBa0I7QUFDbEcsWUFBTTtBQUFBLGVBQ0MsZUFBZSxjQUFjLFdBQVcsT0FBTztBQUV0RCxZQUFNLFNBQVMsZUFBZSxjQUFjLFNBQVMsVUFBVSxTQUNqRCxlQUFlLGNBQWMsU0FBUyxVQUFVLFNBQVM7QUFFdkUsWUFBTSxTQUNBLDBDQUEwQyxZQUMxQyw0Q0FBNEMscUNBQXFDO0FBQUEsV0FDcEY7QUFDSCxZQUFNLDRDQUE0QyxxQ0FBcUM7QUFBQTtBQUczRixXQUFPO0FBRVAsWUFBUSxJQUFJLGNBQWM7QUFDMUIsVUFBTSxTQUFTLEdBQUcsaUNBQWlDLG1CQUFtQjtBQUN0RSxZQUFRLElBQUksWUFBWTtBQUV4QixVQUFNLGdCQUFpQztBQUFBLE1BQ25DLEtBQUs7QUFBQSxNQUNMLFFBQVE7QUFBQSxNQUNSLFNBQVM7QUFBQSxRQUNMLGlCQUFpQixLQUFLO0FBQUEsUUFDdEIsVUFBVTtBQUFBO0FBQUE7QUFJbEIsUUFBSTtBQUNBLGNBQVEsSUFBSTtBQUNaLFlBQU0sV0FBVyxNQUFNLGlDQUFXO0FBQ2xDLGNBQVEsSUFBSSxvQkFBb0IsU0FBUztBQUV6QyxVQUFJLFNBQVMsV0FBVyxLQUFLO0FBQ3pCLGdCQUFRLE1BQU0sbUJBQW1CLFNBQVM7QUFDMUMsY0FBTSxJQUFJLE1BQU0sNEJBQTRCLFNBQVMsV0FBVyxTQUFTO0FBQUE7QUFHN0UsVUFBSSxDQUFDLFNBQVMsUUFBUSxDQUFDLFNBQVMsS0FBSyxRQUFRO0FBQ3pDLGdCQUFRLE1BQU0sNEJBQTRCO0FBQzFDLGNBQU0sSUFBSSxNQUFNO0FBQUE7QUFHcEIsY0FBUSxJQUFJLGlCQUFpQixTQUFTLEtBQUssT0FBTztBQUNsRCxhQUFPLFNBQVMsS0FBSyxPQUFPLElBQUksQ0FBQyxVQUFZO0FBMUd6RDtBQTBHNkQ7QUFBQSxVQUM3QyxLQUFLLE1BQU07QUFBQSxVQUNYLFNBQVMsTUFBTSxPQUFPO0FBQUEsVUFDdEIsS0FBSyxHQUFHLGtCQUFrQixNQUFNO0FBQUEsVUFDaEMsUUFBUSxhQUFNLE9BQU8sV0FBYixtQkFBcUIsU0FBUTtBQUFBO0FBQUE7QUFBQSxhQUVwQyxPQUFQO0FBQ0UsY0FBUSxNQUFNLGtCQUFrQjtBQUFBLFFBQzVCLFNBQVMsTUFBTTtBQUFBLFFBQ2YsUUFBUSxNQUFNO0FBQUEsUUFDZCxVQUFVLE1BQU07QUFBQTtBQUdwQixVQUFJLE1BQU0sV0FBVyxPQUFPLE1BQU0sV0FBVyxLQUFLO0FBQzlDLGNBQU0sSUFBSSxNQUFNO0FBQUE7QUFFcEIsWUFBTTtBQUFBO0FBQUE7QUFBQSxRQUlSLHNCQUFzQixPQUFvQztBQUM1RCxXQUFPLE1BQU0sSUFBSSxVQUNiLFVBQVUsS0FBSyxRQUFRLEtBQUssWUFBWSxLQUFLLFNBQVMsS0FBSyxXQUM3RCxLQUFLO0FBQUE7QUFBQTs7O0FDaklmLHVCQUF3RDtBQUdqRCxzQ0FBZ0MsOEJBQXVCO0FBQUEsRUFJMUQsWUFBWSxLQUFVLE9BQW1CLFVBQW9DO0FBQ3pFLFVBQU07QUFKRixpQkFBb0I7QUFLeEIsWUFBUSxJQUFJO0FBQ1osWUFBUSxJQUFJLG1CQUFtQjtBQUUvQixTQUFLLFFBQVE7QUFDYixTQUFLLFdBQVc7QUFHaEIsU0FBSyxlQUFlO0FBR3BCLFNBQUssWUFBWSxTQUFTO0FBRzFCLFNBQUssUUFBUSxNQUFNLFdBQVc7QUFDOUIsU0FBSyxRQUFRLE1BQU0sUUFBUTtBQUMzQixTQUFLLFFBQVEsTUFBTSxNQUFNO0FBQ3pCLFNBQUssUUFBUSxNQUFNLE9BQU87QUFDMUIsU0FBSyxRQUFRLE1BQU0sWUFBWTtBQUMvQixTQUFLLFFBQVEsTUFBTSxXQUFXO0FBRzlCLFVBQU0sdUJBQXVCLEtBQUssUUFBUSxjQUFjO0FBQ3hELFFBQUksZ0NBQWdDLGFBQWE7QUFDN0MsMkJBQXFCLE1BQU0sWUFBWTtBQUN2QywyQkFBcUIsTUFBTSxRQUFRO0FBQUE7QUFJdkMsU0FBSyxRQUFRLElBQUk7QUFDakIsU0FBSyxNQUFNLFNBQVMsSUFBSSxVQUFVLE1BQU07QUFDcEMsV0FBSztBQUNMLGFBQU87QUFBQTtBQUlYLFlBQVEsSUFBSTtBQUNaLFNBQUs7QUFBQTtBQUFBLEVBSVQsT0FBTztBQUNILFlBQVEsSUFBSTtBQUNaLFVBQU07QUFHTixTQUFLLFlBQVksTUFBTSxVQUFVO0FBQ2pDLFNBQUssWUFBWSxNQUFNLGFBQWE7QUFDcEMsU0FBSyxZQUFZLE1BQU0sVUFBVTtBQUFBO0FBQUEsRUFHckMsZUFBZSxPQUEyQjtBQUN0QyxZQUFRLElBQUksa0NBQWtDO0FBQzlDLFVBQU0sYUFBYSxNQUFNO0FBQ3pCLFVBQU0sZ0JBQWdCLEtBQUssTUFBTSxPQUFPLFVBQ3BDLEtBQUssSUFBSSxjQUFjLFNBQVMsZUFDaEMsS0FBSyxRQUFRLGNBQWMsU0FBUztBQUV4QyxZQUFRLElBQUksbUJBQW1CO0FBQy9CLFdBQU87QUFBQTtBQUFBLEVBR1gsaUJBQWlCLE1BQWdCLElBQWlCO0FBQzlDLFlBQVEsSUFBSSxrQ0FBa0M7QUFDOUMsVUFBTSxZQUFZLEdBQUcsVUFBVSxFQUFFLEtBQUs7QUFFdEMsVUFBTSxRQUFRLFVBQVUsVUFBVSxFQUFFLEtBQUs7QUFDekMsVUFBTSxRQUFRLEtBQUs7QUFFbkIsVUFBTSxZQUFZLFVBQVUsVUFBVSxFQUFFLEtBQUs7QUFDN0MsY0FBVSxRQUFRLEtBQUs7QUFFdkIsVUFBTSxXQUFXLFVBQVUsVUFBVSxFQUFFLEtBQUs7QUFDNUMsYUFBUyxRQUFRLEtBQUs7QUFHdEIsT0FBRyxNQUFNLFVBQVU7QUFDbkIsT0FBRyxNQUFNLGdCQUFnQjtBQUN6QixPQUFHLE1BQU0sTUFBTTtBQUNmLFVBQU0sTUFBTSxhQUFhO0FBQ3pCLFVBQU0sTUFBTSxRQUFRO0FBQ3BCLGFBQVMsTUFBTSxXQUFXO0FBQzFCLGFBQVMsTUFBTSxRQUFRO0FBQ3ZCLGFBQVMsTUFBTSxZQUFZO0FBQUE7QUFBQSxFQUcvQixtQkFBbUIsTUFBZ0IsS0FBaUM7QUFDaEUsWUFBUSxJQUFJLGdCQUFnQjtBQUU1QixRQUFJLEtBQUssVUFBVTtBQUNmLFdBQUssU0FBUztBQUFBO0FBRWxCLFNBQUs7QUFBQTtBQUFBOzs7QUxwRmIseUNBQWtELHdCQUFPO0FBQUEsUUFHL0MsU0FBUztBQUNYLFVBQU0sS0FBSztBQUNYLFlBQVEsSUFBSSxnQ0FBZ0MsS0FBSztBQUdqRCxTQUFLLGNBQ0QsS0FBSyxJQUFJLFVBQVUsR0FBRyxpQkFBaUIsQ0FBQyxXQUFtQjtBQUN2RCxZQUFNLFNBQVMsT0FBTztBQUN0QixZQUFNLE9BQU8sT0FBTyxRQUFRLE9BQU87QUFDbkMsWUFBTSxlQUFlLEtBQUssTUFBTSxHQUFHLE9BQU87QUFHMUMsWUFBTSxjQUFjLEtBQUssU0FBUyxhQUFhO0FBQy9DLGNBQVEsSUFBSSx5QkFBeUI7QUFBQSxRQUNqQztBQUFBLFFBQ0E7QUFBQSxRQUNBLFVBQVUsYUFBYSxTQUFTO0FBQUEsUUFDaEMsU0FBUyxLQUFLLFNBQVMsYUFBYTtBQUFBO0FBR3hDLFVBQUksYUFBYSxTQUFTLGNBQWM7QUFDcEMsZ0JBQVEsSUFBSTtBQUNaLGFBQUssa0JBQWtCO0FBQUE7QUFBQTtBQU1uQyxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLGVBQWUsQ0FBQyxhQUFzQjtBQUNsQyxjQUFNLE9BQU8sS0FBSyxJQUFJLFVBQVUsb0JBQW9CO0FBQ3BELFlBQUksQ0FBQztBQUFNLGlCQUFPO0FBQ2xCLFlBQUksQ0FBQyxVQUFVO0FBQ1gsZUFBSyxnQkFBZ0I7QUFBQTtBQUV6QixlQUFPO0FBQUE7QUFBQTtBQUlmLFNBQUssOEJBQThCLGtCQUFrQixLQUFLO0FBQzFELFNBQUssY0FBYyxJQUFJLHlCQUF5QixLQUFLLEtBQUs7QUFHMUQsU0FBSyxjQUNELEtBQUssSUFBSSxVQUFVLEdBQUcsZUFBZSxDQUFDLE1BQU0sV0FBVztBQUNuRCxVQUFJLE9BQU8sZ0JBQWdCO0FBQ3ZCLGFBQUssUUFBUSxDQUFDLFNBQVM7QUFDbkIsZUFDSyxTQUFTLDRCQUNULFFBQVEsa0JBQ1IsUUFBUSxNQUFNLEtBQUsseUJBQXlCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU83RCx5QkFBeUIsUUFBZ0I7QUFDN0MsVUFBTSxlQUFlLE9BQU87QUFDNUIsUUFBSSxDQUFDLGNBQWM7QUFDZixVQUFJLHdCQUFPO0FBQ1g7QUFBQTtBQUdKLFFBQUksQ0FBQyxLQUFLLFNBQVMsZUFBZSxTQUFTO0FBQ3ZDLFVBQUksd0JBQU87QUFDWDtBQUFBO0FBSUosVUFBTSxXQUFXLENBQUMsTUFBYyxjQUErQjtBQUMzRCxpQkFBVyxXQUFXLEtBQUssU0FBUyxhQUFhO0FBQzdDLFlBQUksS0FBSyxjQUFjLFNBQVMsSUFBSSxRQUFRLElBQUksa0JBQWtCO0FBQzlELGlCQUFPLFlBQVksUUFBUSxlQUFlLFFBQVE7QUFBQTtBQUFBO0FBRzFELGFBQU8sWUFBWSxLQUFLLFNBQVMsZUFBZSxLQUFLLFNBQVM7QUFBQTtBQUlsRSxVQUFNLFFBQVEsYUFBYSxNQUFNO0FBQ2pDLFVBQU0sY0FBYyxDQUFDLFNBQWlCO0FBQ2xDLGFBQU8sS0FBSztBQUNaLFVBQUksS0FBSyxXQUFXLFVBQVU7QUFDMUIsZUFBTyxLQUFLLFFBQVEsU0FBUyxTQUFTLE1BQU07QUFBQSxpQkFDckMsS0FBSyxXQUFXLFVBQVU7QUFDakMsZUFBTyxLQUFLLFFBQVEsU0FBUyxTQUFTLE1BQU07QUFBQTtBQUVoRCxhQUFPO0FBQUE7QUFHWCxVQUFNLFFBQVEsTUFDVCxPQUFPLFVBQVEsS0FBSyxPQUFPLFNBQVMsR0FDcEMsSUFBSTtBQUVULFVBQU0sV0FBVyxNQUNaLE9BQU8sVUFBUSxLQUFLLGNBQWMsU0FBUyxhQUMzQyxJQUFJO0FBR1QsVUFBTSxRQUFRLElBQUksT0FBTyxtQkFBbUIsU0FBUztBQUFBLE1BQ2pELFNBQVM7QUFBQSxNQUNULE1BQU07QUFBQSxNQUNOLE9BQU87QUFBQSxNQUNQLEtBQUs7QUFBQTtBQUlULFVBQU0sZUFBeUI7QUFFL0IsZUFBVyxXQUFXLEtBQUssU0FBUyxlQUFlLFVBQVU7QUFDekQsVUFBSSxDQUFDLFFBQVE7QUFBUztBQUd0QixVQUFJLEtBQUssU0FBUyxlQUFlLGVBQWUsUUFBUSxZQUFZO0FBQ2hFLHFCQUFhLEtBQUssT0FBTyxRQUFRO0FBQUE7QUFJckMsVUFBSSxpQkFBaUIsUUFBUTtBQUM3QixjQUFRLFFBQVE7QUFBQSxhQUNQO0FBQ0QsMkJBQWlCLGFBQU07QUFDdkI7QUFBQSxhQUNDO0FBQ0QsMkJBQWlCLE1BQ1osT0FBTyxVQUFRLENBQUMsS0FBSyxjQUFjLFNBQVMsYUFDNUMsS0FBSztBQUNWO0FBQUEsYUFDQztBQUNELDJCQUFpQixTQUFTLEtBQUs7QUFDL0I7QUFBQTtBQUdSLFVBQUksZ0JBQWdCO0FBQ2hCLHFCQUFhLEtBQUs7QUFDbEIscUJBQWEsS0FBSztBQUFBO0FBQUE7QUFJMUIsVUFBTSxtQkFBbUIsYUFBYSxLQUFLO0FBRzNDLGNBQVUsVUFBVSxVQUFVLGtCQUN6QixLQUFLLE1BQU07QUFDUixVQUFJLHdCQUFPO0FBQUEsT0FFZCxNQUFNLE1BQU07QUFDVCxVQUFJLHdCQUFPO0FBQUE7QUFBQTtBQUFBLFFBSVQsZ0JBQWdCLE1BQW9CO0FBQzlDLFFBQUksQ0FBQyxLQUFLLFNBQVMsYUFBYSxTQUFTO0FBQ3JDLFVBQUksd0JBQU87QUFDWDtBQUFBO0FBR0osUUFBSTtBQUNBLFlBQU0sYUFBYSxJQUFJLFdBQVcsS0FBSyxTQUFTO0FBQ2hELFlBQU0sUUFBUSxNQUFNLFdBQVcsWUFBWTtBQUUzQyxVQUFJLE1BQU0sV0FBVyxHQUFHO0FBQ3BCLFlBQUksd0JBQU87QUFDWDtBQUFBO0FBR0osVUFBSSxrQkFBa0IsS0FBSyxLQUFLLE9BQU8sQ0FBQyxpQkFBaUI7QUFDckQsY0FBTSxTQUFTLEtBQUssT0FBTztBQUMzQixjQUFNLGVBQWUsVUFBVSxhQUFhLFFBQVEsYUFBYSxZQUFZLGFBQWEsU0FBUyxhQUFhO0FBR2hILGFBQUssT0FBTyxhQUNSLGVBQWUsTUFDZixRQUNBO0FBSUosYUFBSyxPQUFPLFVBQVU7QUFBQSxVQUNsQixNQUFNLE9BQU8sT0FBTztBQUFBLFVBQ3BCLElBQUk7QUFBQTtBQUFBO0FBQUEsYUFHUCxPQUFQO0FBQ0UsY0FBUSxNQUFNLDhCQUE4QjtBQUM1QyxVQUFJLHdCQUFPLE1BQU0sV0FBVztBQUFBO0FBQUE7QUFBQSxRQUl0QixrQkFBa0IsU0FBaUI7QUFDN0MsWUFBUSxJQUFJO0FBRVosUUFBSSxDQUFDLEtBQUssU0FBUyxhQUFhLFNBQVM7QUFDckMsY0FBUSxJQUFJO0FBQ1osVUFBSSx3QkFBTztBQUNYO0FBQUE7QUFHSixRQUFJO0FBQ0EsY0FBUSxJQUFJLHVDQUF1QyxLQUFLLFNBQVM7QUFDakUsWUFBTSxhQUFhLElBQUksV0FBVyxLQUFLLFNBQVM7QUFFaEQsY0FBUSxJQUFJO0FBQ1osWUFBTSxRQUFRLE1BQU0sV0FBVyxZQUFZO0FBQzNDLGNBQVEsSUFBSSxrQkFBa0I7QUFFOUIsVUFBSSxNQUFNLFdBQVcsR0FBRztBQUNwQixnQkFBUSxJQUFJO0FBQ1osWUFBSSx3QkFBTztBQUNYO0FBQUE7QUFHSixjQUFRLElBQUksK0JBQStCLE1BQU0sUUFBUTtBQUd6RCxZQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CO0FBQzFELFVBQUksQ0FBQyxZQUFZO0FBQ2IsZ0JBQVEsTUFBTTtBQUNkLFlBQUksd0JBQU87QUFDWDtBQUFBO0FBSUosVUFBSTtBQUNBLGNBQU0sWUFBWSxJQUFJLGtCQUFrQixLQUFLLEtBQUssT0FBTyxDQUFDLGlCQUFpQjtBQUN2RSxrQkFBUSxJQUFJLGtCQUFrQjtBQUM5QixnQkFBTSxTQUFTLFdBQVc7QUFDMUIsZ0JBQU0sU0FBUyxPQUFPO0FBQ3RCLGdCQUFNLGNBQWMsS0FBSyxTQUFTLGFBQWE7QUFDL0MsZ0JBQU0sY0FBYyxPQUFPLFFBQVEsT0FBTztBQUcxQyxnQkFBTSxVQUFVLFlBQVksTUFBTSxHQUFHLE9BQU8sS0FBSyxZQUFZLFVBQy9DLElBQUksYUFBYSxRQUFRLGFBQWEsWUFBWSxhQUFhLFNBQVMsYUFBYSxZQUNyRixZQUFZLE1BQU0sT0FBTztBQUd2QyxpQkFBTyxRQUFRLE9BQU8sTUFBTTtBQUc1QixpQkFBTyxVQUFVO0FBQUEsWUFDYixNQUFNLE9BQU87QUFBQSxZQUNiLElBQUksT0FBTyxLQUFLLFlBQVksU0FBUyxJQUFJLGFBQWEsUUFBUSxhQUFhLFlBQVksYUFBYSxTQUFTLGFBQWEsVUFBVTtBQUFBO0FBQUE7QUFLNUksZ0JBQVEsSUFBSSxzQkFBc0I7QUFBQSxlQUM3QixnQkFBUDtBQUNFLGdCQUFRLE1BQU0sNkJBQTZCO0FBQzNDLFlBQUksd0JBQU87QUFBQTtBQUFBLGFBRVYsT0FBUDtBQUNFLGNBQVEsTUFBTSwrQkFBK0I7QUFDN0MsVUFBSSx3QkFBTyxNQUFNLFdBQVc7QUFBQTtBQUFBO0FBQUEsUUFJOUIsZUFBZTtBQUNqQixVQUFNLGFBQWEsTUFBTSxLQUFLO0FBQzlCLFlBQVEsSUFBSSxnQkFBZ0I7QUFDNUIsU0FBSyxXQUFXLE9BQU8sT0FBTyxJQUFJLGtCQUFrQjtBQUNwRCxZQUFRLElBQUksb0JBQW9CLEtBQUs7QUFBQTtBQUFBLFFBR25DLGVBQWU7QUFDakIsWUFBUSxJQUFJLG9CQUFvQixLQUFLO0FBQ3JDLFVBQU0sS0FBSyxTQUFTLEtBQUs7QUFBQTtBQUFBLEVBRzdCLGtCQUFrQjtBQUVkLFNBQUssSUFBSSxVQUFVLFFBQVE7QUFHM0IsU0FBSyxJQUFJLFVBQVUsaUJBQWlCLFVBQVE7QUF6U3BEO0FBMFNZLFVBQUksS0FBSyxLQUFLLGtCQUFrQixZQUFZO0FBQ3hDLFFBQUMsV0FBSyxLQUFzQixnQkFBM0IsbUJBQXdDLFNBQVM7QUFBQTtBQUFBO0FBSTFELFFBQUksd0JBQU87QUFBQTtBQUFBOyIsCiAgIm5hbWVzIjogW10KfQo=
