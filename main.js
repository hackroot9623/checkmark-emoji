/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};

// src/main.ts
__export(exports, {
  default: () => EmojiChecklistPlugin
});
var import_obsidian5 = __toModule(require("obsidian"));

// src/types.ts
var DEFAULT_SETTINGS = {
  checkedEmoji: "\u2705",
  uncheckedEmoji: "\u2B1C\uFE0F",
  tagMappings: [
    {
      tag: "stopper",
      uncheckedEmoji: "\u{1F6D1}",
      checkedEmoji: "\u2705"
    }
  ],
  jiraSettings: {
    enabled: false,
    baseUrl: "",
    username: "",
    apiToken: "",
    triggerWord: "@Jira"
  }
};

// src/settings.ts
var import_obsidian = __toModule(require("obsidian"));
var EmojiChecklistSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  updateTestSection() {
    if (this.testEl) {
      this.testEl.empty();
      const header = this.testEl.createEl("h3", { text: "Live Preview" });
      const uncheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
      uncheckedExample.createEl("span", { text: "Unchecked example: " });
      const uncheckedContainer = uncheckedExample.createEl("span", { cls: "task-preview" });
      uncheckedContainer.createEl("span", {
        text: this.plugin.settings.uncheckedEmoji,
        cls: "emoji-preview"
      });
      uncheckedContainer.createEl("span", { text: " Sample task" });
      const checkedExample = this.testEl.createEl("div", { cls: "setting-item" });
      checkedExample.createEl("span", { text: "Checked example: " });
      const checkedContainer = checkedExample.createEl("span", { cls: "task-preview" });
      checkedContainer.createEl("span", {
        text: this.plugin.settings.checkedEmoji,
        cls: "emoji-preview"
      });
      const checkedText = checkedContainer.createEl("span", { text: " Sample task" });
      checkedText.style.textDecoration = "line-through";
      checkedText.style.color = "var(--text-muted)";
      if (this.plugin.settings.tagMappings.length > 0) {
        const tagHeader = this.testEl.createEl("h3", { text: "Tag Examples" });
        tagHeader.style.marginTop = "2em";
        tagHeader.style.marginBottom = "1em";
        for (const mapping of this.plugin.settings.tagMappings) {
          const tagUncheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
          tagUncheckedExample.createEl("span", { text: `#${mapping.tag} unchecked: ` });
          const tagUncheckedContainer = tagUncheckedExample.createEl("span", { cls: "task-preview" });
          tagUncheckedContainer.createEl("span", {
            text: mapping.uncheckedEmoji,
            cls: "emoji-preview"
          });
          tagUncheckedContainer.createEl("span", { text: ` Sample #${mapping.tag} task` });
          const tagCheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
          tagCheckedExample.createEl("span", { text: `#${mapping.tag} checked: ` });
          const tagCheckedContainer = tagCheckedExample.createEl("span", { cls: "task-preview" });
          tagCheckedContainer.createEl("span", {
            text: mapping.checkedEmoji,
            cls: "emoji-preview"
          });
          const tagCheckedText = tagCheckedContainer.createEl("span", { text: ` Sample #${mapping.tag} task` });
          tagCheckedText.style.textDecoration = "line-through";
          tagCheckedText.style.color = "var(--text-muted)";
          tagUncheckedExample.style.marginBottom = "0.5em";
          tagCheckedExample.style.marginBottom = "0.5em";
        }
      }
      header.style.marginTop = "2em";
      header.style.marginBottom = "1em";
      uncheckedExample.style.marginBottom = "0.5em";
      checkedExample.style.marginBottom = "0.5em";
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Emoji Checklist Settings" });
    new import_obsidian.Setting(containerEl).setName("Default Unchecked Emoji").setDesc("Emoji to display for unchecked tasks").addText((text) => text.setValue(this.plugin.settings.uncheckedEmoji).onChange(async (value) => {
      this.plugin.settings.uncheckedEmoji = value;
      await this.plugin.saveSettings();
      this.updateTestSection();
      console.log("Updated default unchecked emoji:", this.plugin.settings.uncheckedEmoji);
    }));
    new import_obsidian.Setting(containerEl).setName("Default Checked Emoji").setDesc("Emoji to display for checked tasks").addText((text) => text.setValue(this.plugin.settings.checkedEmoji).onChange(async (value) => {
      this.plugin.settings.checkedEmoji = value;
      await this.plugin.saveSettings();
      this.updateTestSection();
      console.log("Updated default checked emoji:", this.plugin.settings.checkedEmoji);
    }));
    containerEl.createEl("h3", { text: "Tag Mappings" });
    const tagMappingsContainer = containerEl.createDiv("tag-mappings");
    this.plugin.settings.tagMappings.forEach((mapping, index) => {
      const mappingContainer = tagMappingsContainer.createDiv("tag-mapping");
      new import_obsidian.Setting(mappingContainer).setName(`Tag #${mapping.tag}`).addText((text) => text.setPlaceholder("tag name").setValue(mapping.tag).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].tag = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addText((text) => text.setPlaceholder("unchecked emoji").setValue(mapping.uncheckedEmoji).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].uncheckedEmoji = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addText((text) => text.setPlaceholder("checked emoji").setValue(mapping.checkedEmoji).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].checkedEmoji = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addButton((button) => button.setIcon("trash").onClick(async () => {
        this.plugin.settings.tagMappings.splice(index, 1);
        await this.plugin.saveSettings();
        this.display();
        console.log("Removed tag mapping, remaining:", this.plugin.settings.tagMappings);
      }));
    });
    new import_obsidian.Setting(containerEl).setName("Add Tag Mapping").setDesc("Add a new tag-emoji mapping").addButton((button) => button.setButtonText("Add New Tag").onClick(async () => {
      this.plugin.settings.tagMappings.push({
        tag: "newtag",
        uncheckedEmoji: "\u2B55",
        checkedEmoji: "\u2705"
      });
      await this.plugin.saveSettings();
      console.log("Added new tag mapping:", this.plugin.settings.tagMappings);
      this.display();
    }));
    new import_obsidian.Setting(containerEl).setName("Reset Settings").setDesc("Restore all settings to their defaults").addButton((button) => button.setButtonText("Restore Defaults").onClick(async () => {
      this.plugin.settings = Object.assign({}, DEFAULT_SETTINGS);
      await this.plugin.saveSettings();
      console.log("Reset settings to defaults:", this.plugin.settings);
      this.display();
      new import_obsidian.Notice("Settings restored to defaults");
    }));
    containerEl.createEl("h3", { text: "Jira Integration" });
    new import_obsidian.Setting(containerEl).setName("Enable Jira Integration").setDesc("Enable or disable Jira integration").addToggle((toggle) => toggle.setValue(this.plugin.settings.jiraSettings.enabled).onChange(async (value) => {
      this.plugin.settings.jiraSettings.enabled = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Trigger Word").setDesc("Word that triggers Jira task insertion (e.g., @jira)").addText((text) => text.setPlaceholder("@jira").setValue(this.plugin.settings.jiraSettings.triggerWord).onChange(async (value) => {
      this.plugin.settings.jiraSettings.triggerWord = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Jira Base URL").setDesc("Your Jira instance URL (e.g., https://your-domain.atlassian.net)").addText((text) => text.setPlaceholder("https://your-domain.atlassian.net").setValue(this.plugin.settings.jiraSettings.baseUrl).onChange(async (value) => {
      this.plugin.settings.jiraSettings.baseUrl = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Username").setDesc("Your Jira email address").addText((text) => text.setPlaceholder("email@example.com").setValue(this.plugin.settings.jiraSettings.username).onChange(async (value) => {
      this.plugin.settings.jiraSettings.username = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("API Token").setDesc("Your Jira API token (from https://id.atlassian.com/manage-profile/security/api-tokens)").addText((text) => text.setPlaceholder("Enter your API token").setValue(this.plugin.settings.jiraSettings.apiToken).onChange(async (value) => {
      this.plugin.settings.jiraSettings.apiToken = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Apply Changes").setDesc("Apply emoji changes to all open notes").addButton((button) => button.setButtonText("Apply Changes").onClick(() => {
      this.plugin.refreshAllNotes();
    }));
    this.testEl = containerEl.createDiv();
    this.updateTestSection();
  }
};

// src/processor.ts
var import_obsidian2 = __toModule(require("obsidian"));
var EmojiRenderChild = class extends import_obsidian2.MarkdownRenderChild {
  constructor(span) {
    super(span);
    this.span = span;
  }
  onunload() {
  }
};
var CheckboxProcessor = class {
  static findTagInLine(listItem) {
    const text = listItem.textContent || "";
    const tagMatch = text.replace(/^[^\w\s#]*\s*/, "").match(/#(\w+)/);
    return tagMatch ? tagMatch[1] : null;
  }
  static getEmojisForTag(plugin, tag, isChecked) {
    if (!tag) {
      return isChecked ? plugin.settings.checkedEmoji : plugin.settings.uncheckedEmoji;
    }
    const mapping = plugin.settings.tagMappings.find((m) => m.tag === tag);
    if (!mapping) {
      return isChecked ? plugin.settings.checkedEmoji : plugin.settings.uncheckedEmoji;
    }
    return isChecked ? mapping.checkedEmoji : mapping.uncheckedEmoji;
  }
  static updateEditorContent(editor, lineIndex, newEmoji) {
    const lineText = editor.getLine(lineIndex);
    const newText = lineText.replace(/^[^\w\s#]*\s*/, `${newEmoji} `);
    const change = {
      from: { line: lineIndex, ch: 0 },
      to: { line: lineIndex, ch: lineText.length },
      text: newText
    };
    editor.transaction({ changes: [change] });
  }
  static createEmojiSpan(emoji) {
    const span = document.createElement("span");
    span.className = "task-list-emoji";
    span.textContent = emoji;
    return span;
  }
  static styleContainer(container) {
    if (container) {
      container.style.display = "inline-block";
      container.style.verticalAlign = "top";
      container.style.marginRight = "0.5em";
    }
  }
  static setupEventListeners(plugin, checkbox, span, tag, index, editor, sectionInfo, ctx) {
    const updateEmoji = (isChecked) => {
      const newEmoji = this.getEmojisForTag(plugin, tag, isChecked);
      span.textContent = newEmoji;
      if (editor && sectionInfo) {
        this.updateEditorContent(editor, sectionInfo.lineStart + index, newEmoji);
      }
    };
    const toggleCheckbox = async () => {
      checkbox.checked = !checkbox.checked;
      updateEmoji(checkbox.checked);
      checkbox.dispatchEvent(new Event("change", { bubbles: true }));
      checkbox.dispatchEvent(new Event("click", { bubbles: true }));
      if (ctx.sourcePath) {
        ctx.addChild(new EmojiRenderChild(span));
      }
    };
    span.addEventListener("click", async (e) => {
      e.preventDefault();
      e.stopPropagation();
      await toggleCheckbox();
    });
    checkbox.addEventListener("change", () => {
      updateEmoji(checkbox.checked);
    });
  }
  static async processCheckbox(plugin, checkbox, index, editor, sectionInfo, ctx) {
    const listItem = checkbox.closest("li.task-list-item");
    if (!listItem)
      return;
    const tag = this.findTagInLine(listItem);
    const emoji = this.getEmojisForTag(plugin, tag, checkbox.checked);
    const span = this.createEmojiSpan(emoji);
    if (editor && sectionInfo) {
      this.updateEditorContent(editor, sectionInfo.lineStart + index, emoji);
    }
    this.setupEventListeners(plugin, checkbox, span, tag, index, editor, sectionInfo, ctx);
    this.styleContainer(checkbox.parentElement);
    checkbox.style.display = "none";
    checkbox.after(span);
  }
};
var processCheckboxes = function(el, ctx) {
  const checkboxes = el.querySelectorAll('li.task-list-item input[type="checkbox"]');
  const view = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
  const editor = view == null ? void 0 : view.editor;
  const sectionInfo = ctx.getSectionInfo(el);
  checkboxes.forEach((checkbox, index) => {
    if (!(checkbox instanceof HTMLInputElement))
      return;
    CheckboxProcessor.processCheckbox(this, checkbox, index, editor, sectionInfo, ctx);
  });
};

// src/jira.ts
var import_obsidian3 = __toModule(require("obsidian"));
var JiraClient = class {
  constructor(settings) {
    this.settings = settings;
  }
  getAuthHeader() {
    const credentials = `${this.settings.username}:${this.settings.apiToken}`;
    const base64Credentials = Buffer.from(credentials).toString("base64");
    return `Basic ${base64Credentials}`;
  }
  async testConnection() {
    const baseUrl = this.settings.baseUrl.replace(/\/$/, "");
    const apiUrl = `${baseUrl}/rest/api/2/myself`;
    try {
      const response = await (0, import_obsidian3.requestUrl)({
        url: apiUrl,
        method: "GET",
        headers: {
          "Authorization": this.getAuthHeader(),
          "Accept": "application/json"
        }
      });
      return response.status === 200;
    } catch (error) {
      console.error("Connection test failed:", error);
      return false;
    }
  }
  async searchTasks(query) {
    if (!this.settings.enabled || !this.settings.baseUrl || !this.settings.apiToken) {
      throw new Error("Jira integration is not properly configured");
    }
    const isConnected = await this.testConnection();
    if (!isConnected) {
      throw new Error("Could not authenticate with Jira. Please check your credentials.");
    }
    const baseUrl = this.settings.baseUrl.replace(/\/$/, "");
    const sanitizedQuery = query.replace(/["']/g, "");
    let jql;
    if (sanitizedQuery.toLowerCase() === "my tasks" || sanitizedQuery.toLowerCase() === "assigned to me") {
      jql = "assignee = currentUser()";
    } else if (sanitizedQuery.toLowerCase().startsWith("my")) {
      const status = sanitizedQuery.toLowerCase().includes("done") ? "Done" : sanitizedQuery.toLowerCase().includes("open") ? "Open" : null;
      jql = status ? `assignee = currentUser() AND status = "${status}"` : `assignee = currentUser() AND (summary ~ "${sanitizedQuery}" OR description ~ "${sanitizedQuery}")`;
    } else {
      jql = `assignee = currentUser() AND (summary ~ "${sanitizedQuery}" OR description ~ "${sanitizedQuery}")`;
    }
    jql += " ORDER BY updated DESC";
    console.log("JQL Query:", jql);
    const apiUrl = `${baseUrl}/rest/api/2/search?jql=${encodeURIComponent(jql)}&maxResults=10&fields=summary,status`;
    console.log("API URL:", apiUrl);
    const requestParams = {
      url: apiUrl,
      method: "GET",
      headers: {
        "Authorization": this.getAuthHeader(),
        "Accept": "application/json"
      }
    };
    try {
      console.log("Making request...");
      const response = await (0, import_obsidian3.requestUrl)(requestParams);
      console.log("Response status:", response.status);
      if (response.status !== 200) {
        console.error("Error response:", response.text);
        throw new Error(`Jira API returned status ${response.status}: ${response.text}`);
      }
      if (!response.json || !response.json.issues) {
        console.error("Invalid response format:", response);
        throw new Error("Invalid response format from Jira API");
      }
      console.log("Found issues:", response.json.issues.length);
      return response.json.issues.map((issue) => {
        var _a;
        return {
          key: issue.key,
          summary: issue.fields.summary,
          url: `${baseUrl}/browse/${issue.key}`,
          status: ((_a = issue.fields.status) == null ? void 0 : _a.name) || "Unknown"
        };
      });
    } catch (error) {
      console.error("Error details:", {
        message: error.message,
        status: error.status,
        response: error.response
      });
      if (error.status === 401 || error.status === 403) {
        throw new Error("Authentication failed. Please verify:\n1. Your email address is correct\n2. Your API token is correct\n3. You have the necessary permissions");
      }
      throw error;
    }
  }
  async formatTasksAsMarkdown(tasks) {
    return tasks.map((task) => `- [ ] [${task.key}: ${task.summary}](${task.url}) (${task.status})`).join("\n");
  }
};

// src/suggester.ts
var import_obsidian4 = __toModule(require("obsidian"));
var JiraTaskSuggester = class extends import_obsidian4.SuggestModal {
  constructor(app, tasks, onSelect) {
    super(app);
    this.tasks = [];
    console.log("JiraTaskSuggester constructor called");
    console.log("Tasks received:", tasks);
    this.tasks = tasks;
    this.onSelect = onSelect;
    this.setPlaceholder("Select a Jira task...");
    this.containerEl.addClass("jira-task-suggester");
    this.containerEl.style.maxWidth = "600px";
    this.containerEl.style.margin = "0 auto";
    this.scope = new import_obsidian4.Scope();
    this.scope.register([], "Escape", () => {
      this.close();
      return false;
    });
    console.log("About to open modal");
    this.open();
  }
  open() {
    console.log("Explicitly opening modal");
    super.open();
    this.containerEl.style.display = "block";
    this.containerEl.style.visibility = "visible";
    this.containerEl.style.opacity = "1";
  }
  getSuggestions(query) {
    console.log("Getting suggestions for query:", query);
    const lowerQuery = query.toLowerCase();
    const filteredTasks = this.tasks.filter((task) => task.key.toLowerCase().includes(lowerQuery) || task.summary.toLowerCase().includes(lowerQuery));
    console.log("Filtered tasks:", filteredTasks);
    return filteredTasks;
  }
  renderSuggestion(task, el) {
    console.log("Rendering suggestion for task:", task);
    const container = el.createDiv({ cls: "jira-task-suggestion" });
    const keyEl = container.createDiv({ cls: "jira-key" });
    keyEl.setText(task.key);
    const summaryEl = container.createDiv({ cls: "jira-summary" });
    summaryEl.setText(task.summary);
    const statusEl = container.createDiv({ cls: "jira-status" });
    statusEl.setText(task.status);
    el.style.display = "flex";
    el.style.flexDirection = "column";
    el.style.gap = "4px";
    keyEl.style.fontWeight = "bold";
    keyEl.style.color = "var(--text-accent)";
    statusEl.style.fontSize = "0.8em";
    statusEl.style.color = "var(--text-muted)";
    statusEl.style.fontStyle = "italic";
  }
  onChooseSuggestion(task, evt) {
    console.log("Task chosen:", task);
    if (this.onSelect) {
      this.onSelect(task);
    }
    this.close();
  }
};

// src/main.ts
var EmojiChecklistPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    console.log("Plugin loaded with settings:", this.settings);
    this.registerEvent(this.app.workspace.on("editor-change", (editor) => {
      const cursor = editor.getCursor();
      const line = editor.getLine(cursor.line);
      const beforeCursor = line.slice(0, cursor.ch);
      const triggerWord = this.settings.jiraSettings.triggerWord;
      console.log("Checking for trigger:", {
        triggerWord,
        beforeCursor,
        endsWith: beforeCursor.endsWith(triggerWord),
        enabled: this.settings.jiraSettings.enabled
      });
      if (beforeCursor.endsWith(triggerWord)) {
        console.log("Trigger word detected, handling Jira trigger");
        this.handleJiraTrigger(editor);
      }
    }));
    this.addCommand({
      id: "insert-jira-issue",
      name: "Insert Jira Issue",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
        if (!view)
          return false;
        if (!checking) {
          this.insertJiraIssue(view);
        }
        return true;
      }
    });
    this.registerMarkdownPostProcessor(processCheckboxes.bind(this));
    this.addSettingTab(new EmojiChecklistSettingTab(this.app, this));
  }
  async insertJiraIssue(view) {
    if (!this.settings.jiraSettings.enabled) {
      new import_obsidian5.Notice("Please enable and configure Jira integration in settings first");
      return;
    }
    try {
      const jiraClient = new JiraClient(this.settings.jiraSettings);
      const tasks = await jiraClient.searchTasks("my tasks");
      if (tasks.length === 0) {
        new import_obsidian5.Notice("No Jira tasks found assigned to you");
        return;
      }
      new JiraTaskSuggester(this.app, tasks, (selectedTask) => {
        const cursor = view.editor.getCursor();
        const taskMarkdown = `- [ ] [${selectedTask.key}: ${selectedTask.summary}](${selectedTask.url}) (${selectedTask.status})`;
        view.editor.replaceRange(taskMarkdown + "\n", cursor, cursor);
        view.editor.setCursor({
          line: cursor.line + 1,
          ch: 0
        });
      });
    } catch (error) {
      console.error("Error fetching Jira tasks:", error);
      new import_obsidian5.Notice(error.message || "Error fetching Jira tasks");
    }
  }
  async handleJiraTrigger(_editor) {
    console.log("handleJiraTrigger called");
    if (!this.settings.jiraSettings.enabled) {
      console.log("Jira integration not enabled");
      new import_obsidian5.Notice("Please enable and configure Jira integration in settings first");
      return;
    }
    try {
      console.log("Creating Jira client with settings:", this.settings.jiraSettings);
      const jiraClient = new JiraClient(this.settings.jiraSettings);
      console.log("Fetching tasks...");
      const tasks = await jiraClient.searchTasks("my tasks");
      console.log("Fetched tasks:", tasks);
      if (tasks.length === 0) {
        console.log("No tasks found");
        new import_obsidian5.Notice("No Jira tasks found assigned to you");
        return;
      }
      console.log("Opening task suggester with", tasks.length, "tasks");
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
      if (!activeView) {
        console.error("No active markdown view");
        new import_obsidian5.Notice("Please open a markdown note first");
        return;
      }
      try {
        const suggester = new JiraTaskSuggester(this.app, tasks, (selectedTask) => {
          console.log("Task selected:", selectedTask);
          const editor = activeView.editor;
          const cursor = editor.getCursor();
          const currentLine = editor.getLine(cursor.line);
          const triggerWord = this.settings.jiraSettings.triggerWord;
          const newLine = currentLine.slice(0, cursor.ch - triggerWord.length) + `[${selectedTask.key}: ${selectedTask.summary}](${selectedTask.url}) (${selectedTask.status})` + currentLine.slice(cursor.ch);
          editor.setLine(cursor.line, newLine);
          editor.setCursor({
            line: cursor.line,
            ch: cursor.ch - triggerWord.length + `[${selectedTask.key}: ${selectedTask.summary}](${selectedTask.url}) (${selectedTask.status})`.length
          });
        });
        console.log("Suggester created:", suggester);
      } catch (suggesterError) {
        console.error("Error creating suggester:", suggesterError);
        new import_obsidian5.Notice("Failed to create task suggester");
      }
    } catch (error) {
      console.error("Error in handleJiraTrigger:", error);
      new import_obsidian5.Notice(error.message || "Error fetching Jira tasks");
    }
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    console.log("Loaded data:", loadedData);
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData);
    console.log("Merged settings:", this.settings);
  }
  async saveSettings() {
    console.log("Saving settings:", this.settings);
    await this.saveData(this.settings);
  }
  refreshAllNotes() {
    this.app.workspace.trigger("markdown-preview-refresh");
    this.app.workspace.iterateAllLeaves((leaf) => {
      var _a;
      if (leaf.view.getViewType() === "markdown") {
        (_a = leaf.view.previewMode) == null ? void 0 : _a.rerender(true);
      }
    });
    new import_obsidian5.Notice("Applied emoji changes to all notes");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvcHJvY2Vzc29yLnRzIiwgInNyYy9qaXJhLnRzIiwgInNyYy9zdWdnZXN0ZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7RWRpdG9yLCBNYXJrZG93blByZXZpZXdWaWV3LCBNYXJrZG93blZpZXcsIE5vdGljZSwgUGx1Z2lufSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgdHlwZSB7RW1vamlDaGVja2xpc3RTZXR0aW5nc30gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQge0RFRkFVTFRfU0VUVElOR1N9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHtFbW9qaUNoZWNrbGlzdFNldHRpbmdUYWJ9IGZyb20gJy4vc2V0dGluZ3MnO1xuaW1wb3J0IHtwcm9jZXNzQ2hlY2tib3hlc30gZnJvbSAnLi9wcm9jZXNzb3InO1xuaW1wb3J0IHtKaXJhQ2xpZW50fSBmcm9tICcuL2ppcmEnO1xuaW1wb3J0IHtKaXJhVGFza1N1Z2dlc3Rlcn0gZnJvbSAnLi9zdWdnZXN0ZXInO1xuXG4vLyBBdWdtZW50IHRoZSBNYXJrZG93blZpZXcgdHlwZSBmcm9tIE9ic2lkaWFuXG5kZWNsYXJlIG1vZHVsZSAnb2JzaWRpYW4nIHtcbiAgICBpbnRlcmZhY2UgTWFya2Rvd25WaWV3IHtcbiAgICAgICAgcHJldmlld01vZGU6IE1hcmtkb3duUHJldmlld1ZpZXc7XG4gICAgICAgIGVkaXRvcjogRWRpdG9yO1xuICAgIH1cbn0gICBcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRW1vamlDaGVja2xpc3RQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBFbW9qaUNoZWNrbGlzdFNldHRpbmdzO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICBjb25zb2xlLmxvZygnUGx1Z2luIGxvYWRlZCB3aXRoIHNldHRpbmdzOicsIHRoaXMuc2V0dGluZ3MpO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIGVkaXRvciBjaGFuZ2UgaGFuZGxlciBmb3IgQCB0cmlnZ2Vyc1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1jaGFuZ2UnLCAoZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcbiAgICAgICAgICAgICAgICBjb25zdCBiZWZvcmVDdXJzb3IgPSBsaW5lLnNsaWNlKDAsIGN1cnNvci5jaCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB3ZSBqdXN0IHR5cGVkIHRoZSB0cmlnZ2VyIHdvcmRcbiAgICAgICAgICAgICAgICBjb25zdCB0cmlnZ2VyV29yZCA9IHRoaXMuc2V0dGluZ3MuamlyYVNldHRpbmdzLnRyaWdnZXJXb3JkO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDaGVja2luZyBmb3IgdHJpZ2dlcjonLCB7XG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJXb3JkLFxuICAgICAgICAgICAgICAgICAgICBiZWZvcmVDdXJzb3IsXG4gICAgICAgICAgICAgICAgICAgIGVuZHNXaXRoOiBiZWZvcmVDdXJzb3IuZW5kc1dpdGgodHJpZ2dlcldvcmQpLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB0aGlzLnNldHRpbmdzLmppcmFTZXR0aW5ncy5lbmFibGVkXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoYmVmb3JlQ3Vyc29yLmVuZHNXaXRoKHRyaWdnZXJXb3JkKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVHJpZ2dlciB3b3JkIGRldGVjdGVkLCBoYW5kbGluZyBKaXJhIHRyaWdnZXInKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVKaXJhVHJpZ2dlcihlZGl0b3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gQWRkIGNvbW1hbmQgdG8gaW5zZXJ0IEppcmEgaXNzdWVcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnaW5zZXJ0LWppcmEtaXNzdWUnLFxuICAgICAgICAgICAgbmFtZTogJ0luc2VydCBKaXJhIElzc3VlJyxcbiAgICAgICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgICAgIGlmICghdmlldykgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICghY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnRKaXJhSXNzdWUodmlldyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKHByb2Nlc3NDaGVja2JveGVzLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEVtb2ppQ2hlY2tsaXN0U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgaW5zZXJ0SmlyYUlzc3VlKHZpZXc6IE1hcmtkb3duVmlldykge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuamlyYVNldHRpbmdzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1BsZWFzZSBlbmFibGUgYW5kIGNvbmZpZ3VyZSBKaXJhIGludGVncmF0aW9uIGluIHNldHRpbmdzIGZpcnN0Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgamlyYUNsaWVudCA9IG5ldyBKaXJhQ2xpZW50KHRoaXMuc2V0dGluZ3MuamlyYVNldHRpbmdzKTtcbiAgICAgICAgICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgamlyYUNsaWVudC5zZWFyY2hUYXNrcygnbXkgdGFza3MnKTtcblxuICAgICAgICAgICAgaWYgKHRhc2tzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIEppcmEgdGFza3MgZm91bmQgYXNzaWduZWQgdG8geW91Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZXcgSmlyYVRhc2tTdWdnZXN0ZXIodGhpcy5hcHAsIHRhc2tzLCAoc2VsZWN0ZWRUYXNrKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3Vyc29yID0gdmlldy5lZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFza01hcmtkb3duID0gYC0gWyBdIFske3NlbGVjdGVkVGFzay5rZXl9OiAke3NlbGVjdGVkVGFzay5zdW1tYXJ5fV0oJHtzZWxlY3RlZFRhc2sudXJsfSkgKCR7c2VsZWN0ZWRUYXNrLnN0YXR1c30pYDtcblxuICAgICAgICAgICAgICAgIC8vIEluc2VydCBhdCBjdXJzb3IgcG9zaXRpb25cbiAgICAgICAgICAgICAgICB2aWV3LmVkaXRvci5yZXBsYWNlUmFuZ2UoXG4gICAgICAgICAgICAgICAgICAgIHRhc2tNYXJrZG93biArICdcXG4nLFxuICAgICAgICAgICAgICAgICAgICBjdXJzb3IsXG4gICAgICAgICAgICAgICAgICAgIGN1cnNvclxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAvLyBNb3ZlIGN1cnNvciB0byBuZXh0IGxpbmVcbiAgICAgICAgICAgICAgICB2aWV3LmVkaXRvci5zZXRDdXJzb3Ioe1xuICAgICAgICAgICAgICAgICAgICBsaW5lOiBjdXJzb3IubGluZSArIDEsXG4gICAgICAgICAgICAgICAgICAgIGNoOiAwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIEppcmEgdGFza3M6JywgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShlcnJvci5tZXNzYWdlIHx8ICdFcnJvciBmZXRjaGluZyBKaXJhIHRhc2tzJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZUppcmFUcmlnZ2VyKF9lZGl0b3I6IEVkaXRvcikge1xuICAgICAgICBjb25zb2xlLmxvZygnaGFuZGxlSmlyYVRyaWdnZXIgY2FsbGVkJyk7XG5cbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmppcmFTZXR0aW5ncy5lbmFibGVkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSmlyYSBpbnRlZ3JhdGlvbiBub3QgZW5hYmxlZCcpO1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIGVuYWJsZSBhbmQgY29uZmlndXJlIEppcmEgaW50ZWdyYXRpb24gaW4gc2V0dGluZ3MgZmlyc3QnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ3JlYXRpbmcgSmlyYSBjbGllbnQgd2l0aCBzZXR0aW5nczonLCB0aGlzLnNldHRpbmdzLmppcmFTZXR0aW5ncyk7XG4gICAgICAgICAgICBjb25zdCBqaXJhQ2xpZW50ID0gbmV3IEppcmFDbGllbnQodGhpcy5zZXR0aW5ncy5qaXJhU2V0dGluZ3MpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRmV0Y2hpbmcgdGFza3MuLi4nKTtcbiAgICAgICAgICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgamlyYUNsaWVudC5zZWFyY2hUYXNrcygnbXkgdGFza3MnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGZXRjaGVkIHRhc2tzOicsIHRhc2tzKTtcblxuICAgICAgICAgICAgaWYgKHRhc2tzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyB0YXNrcyBmb3VuZCcpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIEppcmEgdGFza3MgZm91bmQgYXNzaWduZWQgdG8geW91Jyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnT3BlbmluZyB0YXNrIHN1Z2dlc3RlciB3aXRoJywgdGFza3MubGVuZ3RoLCAndGFza3MnKTtcblxuICAgICAgICAgICAgLy8gRW5zdXJlIHdlJ3JlIGluIHRoZSBjb3JyZWN0IGNvbnRleHRcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgaWYgKCFhY3RpdmVWaWV3KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gYWN0aXZlIG1hcmtkb3duIHZpZXcnKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdQbGVhc2Ugb3BlbiBhIG1hcmtkb3duIG5vdGUgZmlyc3QnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBzdWdnZXN0ZXIgd2l0aCBtb3JlIHJvYnVzdCBlcnJvciBoYW5kbGluZ1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdWdnZXN0ZXIgPSBuZXcgSmlyYVRhc2tTdWdnZXN0ZXIodGhpcy5hcHAsIHRhc2tzLCAoc2VsZWN0ZWRUYXNrKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUYXNrIHNlbGVjdGVkOicsIHNlbGVjdGVkVGFzayk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvciA9IGFjdGl2ZVZpZXcuZWRpdG9yO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaW5lID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmlnZ2VyV29yZCA9IHRoaXMuc2V0dGluZ3MuamlyYVNldHRpbmdzLnRyaWdnZXJXb3JkO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgdHJpZ2dlciB3b3JkIGFuZCByZXBsYWNlIHdpdGggdGhlIHRhc2tcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3TGluZSA9IGN1cnJlbnRMaW5lLnNsaWNlKDAsIGN1cnNvci5jaCAtIHRyaWdnZXJXb3JkLmxlbmd0aCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBbJHtzZWxlY3RlZFRhc2sua2V5fTogJHtzZWxlY3RlZFRhc2suc3VtbWFyeX1dKCR7c2VsZWN0ZWRUYXNrLnVybH0pICgke3NlbGVjdGVkVGFzay5zdGF0dXN9KWAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRMaW5lLnNsaWNlKGN1cnNvci5jaCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgY3VycmVudCBsaW5lXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRMaW5lKGN1cnNvci5saW5lLCBuZXdMaW5lKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBNb3ZlIGN1cnNvciB0byBlbmQgb2YgaW5zZXJ0ZWQgdGV4dFxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmU6IGN1cnNvci5saW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2g6IGN1cnNvci5jaCAtIHRyaWdnZXJXb3JkLmxlbmd0aCArIGBbJHtzZWxlY3RlZFRhc2sua2V5fTogJHtzZWxlY3RlZFRhc2suc3VtbWFyeX1dKCR7c2VsZWN0ZWRUYXNrLnVybH0pICgke3NlbGVjdGVkVGFzay5zdGF0dXN9KWAubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBsb2dnaW5nIHRvIHZlcmlmeSBzdWdnZXN0ZXIgY3JlYXRpb25cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3VnZ2VzdGVyIGNyZWF0ZWQ6Jywgc3VnZ2VzdGVyKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHN1Z2dlc3RlckVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3VnZ2VzdGVyOicsIHN1Z2dlc3RlckVycm9yKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gY3JlYXRlIHRhc2sgc3VnZ2VzdGVyJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBoYW5kbGVKaXJhVHJpZ2dlcjonLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGVycm9yLm1lc3NhZ2UgfHwgJ0Vycm9yIGZldGNoaW5nIEppcmEgdGFza3MnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgY29uc3QgbG9hZGVkRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcbiAgICAgICAgY29uc29sZS5sb2coJ0xvYWRlZCBkYXRhOicsIGxvYWRlZERhdGEpO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgbG9hZGVkRGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdNZXJnZWQgc2V0dGluZ3M6JywgdGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2aW5nIHNldHRpbmdzOicsIHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHJlZnJlc2hBbGxOb3RlcygpIHtcbiAgICAgICAgLy8gRm9yY2UgcmVmcmVzaCBhbGwgbWFya2Rvd24gdmlld3NcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnRyaWdnZXIoJ21hcmtkb3duLXByZXZpZXctcmVmcmVzaCcpO1xuXG4gICAgICAgIC8vIEZvcmNlIHJlLXJlbmRlciBvZiBhbGwgbGVhZiB2aWV3c1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuaXRlcmF0ZUFsbExlYXZlcyhsZWFmID0+IHtcbiAgICAgICAgICAgIGlmIChsZWFmLnZpZXcuZ2V0Vmlld1R5cGUoKSA9PT0gJ21hcmtkb3duJykge1xuICAgICAgICAgICAgICAgIChsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3KS5wcmV2aWV3TW9kZT8ucmVyZW5kZXIodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBOb3RpY2UoJ0FwcGxpZWQgZW1vamkgY2hhbmdlcyB0byBhbGwgbm90ZXMnKTtcbiAgICB9XG59XG4iLCAiZXhwb3J0IGludGVyZmFjZSBUYWdFbW9qaU1hcHBpbmcge1xuICAgIHRhZzogc3RyaW5nO1xuICAgIHVuY2hlY2tlZEVtb2ppOiBzdHJpbmc7XG4gICAgY2hlY2tlZEVtb2ppOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSmlyYVNldHRpbmdzIHtcbiAgICBlbmFibGVkOiBib29sZWFuO1xuICAgIGJhc2VVcmw6IHN0cmluZztcbiAgICB1c2VybmFtZTogc3RyaW5nO1xuICAgIGFwaVRva2VuOiBzdHJpbmc7XG4gICAgdHJpZ2dlcldvcmQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbW9qaUNoZWNrbGlzdFNldHRpbmdzIHtcbiAgICBjaGVja2VkRW1vamk6IHN0cmluZztcbiAgICB1bmNoZWNrZWRFbW9qaTogc3RyaW5nO1xuICAgIHRhZ01hcHBpbmdzOiBUYWdFbW9qaU1hcHBpbmdbXTtcbiAgICBqaXJhU2V0dGluZ3M6IEppcmFTZXR0aW5ncztcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEVtb2ppQ2hlY2tsaXN0U2V0dGluZ3MgPSB7XG4gICAgY2hlY2tlZEVtb2ppOiAnXHUyNzA1JyxcbiAgICB1bmNoZWNrZWRFbW9qaTogJ1x1MkIxQ1x1RkUwRicsXG4gICAgdGFnTWFwcGluZ3M6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgdGFnOiAnc3RvcHBlcicsXG4gICAgICAgICAgICB1bmNoZWNrZWRFbW9qaTogJ1x1RDgzRFx1REVEMScsXG4gICAgICAgICAgICBjaGVja2VkRW1vamk6ICdcdTI3MDUnXG4gICAgICAgIH1cbiAgICBdLFxuICAgIGppcmFTZXR0aW5nczoge1xuICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgYmFzZVVybDogJycsXG4gICAgICAgIHVzZXJuYW1lOiAnJyxcbiAgICAgICAgYXBpVG9rZW46ICcnLFxuICAgICAgICB0cmlnZ2VyV29yZDogJ0BKaXJhJ1xuICAgIH1cbn07IiwgImltcG9ydCB7QXBwLCBOb3RpY2UsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmd9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBFbW9qaUNoZWNrbGlzdFBsdWdpbiBmcm9tICcuL21haW4nO1xuaW1wb3J0IHtERUZBVUxUX1NFVFRJTkdTfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEVtb2ppQ2hlY2tsaXN0U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogRW1vamlDaGVja2xpc3RQbHVnaW47XG4gICAgdGVzdEVsOiBIVE1MRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEVtb2ppQ2hlY2tsaXN0UGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgdXBkYXRlVGVzdFNlY3Rpb24oKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnRlc3RFbCkge1xuICAgICAgICAgICAgdGhpcy50ZXN0RWwuZW1wdHkoKTtcblxuICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gdGhpcy50ZXN0RWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnTGl2ZSBQcmV2aWV3JyB9KTtcblxuICAgICAgICAgICAgY29uc3QgdW5jaGVja2VkRXhhbXBsZSA9IHRoaXMudGVzdEVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3NldHRpbmctaXRlbScgfSk7XG4gICAgICAgICAgICB1bmNoZWNrZWRFeGFtcGxlLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnVW5jaGVja2VkIGV4YW1wbGU6ICcgfSk7XG4gICAgICAgICAgICBjb25zdCB1bmNoZWNrZWRDb250YWluZXIgPSB1bmNoZWNrZWRFeGFtcGxlLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICd0YXNrLXByZXZpZXcnIH0pO1xuICAgICAgICAgICAgdW5jaGVja2VkQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywge1xuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMucGx1Z2luLnNldHRpbmdzLnVuY2hlY2tlZEVtb2ppLFxuICAgICAgICAgICAgICAgIGNsczogJ2Vtb2ppLXByZXZpZXcnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHVuY2hlY2tlZENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogJyBTYW1wbGUgdGFzaycgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGNoZWNrZWRFeGFtcGxlID0gdGhpcy50ZXN0RWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnc2V0dGluZy1pdGVtJyB9KTtcbiAgICAgICAgICAgIGNoZWNrZWRFeGFtcGxlLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnQ2hlY2tlZCBleGFtcGxlOiAnIH0pO1xuICAgICAgICAgICAgY29uc3QgY2hlY2tlZENvbnRhaW5lciA9IGNoZWNrZWRFeGFtcGxlLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICd0YXNrLXByZXZpZXcnIH0pO1xuICAgICAgICAgICAgY2hlY2tlZENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jaGVja2VkRW1vamksXG4gICAgICAgICAgICAgICAgY2xzOiAnZW1vamktcHJldmlldydcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgY2hlY2tlZFRleHQgPSBjaGVja2VkQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnIFNhbXBsZSB0YXNrJyB9KTtcbiAgICAgICAgICAgIGNoZWNrZWRUZXh0LnN0eWxlLnRleHREZWNvcmF0aW9uID0gJ2xpbmUtdGhyb3VnaCc7XG4gICAgICAgICAgICBjaGVja2VkVGV4dC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG5cbiAgICAgICAgICAgIC8vIEFkZCB0YWcgZXhhbXBsZXNcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFnSGVhZGVyID0gdGhpcy50ZXN0RWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnVGFnIEV4YW1wbGVzJyB9KTtcbiAgICAgICAgICAgICAgICB0YWdIZWFkZXIuc3R5bGUubWFyZ2luVG9wID0gJzJlbSc7XG4gICAgICAgICAgICAgICAgdGFnSGVhZGVyLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxZW0nO1xuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYXBwaW5nIG9mIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ1VuY2hlY2tlZEV4YW1wbGUgPSB0aGlzLnRlc3RFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdzZXR0aW5nLWl0ZW0nIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YWdVbmNoZWNrZWRFeGFtcGxlLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBgIyR7bWFwcGluZy50YWd9IHVuY2hlY2tlZDogYCB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnVW5jaGVja2VkQ29udGFpbmVyID0gdGFnVW5jaGVja2VkRXhhbXBsZS5jcmVhdGVFbCgnc3BhbicsIHsgY2xzOiAndGFzay1wcmV2aWV3JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFnVW5jaGVja2VkQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbWFwcGluZy51bmNoZWNrZWRFbW9qaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsczogJ2Vtb2ppLXByZXZpZXcnXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YWdVbmNoZWNrZWRDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IGAgU2FtcGxlICMke21hcHBpbmcudGFnfSB0YXNrYCB9KTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdDaGVja2VkRXhhbXBsZSA9IHRoaXMudGVzdEVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3NldHRpbmctaXRlbScgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NoZWNrZWRFeGFtcGxlLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBgIyR7bWFwcGluZy50YWd9IGNoZWNrZWQ6IGAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ0NoZWNrZWRDb250YWluZXIgPSB0YWdDaGVja2VkRXhhbXBsZS5jcmVhdGVFbCgnc3BhbicsIHsgY2xzOiAndGFzay1wcmV2aWV3JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2hlY2tlZENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1hcHBpbmcuY2hlY2tlZEVtb2ppLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiAnZW1vamktcHJldmlldydcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ0NoZWNrZWRUZXh0ID0gdGFnQ2hlY2tlZENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogYCBTYW1wbGUgIyR7bWFwcGluZy50YWd9IHRhc2tgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YWdDaGVja2VkVGV4dC5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9ICdsaW5lLXRocm91Z2gnO1xuICAgICAgICAgICAgICAgICAgICB0YWdDaGVja2VkVGV4dC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG5cbiAgICAgICAgICAgICAgICAgICAgdGFnVW5jaGVja2VkRXhhbXBsZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMC41ZW0nO1xuICAgICAgICAgICAgICAgICAgICB0YWdDaGVja2VkRXhhbXBsZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMC41ZW0nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaGVhZGVyLnN0eWxlLm1hcmdpblRvcCA9ICcyZW0nO1xuICAgICAgICAgICAgaGVhZGVyLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxZW0nO1xuICAgICAgICAgICAgdW5jaGVja2VkRXhhbXBsZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMC41ZW0nO1xuICAgICAgICAgICAgY2hlY2tlZEV4YW1wbGUuc3R5bGUubWFyZ2luQm90dG9tID0gJzAuNWVtJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnRW1vamkgQ2hlY2tsaXN0IFNldHRpbmdzJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdEZWZhdWx0IFVuY2hlY2tlZCBFbW9qaScpXG4gICAgICAgICAgICAuc2V0RGVzYygnRW1vamkgdG8gZGlzcGxheSBmb3IgdW5jaGVja2VkIHRhc2tzJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51bmNoZWNrZWRFbW9qaSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnVuY2hlY2tlZEVtb2ppID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRlc3RTZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGVkIGRlZmF1bHQgdW5jaGVja2VkIGVtb2ppOicsIHRoaXMucGx1Z2luLnNldHRpbmdzLnVuY2hlY2tlZEVtb2ppKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRGVmYXVsdCBDaGVja2VkIEVtb2ppJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdFbW9qaSB0byBkaXNwbGF5IGZvciBjaGVja2VkIHRhc2tzJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jaGVja2VkRW1vamkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jaGVja2VkRW1vamkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGVzdFNlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VwZGF0ZWQgZGVmYXVsdCBjaGVja2VkIGVtb2ppOicsIHRoaXMucGx1Z2luLnNldHRpbmdzLmNoZWNrZWRFbW9qaSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1RhZyBNYXBwaW5ncycgfSk7XG5cbiAgICAgICAgY29uc3QgdGFnTWFwcGluZ3NDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ3RhZy1tYXBwaW5ncycpO1xuXG4gICAgICAgIC8vIEFkZCBleGlzdGluZyB0YWcgbWFwcGluZ3NcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MuZm9yRWFjaCgobWFwcGluZywgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1hcHBpbmdDb250YWluZXIgPSB0YWdNYXBwaW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoJ3RhZy1tYXBwaW5nJyk7XG5cbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKG1hcHBpbmdDb250YWluZXIpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoYFRhZyAjJHttYXBwaW5nLnRhZ31gKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3RhZyBuYW1lJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKG1hcHBpbmcudGFnKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5nc1tpbmRleF0udGFnID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGVzdFNlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGVkIHRhZyBtYXBwaW5nOicsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigndW5jaGVja2VkIGVtb2ppJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKG1hcHBpbmcudW5jaGVja2VkRW1vamkpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzW2luZGV4XS51bmNoZWNrZWRFbW9qaSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRlc3RTZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBkYXRlZCB0YWcgbWFwcGluZzonLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2NoZWNrZWQgZW1vamknKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUobWFwcGluZy5jaGVja2VkRW1vamkpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzW2luZGV4XS5jaGVja2VkRW1vamkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUZXN0U2VjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VwZGF0ZWQgdGFnIG1hcHBpbmc6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ3RyYXNoJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUmVtb3ZlZCB0YWcgbWFwcGluZywgcmVtYWluaW5nOicsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgYnV0dG9uIHRvIGFkZCBuZXcgdGFnIG1hcHBpbmdcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQWRkIFRhZyBNYXBwaW5nJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdBZGQgYSBuZXcgdGFnLWVtb2ppIG1hcHBpbmcnKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0FkZCBOZXcgVGFnJylcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFnOiAnbmV3dGFnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuY2hlY2tlZEVtb2ppOiAnXHUyQjU1JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWRFbW9qaTogJ1x1MjcwNSdcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQWRkZWQgbmV3IHRhZyBtYXBwaW5nOicsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1Jlc2V0IFNldHRpbmdzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdSZXN0b3JlIGFsbCBzZXR0aW5ncyB0byB0aGVpciBkZWZhdWx0cycpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVzdG9yZSBEZWZhdWx0cycpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1Jlc2V0IHNldHRpbmdzIHRvIGRlZmF1bHRzOicsIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1NldHRpbmdzIHJlc3RvcmVkIHRvIGRlZmF1bHRzJyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIEppcmEgU2V0dGluZ3NcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnSmlyYSBJbnRlZ3JhdGlvbicgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRW5hYmxlIEppcmEgSW50ZWdyYXRpb24nKVxuICAgICAgICAgICAgLnNldERlc2MoJ0VuYWJsZSBvciBkaXNhYmxlIEppcmEgaW50ZWdyYXRpb24nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmppcmFTZXR0aW5ncy5lbmFibGVkKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuamlyYVNldHRpbmdzLmVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1RyaWdnZXIgV29yZCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnV29yZCB0aGF0IHRyaWdnZXJzIEppcmEgdGFzayBpbnNlcnRpb24gKGUuZy4sIEBqaXJhKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0BqaXJhJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuamlyYVNldHRpbmdzLnRyaWdnZXJXb3JkKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuamlyYVNldHRpbmdzLnRyaWdnZXJXb3JkID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdKaXJhIEJhc2UgVVJMJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdZb3VyIEppcmEgaW5zdGFuY2UgVVJMIChlLmcuLCBodHRwczovL3lvdXItZG9tYWluLmF0bGFzc2lhbi5uZXQpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignaHR0cHM6Ly95b3VyLWRvbWFpbi5hdGxhc3NpYW4ubmV0JylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuamlyYVNldHRpbmdzLmJhc2VVcmwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5qaXJhU2V0dGluZ3MuYmFzZVVybCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVXNlcm5hbWUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgSmlyYSBlbWFpbCBhZGRyZXNzJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZW1haWxAZXhhbXBsZS5jb20nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5qaXJhU2V0dGluZ3MudXNlcm5hbWUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5qaXJhU2V0dGluZ3MudXNlcm5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0FQSSBUb2tlbicpXG4gICAgICAgICAgICAuc2V0RGVzYygnWW91ciBKaXJhIEFQSSB0b2tlbiAoZnJvbSBodHRwczovL2lkLmF0bGFzc2lhbi5jb20vbWFuYWdlLXByb2ZpbGUvc2VjdXJpdHkvYXBpLXRva2VucyknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciB5b3VyIEFQSSB0b2tlbicpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmppcmFTZXR0aW5ncy5hcGlUb2tlbilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmppcmFTZXR0aW5ncy5hcGlUb2tlbiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gQWRkIEFwcGx5IENoYW5nZXMgYnV0dG9uXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0FwcGx5IENoYW5nZXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0FwcGx5IGVtb2ppIGNoYW5nZXMgdG8gYWxsIG9wZW4gbm90ZXMnKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0FwcGx5IENoYW5nZXMnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ucmVmcmVzaEFsbE5vdGVzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIHRoaXMudGVzdEVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMudXBkYXRlVGVzdFNlY3Rpb24oKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHR5cGUge01hcmtkb3duUG9zdFByb2Nlc3NvciwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHtNYXJrZG93blJlbmRlckNoaWxkLCBNYXJrZG93blZpZXd9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB0eXBlIEVtb2ppQ2hlY2tsaXN0UGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmludGVyZmFjZSBFZGl0b3JDaGFuZ2Uge1xuICAgIGZyb206IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH07XG4gICAgdG86IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH07XG4gICAgdGV4dDogc3RyaW5nO1xufVxuXG5jbGFzcyBFbW9qaVJlbmRlckNoaWxkIGV4dGVuZHMgTWFya2Rvd25SZW5kZXJDaGlsZCB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBzcGFuOiBIVE1MU3BhbkVsZW1lbnQpIHtcbiAgICAgICAgc3VwZXIoc3Bhbik7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKTogdm9pZCB7XG4gICAgICAgIC8vIENsZWFudXAgaGFuZGxlZCBieSBwYXJlbnRcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDaGVja2JveFByb2Nlc3NvciB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgZmluZFRhZ0luTGluZShsaXN0SXRlbTogSFRNTEVsZW1lbnQpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IGxpc3RJdGVtLnRleHRDb250ZW50IHx8ICcnO1xuICAgICAgICBjb25zdCB0YWdNYXRjaCA9IHRleHQucmVwbGFjZSgvXlteXFx3XFxzI10qXFxzKi8sICcnKS5tYXRjaCgvIyhcXHcrKS8pO1xuICAgICAgICByZXR1cm4gdGFnTWF0Y2ggPyB0YWdNYXRjaFsxXSA6IG51bGw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgZ2V0RW1vamlzRm9yVGFnKFxuICAgICAgICBwbHVnaW46IEVtb2ppQ2hlY2tsaXN0UGx1Z2luLFxuICAgICAgICB0YWc6IHN0cmluZyB8IG51bGwsXG4gICAgICAgIGlzQ2hlY2tlZDogYm9vbGVhblxuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGlmICghdGFnKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNDaGVja2VkID8gcGx1Z2luLnNldHRpbmdzLmNoZWNrZWRFbW9qaSA6IHBsdWdpbi5zZXR0aW5ncy51bmNoZWNrZWRFbW9qaTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG1hcHBpbmcgPSBwbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MuZmluZCgobSkgPT4gbS50YWcgPT09IHRhZyk7XG4gICAgICAgIGlmICghbWFwcGluZykge1xuICAgICAgICAgICAgcmV0dXJuIGlzQ2hlY2tlZCA/IHBsdWdpbi5zZXR0aW5ncy5jaGVja2VkRW1vamkgOiBwbHVnaW4uc2V0dGluZ3MudW5jaGVja2VkRW1vamk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaXNDaGVja2VkID8gbWFwcGluZy5jaGVja2VkRW1vamkgOiBtYXBwaW5nLnVuY2hlY2tlZEVtb2ppO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIHVwZGF0ZUVkaXRvckNvbnRlbnQoXG4gICAgICAgIGVkaXRvcjogYW55LFxuICAgICAgICBsaW5lSW5kZXg6IG51bWJlcixcbiAgICAgICAgbmV3RW1vamk6IHN0cmluZ1xuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBsaW5lVGV4dCA9IGVkaXRvci5nZXRMaW5lKGxpbmVJbmRleCk7XG4gICAgICAgIGNvbnN0IG5ld1RleHQgPSBsaW5lVGV4dC5yZXBsYWNlKC9eW15cXHdcXHMjXSpcXHMqLywgYCR7bmV3RW1vaml9IGApO1xuXG4gICAgICAgIGNvbnN0IGNoYW5nZTogRWRpdG9yQ2hhbmdlID0ge1xuICAgICAgICAgICAgZnJvbTogeyBsaW5lOiBsaW5lSW5kZXgsIGNoOiAwIH0sXG4gICAgICAgICAgICB0bzogeyBsaW5lOiBsaW5lSW5kZXgsIGNoOiBsaW5lVGV4dC5sZW5ndGggfSxcbiAgICAgICAgICAgIHRleHQ6IG5ld1RleHRcbiAgICAgICAgfTtcblxuICAgICAgICBlZGl0b3IudHJhbnNhY3Rpb24oeyBjaGFuZ2VzOiBbY2hhbmdlXSB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBjcmVhdGVFbW9qaVNwYW4oZW1vamk6IHN0cmluZyk6IEhUTUxTcGFuRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHNwYW4uY2xhc3NOYW1lID0gJ3Rhc2stbGlzdC1lbW9qaSc7XG4gICAgICAgIHNwYW4udGV4dENvbnRlbnQgPSBlbW9qaTtcbiAgICAgICAgcmV0dXJuIHNwYW47XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgc3R5bGVDb250YWluZXIoY29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwpOiB2b2lkIHtcbiAgICAgICAgaWYgKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS52ZXJ0aWNhbEFsaWduID0gJ3RvcCc7XG4gICAgICAgICAgICBjb250YWluZXIuc3R5bGUubWFyZ2luUmlnaHQgPSAnMC41ZW0nO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgc2V0dXBFdmVudExpc3RlbmVycyhcbiAgICAgICAgcGx1Z2luOiBFbW9qaUNoZWNrbGlzdFBsdWdpbixcbiAgICAgICAgY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIHNwYW46IEhUTUxTcGFuRWxlbWVudCxcbiAgICAgICAgdGFnOiBzdHJpbmcgfCBudWxsLFxuICAgICAgICBpbmRleDogbnVtYmVyLFxuICAgICAgICBlZGl0b3I6IGFueSxcbiAgICAgICAgc2VjdGlvbkluZm86IGFueSxcbiAgICAgICAgY3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZUVtb2ppID0gKGlzQ2hlY2tlZDogYm9vbGVhbik6IHZvaWQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3RW1vamkgPSB0aGlzLmdldEVtb2ppc0ZvclRhZyhwbHVnaW4sIHRhZywgaXNDaGVja2VkKTtcbiAgICAgICAgICAgIHNwYW4udGV4dENvbnRlbnQgPSBuZXdFbW9qaTtcblxuICAgICAgICAgICAgaWYgKGVkaXRvciAmJiBzZWN0aW9uSW5mbykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRWRpdG9yQ29udGVudChlZGl0b3IsIHNlY3Rpb25JbmZvLmxpbmVTdGFydCArIGluZGV4LCBuZXdFbW9qaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgdG9nZ2xlQ2hlY2tib3ggPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjaGVja2JveC5jaGVja2VkID0gIWNoZWNrYm94LmNoZWNrZWQ7XG4gICAgICAgICAgICB1cGRhdGVFbW9qaShjaGVja2JveC5jaGVja2VkKTtcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIGFuZCBkaXNwYXRjaCBib3RoIGNoYW5nZSBhbmQgY2xpY2sgZXZlbnRzXG4gICAgICAgICAgICBjaGVja2JveC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJywgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgICAgICAgICAgIGNoZWNrYm94LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdjbGljaycsIHsgYnViYmxlczogdHJ1ZSB9KSk7XG5cbiAgICAgICAgICAgIGlmIChjdHguc291cmNlUGF0aCkge1xuICAgICAgICAgICAgICAgIGN0eC5hZGRDaGlsZChuZXcgRW1vamlSZW5kZXJDaGlsZChzcGFuKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc3Bhbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgYXdhaXQgdG9nZ2xlQ2hlY2tib3goKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgdXBkYXRlRW1vamkoY2hlY2tib3guY2hlY2tlZCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgcHJvY2Vzc0NoZWNrYm94KFxuICAgICAgICBwbHVnaW46IEVtb2ppQ2hlY2tsaXN0UGx1Z2luLFxuICAgICAgICBjaGVja2JveDogSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgaW5kZXg6IG51bWJlcixcbiAgICAgICAgZWRpdG9yOiBhbnksXG4gICAgICAgIHNlY3Rpb25JbmZvOiBhbnksXG4gICAgICAgIGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBsaXN0SXRlbSA9IGNoZWNrYm94LmNsb3Nlc3QoJ2xpLnRhc2stbGlzdC1pdGVtJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgIGlmICghbGlzdEl0ZW0pIHJldHVybjtcblxuICAgICAgICBjb25zdCB0YWcgPSB0aGlzLmZpbmRUYWdJbkxpbmUobGlzdEl0ZW0pO1xuICAgICAgICBjb25zdCBlbW9qaSA9IHRoaXMuZ2V0RW1vamlzRm9yVGFnKHBsdWdpbiwgdGFnLCBjaGVja2JveC5jaGVja2VkKTtcbiAgICAgICAgY29uc3Qgc3BhbiA9IHRoaXMuY3JlYXRlRW1vamlTcGFuKGVtb2ppKTtcblxuICAgICAgICBpZiAoZWRpdG9yICYmIHNlY3Rpb25JbmZvKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUVkaXRvckNvbnRlbnQoZWRpdG9yLCBzZWN0aW9uSW5mby5saW5lU3RhcnQgKyBpbmRleCwgZW1vamkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXR1cEV2ZW50TGlzdGVuZXJzKFxuICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgY2hlY2tib3gsXG4gICAgICAgICAgICBzcGFuLFxuICAgICAgICAgICAgdGFnLFxuICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICBlZGl0b3IsXG4gICAgICAgICAgICBzZWN0aW9uSW5mbyxcbiAgICAgICAgICAgIGN0eFxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuc3R5bGVDb250YWluZXIoY2hlY2tib3gucGFyZW50RWxlbWVudCk7XG4gICAgICAgIGNoZWNrYm94LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIGNoZWNrYm94LmFmdGVyKHNwYW4pO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IHByb2Nlc3NDaGVja2JveGVzOiBNYXJrZG93blBvc3RQcm9jZXNzb3IgPSBmdW5jdGlvbihcbiAgICB0aGlzOiBFbW9qaUNoZWNrbGlzdFBsdWdpbixcbiAgICBlbDogSFRNTEVsZW1lbnQsXG4gICAgY3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0XG4pOiB2b2lkIHtcbiAgICBjb25zdCBjaGVja2JveGVzID0gZWwucXVlcnlTZWxlY3RvckFsbDxIVE1MSW5wdXRFbGVtZW50PignbGkudGFzay1saXN0LWl0ZW0gaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJyk7XG4gICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgY29uc3QgZWRpdG9yID0gdmlldz8uZWRpdG9yO1xuICAgIGNvbnN0IHNlY3Rpb25JbmZvID0gY3R4LmdldFNlY3Rpb25JbmZvKGVsKTtcblxuICAgIGNoZWNrYm94ZXMuZm9yRWFjaCgoY2hlY2tib3gsIGluZGV4KSA9PiB7XG4gICAgICAgIGlmICghKGNoZWNrYm94IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkpIHJldHVybjtcblxuICAgICAgICBDaGVja2JveFByb2Nlc3Nvci5wcm9jZXNzQ2hlY2tib3goXG4gICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgY2hlY2tib3gsXG4gICAgICAgICAgICBpbmRleCxcbiAgICAgICAgICAgIGVkaXRvcixcbiAgICAgICAgICAgIHNlY3Rpb25JbmZvLFxuICAgICAgICAgICAgY3R4XG4gICAgICAgICk7XG4gICAgfSk7XG59O1xuIiwgImltcG9ydCB7IHJlcXVlc3RVcmwsIFJlcXVlc3RVcmxQYXJhbSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB0eXBlIHsgSmlyYVNldHRpbmdzIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSmlyYVRhc2sge1xuICAgIGtleTogc3RyaW5nO1xuICAgIHN1bW1hcnk6IHN0cmluZztcbiAgICB1cmw6IHN0cmluZztcbiAgICBzdGF0dXM6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEppcmFDbGllbnQge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgc2V0dGluZ3M6IEppcmFTZXR0aW5ncykge31cblxuICAgIHByaXZhdGUgZ2V0QXV0aEhlYWRlcigpOiBzdHJpbmcge1xuICAgICAgICAvLyBFbnN1cmUgd2UncmUgdXNpbmcgdGhlIGVtYWlsIGFkZHJlc3MgYW5kIEFQSSB0b2tlblxuICAgICAgICBjb25zdCBjcmVkZW50aWFscyA9IGAke3RoaXMuc2V0dGluZ3MudXNlcm5hbWV9OiR7dGhpcy5zZXR0aW5ncy5hcGlUb2tlbn1gO1xuICAgICAgICAvLyBDb252ZXJ0IHRvIGJhc2U2NCwgaGFuZGxpbmcgVW5pY29kZSBjaGFyYWN0ZXJzIGNvcnJlY3RseVxuICAgICAgICBjb25zdCBiYXNlNjRDcmVkZW50aWFscyA9IEJ1ZmZlci5mcm9tKGNyZWRlbnRpYWxzKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgICAgIHJldHVybiBgQmFzaWMgJHtiYXNlNjRDcmVkZW50aWFsc31gO1xuICAgIH1cblxuICAgIGFzeW5jIHRlc3RDb25uZWN0aW9uKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBjb25zdCBiYXNlVXJsID0gdGhpcy5zZXR0aW5ncy5iYXNlVXJsLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgICAgIGNvbnN0IGFwaVVybCA9IGAke2Jhc2VVcmx9L3Jlc3QvYXBpLzIvbXlzZWxmYDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgICAgICB1cmw6IGFwaVVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiB0aGlzLmdldEF1dGhIZWFkZXIoKSxcbiAgICAgICAgICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzID09PSAyMDA7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDb25uZWN0aW9uIHRlc3QgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHNlYXJjaFRhc2tzKHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPEppcmFUYXNrW10+IHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmVuYWJsZWQgfHwgIXRoaXMuc2V0dGluZ3MuYmFzZVVybCB8fCAhdGhpcy5zZXR0aW5ncy5hcGlUb2tlbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdKaXJhIGludGVncmF0aW9uIGlzIG5vdCBwcm9wZXJseSBjb25maWd1cmVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUZXN0IGNvbm5lY3Rpb24gZmlyc3RcbiAgICAgICAgY29uc3QgaXNDb25uZWN0ZWQgPSBhd2FpdCB0aGlzLnRlc3RDb25uZWN0aW9uKCk7XG4gICAgICAgIGlmICghaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGF1dGhlbnRpY2F0ZSB3aXRoIEppcmEuIFBsZWFzZSBjaGVjayB5b3VyIGNyZWRlbnRpYWxzLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRW5zdXJlIHRoZSBiYXNlIFVSTCBkb2Vzbid0IGVuZCB3aXRoIGEgc2xhc2hcbiAgICAgICAgY29uc3QgYmFzZVVybCA9IHRoaXMuc2V0dGluZ3MuYmFzZVVybC5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xlYW4gdXAgdGhlIHF1ZXJ5IHRvIHByZXZlbnQgSlFMIGluamVjdGlvblxuICAgICAgICBjb25zdCBzYW5pdGl6ZWRRdWVyeSA9IHF1ZXJ5LnJlcGxhY2UoL1tcIiddL2csICcnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSBzcGVjaWFsIHF1ZXJpZXNcbiAgICAgICAgbGV0IGpxbDogc3RyaW5nO1xuICAgICAgICBpZiAoc2FuaXRpemVkUXVlcnkudG9Mb3dlckNhc2UoKSA9PT0gJ215IHRhc2tzJyB8fCBzYW5pdGl6ZWRRdWVyeS50b0xvd2VyQ2FzZSgpID09PSAnYXNzaWduZWQgdG8gbWUnKSB7XG4gICAgICAgICAgICBqcWwgPSAnYXNzaWduZWUgPSBjdXJyZW50VXNlcigpJztcbiAgICAgICAgfSBlbHNlIGlmIChzYW5pdGl6ZWRRdWVyeS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ215JykpIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBcIm15IG9wZW4gdGFza3NcIiwgXCJteSBkb25lIHRhc2tzXCIsIGV0Yy5cbiAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IHNhbml0aXplZFF1ZXJ5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2RvbmUnKSA/ICdEb25lJyA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzYW5pdGl6ZWRRdWVyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdvcGVuJykgPyAnT3BlbicgOiBudWxsO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBqcWwgPSBzdGF0dXMgXG4gICAgICAgICAgICAgICAgPyBgYXNzaWduZWUgPSBjdXJyZW50VXNlcigpIEFORCBzdGF0dXMgPSBcIiR7c3RhdHVzfVwiYFxuICAgICAgICAgICAgICAgIDogYGFzc2lnbmVlID0gY3VycmVudFVzZXIoKSBBTkQgKHN1bW1hcnkgfiBcIiR7c2FuaXRpemVkUXVlcnl9XCIgT1IgZGVzY3JpcHRpb24gfiBcIiR7c2FuaXRpemVkUXVlcnl9XCIpYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGpxbCA9IGBhc3NpZ25lZSA9IGN1cnJlbnRVc2VyKCkgQU5EIChzdW1tYXJ5IH4gXCIke3Nhbml0aXplZFF1ZXJ5fVwiIE9SIGRlc2NyaXB0aW9uIH4gXCIke3Nhbml0aXplZFF1ZXJ5fVwiKWA7XG4gICAgICAgIH1cblxuICAgICAgICBqcWwgKz0gJyBPUkRFUiBCWSB1cGRhdGVkIERFU0MnO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coJ0pRTCBRdWVyeTonLCBqcWwpO1xuICAgICAgICBjb25zdCBhcGlVcmwgPSBgJHtiYXNlVXJsfS9yZXN0L2FwaS8yL3NlYXJjaD9qcWw9JHtlbmNvZGVVUklDb21wb25lbnQoanFsKX0mbWF4UmVzdWx0cz0xMCZmaWVsZHM9c3VtbWFyeSxzdGF0dXNgO1xuICAgICAgICBjb25zb2xlLmxvZygnQVBJIFVSTDonLCBhcGlVcmwpO1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RQYXJhbXM6IFJlcXVlc3RVcmxQYXJhbSA9IHtcbiAgICAgICAgICAgIHVybDogYXBpVXJsLFxuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IHRoaXMuZ2V0QXV0aEhlYWRlcigpLFxuICAgICAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ01ha2luZyByZXF1ZXN0Li4uJyk7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwocmVxdWVzdFBhcmFtcyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2Ugc3RhdHVzOicsIHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlc3BvbnNlOicsIHJlc3BvbnNlLnRleHQpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSmlyYSBBUEkgcmV0dXJuZWQgc3RhdHVzICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS50ZXh0fWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLmpzb24gfHwgIXJlc3BvbnNlLmpzb24uaXNzdWVzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQ6JywgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBKaXJhIEFQSScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgaXNzdWVzOicsIHJlc3BvbnNlLmpzb24uaXNzdWVzLmxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbi5pc3N1ZXMubWFwKChpc3N1ZTogYW55KSA9PiAoe1xuICAgICAgICAgICAgICAgIGtleTogaXNzdWUua2V5LFxuICAgICAgICAgICAgICAgIHN1bW1hcnk6IGlzc3VlLmZpZWxkcy5zdW1tYXJ5LFxuICAgICAgICAgICAgICAgIHVybDogYCR7YmFzZVVybH0vYnJvd3NlLyR7aXNzdWUua2V5fWAsXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBpc3N1ZS5maWVsZHMuc3RhdHVzPy5uYW1lIHx8ICdVbmtub3duJ1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGV0YWlsczonLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGVycm9yLnN0YXR1cyxcbiAgICAgICAgICAgICAgICByZXNwb25zZTogZXJyb3IucmVzcG9uc2VcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDEgfHwgZXJyb3Iuc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZC4gUGxlYXNlIHZlcmlmeTpcXG4xLiBZb3VyIGVtYWlsIGFkZHJlc3MgaXMgY29ycmVjdFxcbjIuIFlvdXIgQVBJIHRva2VuIGlzIGNvcnJlY3RcXG4zLiBZb3UgaGF2ZSB0aGUgbmVjZXNzYXJ5IHBlcm1pc3Npb25zJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGZvcm1hdFRhc2tzQXNNYXJrZG93bih0YXNrczogSmlyYVRhc2tbXSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHJldHVybiB0YXNrcy5tYXAodGFzayA9PiBcbiAgICAgICAgICAgIGAtIFsgXSBbJHt0YXNrLmtleX06ICR7dGFzay5zdW1tYXJ5fV0oJHt0YXNrLnVybH0pICgke3Rhc2suc3RhdHVzfSlgXG4gICAgICAgICkuam9pbignXFxuJyk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgSVN1Z2dlc3RPd25lciwgU2NvcGUsIFN1Z2dlc3RNb2RhbCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB0eXBlIHsgSmlyYVRhc2sgfSBmcm9tICcuL2ppcmEnO1xuXG5leHBvcnQgY2xhc3MgSmlyYVRhc2tTdWdnZXN0ZXIgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8SmlyYVRhc2s+IHtcbiAgICBwcml2YXRlIHRhc2tzOiBKaXJhVGFza1tdID0gW107XG4gICAgcHJpdmF0ZSBvblNlbGVjdDogKHRhc2s6IEppcmFUYXNrKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRhc2tzOiBKaXJhVGFza1tdLCBvblNlbGVjdDogKHRhc2s6IEppcmFUYXNrKSA9PiB2b2lkKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdKaXJhVGFza1N1Z2dlc3RlciBjb25zdHJ1Y3RvciBjYWxsZWQnKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1Rhc2tzIHJlY2VpdmVkOicsIHRhc2tzKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMudGFza3MgPSB0YXNrcztcbiAgICAgICAgdGhpcy5vblNlbGVjdCA9IG9uU2VsZWN0O1xuICAgICAgICBcbiAgICAgICAgLy8gRXhwbGljaXRseSBzZXQgcGxhY2Vob2xkZXIgYW5kIHN0eWxpbmdcbiAgICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcihcIlNlbGVjdCBhIEppcmEgdGFzay4uLlwiKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEVuc3VyZSB0aGUgbW9kYWwgaXMgc3R5bGVkIGFuZCB2aXNpYmxlXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoJ2ppcmEtdGFzay1zdWdnZXN0ZXInKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5zdHlsZS5tYXhXaWR0aCA9ICc2MDBweCc7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuc3R5bGUubWFyZ2luID0gJzAgYXV0byc7XG4gICAgICAgIFxuICAgICAgICAvLyBDbG9zZSBvbiBFc2NhcGVcbiAgICAgICAgdGhpcy5zY29wZSA9IG5ldyBTY29wZSgpO1xuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVzY2FwZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEV4cGxpY2l0bHkgb3BlbiB0aGUgbW9kYWxcbiAgICAgICAgY29uc29sZS5sb2coJ0Fib3V0IHRvIG9wZW4gbW9kYWwnKTtcbiAgICAgICAgdGhpcy5vcGVuKCk7XG4gICAgfVxuXG4gICAgLy8gT3ZlcnJpZGUgb3BlbiBtZXRob2QgdG8gZW5zdXJlIGl0J3MgZnVsbHkgdmlzaWJsZVxuICAgIG9wZW4oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdFeHBsaWNpdGx5IG9wZW5pbmcgbW9kYWwnKTtcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkaXRpb25hbCB2aXNpYmlsaXR5IGNoZWNrc1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuc3R5bGUub3BhY2l0eSA9ICcxJztcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogSmlyYVRhc2tbXSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdHZXR0aW5nIHN1Z2dlc3Rpb25zIGZvciBxdWVyeTonLCBxdWVyeSk7XG4gICAgICAgIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFRhc2tzID0gdGhpcy50YXNrcy5maWx0ZXIodGFzayA9PiBcbiAgICAgICAgICAgIHRhc2sua2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSkgfHxcbiAgICAgICAgICAgIHRhc2suc3VtbWFyeS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpXG4gICAgICAgICk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdGaWx0ZXJlZCB0YXNrczonLCBmaWx0ZXJlZFRhc2tzKTtcbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkVGFza3M7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih0YXNrOiBKaXJhVGFzaywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdSZW5kZXJpbmcgc3VnZ2VzdGlvbiBmb3IgdGFzazonLCB0YXNrKTtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcImppcmEtdGFzay1zdWdnZXN0aW9uXCIgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBrZXlFbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiamlyYS1rZXlcIiB9KTtcbiAgICAgICAga2V5RWwuc2V0VGV4dCh0YXNrLmtleSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdW1tYXJ5RWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImppcmEtc3VtbWFyeVwiIH0pO1xuICAgICAgICBzdW1tYXJ5RWwuc2V0VGV4dCh0YXNrLnN1bW1hcnkpO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3RhdHVzRWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImppcmEtc3RhdHVzXCIgfSk7XG4gICAgICAgIHN0YXR1c0VsLnNldFRleHQodGFzay5zdGF0dXMpO1xuXG4gICAgICAgIC8vIEFkZCBzdHlsZXMgaW5saW5lIHNpbmNlIHdlIGNhbid0IG1vZGlmeSB0aGUgQ1NTIGZpbGVcbiAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuICAgICAgICBlbC5zdHlsZS5mbGV4RGlyZWN0aW9uID0gXCJjb2x1bW5cIjtcbiAgICAgICAgZWwuc3R5bGUuZ2FwID0gXCI0cHhcIjtcbiAgICAgICAga2V5RWwuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xuICAgICAgICBrZXlFbC5zdHlsZS5jb2xvciA9IFwidmFyKC0tdGV4dC1hY2NlbnQpXCI7XG4gICAgICAgIHN0YXR1c0VsLnN0eWxlLmZvbnRTaXplID0gXCIwLjhlbVwiO1xuICAgICAgICBzdGF0dXNFbC5zdHlsZS5jb2xvciA9IFwidmFyKC0tdGV4dC1tdXRlZClcIjtcbiAgICAgICAgc3RhdHVzRWwuc3R5bGUuZm9udFN0eWxlID0gXCJpdGFsaWNcIjtcbiAgICB9XG5cbiAgICBvbkNob29zZVN1Z2dlc3Rpb24odGFzazogSmlyYVRhc2ssIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1Rhc2sgY2hvc2VuOicsIHRhc2spO1xuICAgICAgICAvLyBFbnN1cmUgdGhlIG9uU2VsZWN0IGNhbGxiYWNrIGlzIGNhbGxlZFxuICAgICAgICBpZiAodGhpcy5vblNlbGVjdCkge1xuICAgICAgICAgICAgdGhpcy5vblNlbGVjdCh0YXNrKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQSx1QkFBd0U7OztBQ3FCakUsSUFBTSxtQkFBMkM7QUFBQSxFQUNwRCxjQUFjO0FBQUEsRUFDZCxnQkFBZ0I7QUFBQSxFQUNoQixhQUFhO0FBQUEsSUFDVDtBQUFBLE1BQ0ksS0FBSztBQUFBLE1BQ0wsZ0JBQWdCO0FBQUEsTUFDaEIsY0FBYztBQUFBO0FBQUE7QUFBQSxFQUd0QixjQUFjO0FBQUEsSUFDVixTQUFTO0FBQUEsSUFDVCxTQUFTO0FBQUEsSUFDVCxVQUFVO0FBQUEsSUFDVixVQUFVO0FBQUEsSUFDVixhQUFhO0FBQUE7QUFBQTs7O0FDcENyQixzQkFBcUQ7QUFJOUMsNkNBQXVDLGlDQUFpQjtBQUFBLEVBSTNELFlBQVksS0FBVSxRQUE4QjtBQUNoRCxVQUFNLEtBQUs7QUFDWCxTQUFLLFNBQVM7QUFBQTtBQUFBLEVBR2xCLG9CQUEwQjtBQUN0QixRQUFJLEtBQUssUUFBUTtBQUNiLFdBQUssT0FBTztBQUVaLFlBQU0sU0FBUyxLQUFLLE9BQU8sU0FBUyxNQUFNLEVBQUUsTUFBTTtBQUVsRCxZQUFNLG1CQUFtQixLQUFLLE9BQU8sU0FBUyxPQUFPLEVBQUUsS0FBSztBQUM1RCx1QkFBaUIsU0FBUyxRQUFRLEVBQUUsTUFBTTtBQUMxQyxZQUFNLHFCQUFxQixpQkFBaUIsU0FBUyxRQUFRLEVBQUUsS0FBSztBQUNwRSx5QkFBbUIsU0FBUyxRQUFRO0FBQUEsUUFDaEMsTUFBTSxLQUFLLE9BQU8sU0FBUztBQUFBLFFBQzNCLEtBQUs7QUFBQTtBQUVULHlCQUFtQixTQUFTLFFBQVEsRUFBRSxNQUFNO0FBRTVDLFlBQU0s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
