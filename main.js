/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};

// src/main.ts
__export(exports, {
  default: () => EmojiChecklistPlugin
});
var import_obsidian3 = __toModule(require("obsidian"));

// src/types.ts
var DEFAULT_SETTINGS = {
  checkedEmoji: "\u2705",
  uncheckedEmoji: "\u2B1C\uFE0F",
  tagMappings: [
    {
      tag: "stopper",
      uncheckedEmoji: "\u{1F6D1}",
      checkedEmoji: "\u2705"
    }
  ]
};

// src/settings.ts
var import_obsidian = __toModule(require("obsidian"));
var EmojiChecklistSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  updateTestSection() {
    if (this.testEl) {
      this.testEl.empty();
      const header = this.testEl.createEl("h3", { text: "Live Preview" });
      const uncheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
      uncheckedExample.createEl("span", { text: "Unchecked example: " });
      const uncheckedContainer = uncheckedExample.createEl("span", { cls: "task-preview" });
      uncheckedContainer.createEl("span", {
        text: this.plugin.settings.uncheckedEmoji,
        cls: "emoji-preview"
      });
      uncheckedContainer.createEl("span", { text: " Sample task" });
      const checkedExample = this.testEl.createEl("div", { cls: "setting-item" });
      checkedExample.createEl("span", { text: "Checked example: " });
      const checkedContainer = checkedExample.createEl("span", { cls: "task-preview" });
      checkedContainer.createEl("span", {
        text: this.plugin.settings.checkedEmoji,
        cls: "emoji-preview"
      });
      const checkedText = checkedContainer.createEl("span", { text: " Sample task" });
      checkedText.style.textDecoration = "line-through";
      checkedText.style.color = "var(--text-muted)";
      if (this.plugin.settings.tagMappings.length > 0) {
        const tagHeader = this.testEl.createEl("h3", { text: "Tag Examples" });
        tagHeader.style.marginTop = "2em";
        tagHeader.style.marginBottom = "1em";
        for (const mapping of this.plugin.settings.tagMappings) {
          const tagUncheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
          tagUncheckedExample.createEl("span", { text: `#${mapping.tag} unchecked: ` });
          const tagUncheckedContainer = tagUncheckedExample.createEl("span", { cls: "task-preview" });
          tagUncheckedContainer.createEl("span", {
            text: mapping.uncheckedEmoji,
            cls: "emoji-preview"
          });
          tagUncheckedContainer.createEl("span", { text: ` Sample #${mapping.tag} task` });
          const tagCheckedExample = this.testEl.createEl("div", { cls: "setting-item" });
          tagCheckedExample.createEl("span", { text: `#${mapping.tag} checked: ` });
          const tagCheckedContainer = tagCheckedExample.createEl("span", { cls: "task-preview" });
          tagCheckedContainer.createEl("span", {
            text: mapping.checkedEmoji,
            cls: "emoji-preview"
          });
          const tagCheckedText = tagCheckedContainer.createEl("span", { text: ` Sample #${mapping.tag} task` });
          tagCheckedText.style.textDecoration = "line-through";
          tagCheckedText.style.color = "var(--text-muted)";
          tagUncheckedExample.style.marginBottom = "0.5em";
          tagCheckedExample.style.marginBottom = "0.5em";
        }
      }
      header.style.marginTop = "2em";
      header.style.marginBottom = "1em";
      uncheckedExample.style.marginBottom = "0.5em";
      checkedExample.style.marginBottom = "0.5em";
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Emoji Checklist Settings" });
    new import_obsidian.Setting(containerEl).setName("Default Unchecked Emoji").setDesc("Emoji to display for unchecked tasks").addText((text) => text.setValue(this.plugin.settings.uncheckedEmoji).onChange(async (value) => {
      this.plugin.settings.uncheckedEmoji = value;
      await this.plugin.saveSettings();
      this.updateTestSection();
      console.log("Updated default unchecked emoji:", this.plugin.settings.uncheckedEmoji);
    }));
    new import_obsidian.Setting(containerEl).setName("Default Checked Emoji").setDesc("Emoji to display for checked tasks").addText((text) => text.setValue(this.plugin.settings.checkedEmoji).onChange(async (value) => {
      this.plugin.settings.checkedEmoji = value;
      await this.plugin.saveSettings();
      this.updateTestSection();
      console.log("Updated default checked emoji:", this.plugin.settings.checkedEmoji);
    }));
    containerEl.createEl("h3", { text: "Tag Mappings" });
    const tagMappingsContainer = containerEl.createDiv("tag-mappings");
    this.plugin.settings.tagMappings.forEach((mapping, index) => {
      const mappingContainer = tagMappingsContainer.createDiv("tag-mapping");
      new import_obsidian.Setting(mappingContainer).setName(`Tag #${mapping.tag}`).addText((text) => text.setPlaceholder("tag name").setValue(mapping.tag).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].tag = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addText((text) => text.setPlaceholder("unchecked emoji").setValue(mapping.uncheckedEmoji).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].uncheckedEmoji = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addText((text) => text.setPlaceholder("checked emoji").setValue(mapping.checkedEmoji).onChange(async (value) => {
        this.plugin.settings.tagMappings[index].checkedEmoji = value;
        await this.plugin.saveSettings();
        this.updateTestSection();
        console.log("Updated tag mapping:", this.plugin.settings.tagMappings);
      })).addButton((button) => button.setIcon("trash").onClick(async () => {
        this.plugin.settings.tagMappings.splice(index, 1);
        await this.plugin.saveSettings();
        this.display();
        console.log("Removed tag mapping, remaining:", this.plugin.settings.tagMappings);
      }));
    });
    new import_obsidian.Setting(containerEl).setName("Add Tag Mapping").setDesc("Add a new tag-emoji mapping").addButton((button) => button.setButtonText("Add New Tag").onClick(async () => {
      this.plugin.settings.tagMappings.push({
        tag: "newtag",
        uncheckedEmoji: "\u2B55",
        checkedEmoji: "\u2705"
      });
      await this.plugin.saveSettings();
      console.log("Added new tag mapping:", this.plugin.settings.tagMappings);
      this.display();
    }));
    new import_obsidian.Setting(containerEl).setName("Reset Settings").setDesc("Restore all settings to their defaults").addButton((button) => button.setButtonText("Restore Defaults").onClick(async () => {
      this.plugin.settings = Object.assign({}, DEFAULT_SETTINGS);
      await this.plugin.saveSettings();
      console.log("Reset settings to defaults:", this.plugin.settings);
      this.display();
      new import_obsidian.Notice("Settings restored to defaults");
    }));
    new import_obsidian.Setting(containerEl).setName("Apply Changes").setDesc("Apply emoji changes to all open notes").addButton((button) => button.setButtonText("Apply Changes").onClick(() => {
      this.plugin.refreshAllNotes();
    }));
    this.testEl = containerEl.createDiv();
    this.updateTestSection();
  }
};

// src/processor.ts
var import_obsidian2 = __toModule(require("obsidian"));
var EmojiRenderChild = class extends import_obsidian2.MarkdownRenderChild {
  constructor(span) {
    super(span);
    this.span = span;
  }
  onunload() {
  }
};
function findTagInLine(listItem) {
  const text = listItem.textContent || "";
  console.log("Full task text:", text);
  const tagMatch = text.replace(/^[^\w\s#]*\s*/, "").match(/#(\w+)/);
  if (tagMatch) {
    const tag = tagMatch[1];
    console.log("Found tag:", tag);
    return tag;
  }
  console.log("No tag found in text");
  return null;
}
function getEmojisForTag(plugin, tag, isChecked) {
  console.log("Getting emoji for tag:", tag, "checked:", isChecked);
  console.log("Available mappings:", JSON.stringify(plugin.settings.tagMappings, null, 2));
  if (tag) {
    const mapping = plugin.settings.tagMappings.find((m) => m.tag.toLowerCase() === tag.toLowerCase());
    if (mapping) {
      console.log("Found mapping for tag:", JSON.stringify(mapping, null, 2));
      const emoji = isChecked ? mapping.checkedEmoji : mapping.uncheckedEmoji;
      console.log("Using tag-specific emoji:", emoji);
      return emoji;
    }
    console.log("No mapping found for tag:", tag);
  }
  const defaultEmoji = isChecked ? plugin.settings.checkedEmoji : plugin.settings.uncheckedEmoji;
  console.log("Using default emoji:", defaultEmoji);
  return defaultEmoji;
}
var processCheckboxes = function(el, ctx) {
  console.log("Processing checkboxes with settings:", JSON.stringify(this.settings, null, 2));
  const checkboxes = el.querySelectorAll('li.task-list-item input[type="checkbox"]');
  console.log("Found checkboxes:", checkboxes.length);
  const view = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
  const editor = view == null ? void 0 : view.editor;
  const sectionInfo = ctx.getSectionInfo(el);
  checkboxes.forEach((checkbox, index) => {
    if (!(checkbox instanceof HTMLInputElement)) {
      console.log("Invalid checkbox element at index", index);
      return;
    }
    const listItem = checkbox.closest("li.task-list-item");
    if (!listItem) {
      console.log("No list item found for checkbox", index);
      return;
    }
    console.log("Processing checkbox", index, "with HTML:", listItem.innerHTML);
    const tag = findTagInLine(listItem);
    console.log("Found tag for checkbox", index, ":", tag);
    const span = document.createElement("span");
    span.className = "task-list-emoji";
    const emoji = getEmojisForTag(this, tag, checkbox.checked);
    console.log("Initial emoji for checkbox", index, ":", emoji);
    span.textContent = emoji;
    if (editor && sectionInfo) {
      const lineText = editor.getLine(sectionInfo.lineStart + index);
      const existingEmojiMatch = lineText.match(/^([^\w\s#]*)\s*/);
      const existingEmoji = existingEmojiMatch ? existingEmojiMatch[1] : "";
      if (existingEmoji !== emoji) {
        const newText = lineText.replace(/^[^\w\s#]*\s*/, emoji + " ");
        editor.transaction({
          changes: [{
            from: { line: sectionInfo.lineStart + index, ch: 0 },
            to: { line: sectionInfo.lineStart + index, ch: lineText.length },
            text: newText
          }]
        });
      }
    }
    span.addEventListener("click", async (e) => {
      e.preventDefault();
      e.stopPropagation();
      checkbox.checked = !checkbox.checked;
      const newEmoji = getEmojisForTag(this, tag, checkbox.checked);
      console.log("New emoji after click:", newEmoji);
      span.textContent = newEmoji;
      if (editor && sectionInfo) {
        const lineText = editor.getLine(sectionInfo.lineStart + index);
        const newText = lineText.replace(/^[^\w\s#]*\s*/, newEmoji + " ");
        editor.transaction({
          changes: [{
            from: { line: sectionInfo.lineStart + index, ch: 0 },
            to: { line: sectionInfo.lineStart + index, ch: lineText.length },
            text: newText
          }]
        });
      }
      checkbox.dispatchEvent(new Event("change", { bubbles: true }));
      const sourcePath = ctx.sourcePath;
      if (sourcePath) {
        const renderChild = new EmojiRenderChild(span);
        ctx.addChild(renderChild);
      }
    });
    const container = checkbox.parentElement;
    if (container) {
      container.style.display = "flex";
      container.style.alignItems = "center";
      container.style.gap = "0.5em";
    }
    checkbox.style.display = "none";
    checkbox.after(span);
    checkbox.addEventListener("change", () => {
      const newEmoji = getEmojisForTag(this, tag, checkbox.checked);
      console.log("New emoji after change:", newEmoji);
      span.textContent = newEmoji;
      if (editor && sectionInfo) {
        const lineText = editor.getLine(sectionInfo.lineStart + index);
        const newText = lineText.replace(/^[^\w\s#]*\s*/, newEmoji + " ");
        editor.transaction({
          changes: [{
            from: { line: sectionInfo.lineStart + index, ch: 0 },
            to: { line: sectionInfo.lineStart + index, ch: lineText.length },
            text: newText
          }]
        });
      }
    });
  });
};

// src/main.ts
var EmojiChecklistPlugin = class extends import_obsidian3.Plugin {
  async onload() {
    await this.loadSettings();
    console.log("Plugin loaded with settings:", this.settings);
    this.registerMarkdownPostProcessor(processCheckboxes.bind(this));
    this.addSettingTab(new EmojiChecklistSettingTab(this.app, this));
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    console.log("Loaded data:", loadedData);
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData);
    console.log("Merged settings:", this.settings);
  }
  async saveSettings() {
    console.log("Saving settings:", this.settings);
    await this.saveData(this.settings);
  }
  refreshAllNotes() {
    this.app.workspace.trigger("markdown-preview-refresh");
    this.app.workspace.iterateAllLeaves((leaf) => {
      var _a;
      if (leaf.view.getViewType() === "markdown") {
        (_a = leaf.view.previewMode) == null ? void 0 : _a.rerender(true);
      }
    });
    new import_obsidian3.Notice("Applied emoji changes to all notes");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvcHJvY2Vzc29yLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIE5vdGljZSwgVmlldyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEVtb2ppQ2hlY2tsaXN0U2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IEVtb2ppQ2hlY2tsaXN0U2V0dGluZ1RhYiB9IGZyb20gJy4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgcHJvY2Vzc0NoZWNrYm94ZXMgfSBmcm9tICcuL3Byb2Nlc3Nvcic7XG5cbmludGVyZmFjZSBNYXJrZG93blZpZXcgZXh0ZW5kcyBWaWV3IHtcbiAgICBwcmV2aWV3TW9kZT86IHtcbiAgICAgICAgcmVyZW5kZXI6IChmb3JjZT86IGJvb2xlYW4pID0+IHZvaWQ7XG4gICAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRW1vamlDaGVja2xpc3RQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBFbW9qaUNoZWNrbGlzdFNldHRpbmdzO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICBjb25zb2xlLmxvZygnUGx1Z2luIGxvYWRlZCB3aXRoIHNldHRpbmdzOicsIHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKHByb2Nlc3NDaGVja2JveGVzLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEVtb2ppQ2hlY2tsaXN0U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgY29uc3QgbG9hZGVkRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcbiAgICAgICAgY29uc29sZS5sb2coJ0xvYWRlZCBkYXRhOicsIGxvYWRlZERhdGEpO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgbG9hZGVkRGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdNZXJnZWQgc2V0dGluZ3M6JywgdGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2aW5nIHNldHRpbmdzOicsIHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIHJlZnJlc2hBbGxOb3RlcygpIHtcbiAgICAgICAgLy8gRm9yY2UgcmVmcmVzaCBhbGwgbWFya2Rvd24gdmlld3NcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnRyaWdnZXIoJ21hcmtkb3duLXByZXZpZXctcmVmcmVzaCcpO1xuICAgICAgICBcbiAgICAgICAgLy8gRm9yY2UgcmUtcmVuZGVyIG9mIGFsbCBsZWFmIHZpZXdzXG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5pdGVyYXRlQWxsTGVhdmVzKGxlYWYgPT4ge1xuICAgICAgICAgICAgaWYgKGxlYWYudmlldy5nZXRWaWV3VHlwZSgpID09PSAnbWFya2Rvd24nKSB7XG4gICAgICAgICAgICAgICAgKGxlYWYudmlldyBhcyBNYXJrZG93blZpZXcpLnByZXZpZXdNb2RlPy5yZXJlbmRlcih0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3IE5vdGljZSgnQXBwbGllZCBlbW9qaSBjaGFuZ2VzIHRvIGFsbCBub3RlcycpO1xuICAgIH1cbn0iLCAiZXhwb3J0IGludGVyZmFjZSBUYWdFbW9qaU1hcHBpbmcge1xuICAgIHRhZzogc3RyaW5nO1xuICAgIHVuY2hlY2tlZEVtb2ppOiBzdHJpbmc7XG4gICAgY2hlY2tlZEVtb2ppOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1vamlDaGVja2xpc3RTZXR0aW5ncyB7XG4gICAgY2hlY2tlZEVtb2ppOiBzdHJpbmc7XG4gICAgdW5jaGVja2VkRW1vamk6IHN0cmluZztcbiAgICB0YWdNYXBwaW5nczogVGFnRW1vamlNYXBwaW5nW107XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBFbW9qaUNoZWNrbGlzdFNldHRpbmdzID0ge1xuICAgIGNoZWNrZWRFbW9qaTogJ1x1MjcwNScsXG4gICAgdW5jaGVja2VkRW1vamk6ICdcdTJCMUNcdUZFMEYnLFxuICAgIHRhZ01hcHBpbmdzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRhZzogJ3N0b3BwZXInLFxuICAgICAgICAgICAgdW5jaGVja2VkRW1vamk6ICdcdUQ4M0RcdURFRDEnLFxuICAgICAgICAgICAgY2hlY2tlZEVtb2ppOiAnXHUyNzA1J1xuICAgICAgICB9XG4gICAgXVxufTsiLCAiaW1wb3J0IHtBcHAsIE5vdGljZSwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZ30gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEVtb2ppQ2hlY2tsaXN0UGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQge0RFRkFVTFRfU0VUVElOR1N9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgRW1vamlDaGVja2xpc3RTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBFbW9qaUNoZWNrbGlzdFBsdWdpbjtcbiAgICB0ZXN0RWw6IEhUTUxFbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogRW1vamlDaGVja2xpc3RQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICB1cGRhdGVUZXN0U2VjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMudGVzdEVsKSB7XG4gICAgICAgICAgICB0aGlzLnRlc3RFbC5lbXB0eSgpO1xuXG4gICAgICAgICAgICBjb25zdCBoZWFkZXIgPSB0aGlzLnRlc3RFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdMaXZlIFByZXZpZXcnIH0pO1xuXG4gICAgICAgICAgICBjb25zdCB1bmNoZWNrZWRFeGFtcGxlID0gdGhpcy50ZXN0RWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnc2V0dGluZy1pdGVtJyB9KTtcbiAgICAgICAgICAgIHVuY2hlY2tlZEV4YW1wbGUuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICdVbmNoZWNrZWQgZXhhbXBsZTogJyB9KTtcbiAgICAgICAgICAgIGNvbnN0IHVuY2hlY2tlZENvbnRhaW5lciA9IHVuY2hlY2tlZEV4YW1wbGUuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ3Rhc2stcHJldmlldycgfSk7XG4gICAgICAgICAgICB1bmNoZWNrZWRDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy5wbHVnaW4uc2V0dGluZ3MudW5jaGVja2VkRW1vamksXG4gICAgICAgICAgICAgICAgY2xzOiAnZW1vamktcHJldmlldydcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdW5jaGVja2VkQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnIFNhbXBsZSB0YXNrJyB9KTtcblxuICAgICAgICAgICAgY29uc3QgY2hlY2tlZEV4YW1wbGUgPSB0aGlzLnRlc3RFbC5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdzZXR0aW5nLWl0ZW0nIH0pO1xuICAgICAgICAgICAgY2hlY2tlZEV4YW1wbGUuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICdDaGVja2VkIGV4YW1wbGU6ICcgfSk7XG4gICAgICAgICAgICBjb25zdCBjaGVja2VkQ29udGFpbmVyID0gY2hlY2tlZEV4YW1wbGUuY3JlYXRlRWwoJ3NwYW4nLCB7IGNsczogJ3Rhc2stcHJldmlldycgfSk7XG4gICAgICAgICAgICBjaGVja2VkQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywge1xuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMucGx1Z2luLnNldHRpbmdzLmNoZWNrZWRFbW9qaSxcbiAgICAgICAgICAgICAgICBjbHM6ICdlbW9qaS1wcmV2aWV3J1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBjaGVja2VkVGV4dCA9IGNoZWNrZWRDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICcgU2FtcGxlIHRhc2snIH0pO1xuICAgICAgICAgICAgY2hlY2tlZFRleHQuc3R5bGUudGV4dERlY29yYXRpb24gPSAnbGluZS10aHJvdWdoJztcbiAgICAgICAgICAgIGNoZWNrZWRUZXh0LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcblxuICAgICAgICAgICAgLy8gQWRkIHRhZyBleGFtcGxlc1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YWdIZWFkZXIgPSB0aGlzLnRlc3RFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdUYWcgRXhhbXBsZXMnIH0pO1xuICAgICAgICAgICAgICAgIHRhZ0hlYWRlci5zdHlsZS5tYXJnaW5Ub3AgPSAnMmVtJztcbiAgICAgICAgICAgICAgICB0YWdIZWFkZXIuc3R5bGUubWFyZ2luQm90dG9tID0gJzFlbSc7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1hcHBpbmcgb2YgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnVW5jaGVja2VkRXhhbXBsZSA9IHRoaXMudGVzdEVsLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3NldHRpbmctaXRlbScgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ1VuY2hlY2tlZEV4YW1wbGUuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IGAjJHttYXBwaW5nLnRhZ30gdW5jaGVja2VkOiBgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdVbmNoZWNrZWRDb250YWluZXIgPSB0YWdVbmNoZWNrZWRFeGFtcGxlLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICd0YXNrLXByZXZpZXcnIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YWdVbmNoZWNrZWRDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtYXBwaW5nLnVuY2hlY2tlZEVtb2ppLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiAnZW1vamktcHJldmlldydcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ1VuY2hlY2tlZENvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogYCBTYW1wbGUgIyR7bWFwcGluZy50YWd9IHRhc2tgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ0NoZWNrZWRFeGFtcGxlID0gdGhpcy50ZXN0RWwuY3JlYXRlRWwoJ2RpdicsIHsgY2xzOiAnc2V0dGluZy1pdGVtJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGFnQ2hlY2tlZEV4YW1wbGUuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IGAjJHttYXBwaW5nLnRhZ30gY2hlY2tlZDogYCB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnQ2hlY2tlZENvbnRhaW5lciA9IHRhZ0NoZWNrZWRFeGFtcGxlLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICd0YXNrLXByZXZpZXcnIH0pO1xuICAgICAgICAgICAgICAgICAgICB0YWdDaGVja2VkQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbWFwcGluZy5jaGVja2VkRW1vamksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHM6ICdlbW9qaS1wcmV2aWV3J1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFnQ2hlY2tlZFRleHQgPSB0YWdDaGVja2VkQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiBgIFNhbXBsZSAjJHttYXBwaW5nLnRhZ30gdGFza2AgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NoZWNrZWRUZXh0LnN0eWxlLnRleHREZWNvcmF0aW9uID0gJ2xpbmUtdGhyb3VnaCc7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NoZWNrZWRUZXh0LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcblxuICAgICAgICAgICAgICAgICAgICB0YWdVbmNoZWNrZWRFeGFtcGxlLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwLjVlbSc7XG4gICAgICAgICAgICAgICAgICAgIHRhZ0NoZWNrZWRFeGFtcGxlLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwLjVlbSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBoZWFkZXIuc3R5bGUubWFyZ2luVG9wID0gJzJlbSc7XG4gICAgICAgICAgICBoZWFkZXIuc3R5bGUubWFyZ2luQm90dG9tID0gJzFlbSc7XG4gICAgICAgICAgICB1bmNoZWNrZWRFeGFtcGxlLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwLjVlbSc7XG4gICAgICAgICAgICBjaGVja2VkRXhhbXBsZS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMC41ZW0nO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdFbW9qaSBDaGVja2xpc3QgU2V0dGluZ3MnIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0RlZmF1bHQgVW5jaGVja2VkIEVtb2ppJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdFbW9qaSB0byBkaXNwbGF5IGZvciB1bmNoZWNrZWQgdGFza3MnKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVuY2hlY2tlZEVtb2ppKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudW5jaGVja2VkRW1vamkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGVzdFNlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VwZGF0ZWQgZGVmYXVsdCB1bmNoZWNrZWQgZW1vamk6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MudW5jaGVja2VkRW1vamkpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdEZWZhdWx0IENoZWNrZWQgRW1vamknKVxuICAgICAgICAgICAgLnNldERlc2MoJ0Vtb2ppIHRvIGRpc3BsYXkgZm9yIGNoZWNrZWQgdGFza3MnKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNoZWNrZWRFbW9qaSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNoZWNrZWRFbW9qaSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUZXN0U2VjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBkYXRlZCBkZWZhdWx0IGNoZWNrZWQgZW1vamk6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2hlY2tlZEVtb2ppKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnVGFnIE1hcHBpbmdzJyB9KTtcblxuICAgICAgICBjb25zdCB0YWdNYXBwaW5nc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdigndGFnLW1hcHBpbmdzJyk7XG5cbiAgICAgICAgLy8gQWRkIGV4aXN0aW5nIHRhZyBtYXBwaW5nc1xuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncy5mb3JFYWNoKChtYXBwaW5nLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbWFwcGluZ0NvbnRhaW5lciA9IHRhZ01hcHBpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigndGFnLW1hcHBpbmcnKTtcblxuICAgICAgICAgICAgbmV3IFNldHRpbmcobWFwcGluZ0NvbnRhaW5lcilcbiAgICAgICAgICAgICAgICAuc2V0TmFtZShgVGFnICMke21hcHBpbmcudGFnfWApXG4gICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigndGFnIG5hbWUnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUobWFwcGluZy50YWcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzW2luZGV4XS50YWcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUZXN0U2VjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VwZGF0ZWQgdGFnIG1hcHBpbmc6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCd1bmNoZWNrZWQgZW1vamknKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUobWFwcGluZy51bmNoZWNrZWRFbW9qaSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3NbaW5kZXhdLnVuY2hlY2tlZEVtb2ppID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGVzdFNlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGVkIHRhZyBtYXBwaW5nOicsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ01hcHBpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignY2hlY2tlZCBlbW9qaScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShtYXBwaW5nLmNoZWNrZWRFbW9qaSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3NbaW5kZXhdLmNoZWNrZWRFbW9qaSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRlc3RTZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBkYXRlZCB0YWcgbWFwcGluZzonLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbigndHJhc2gnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdNYXBwaW5ncy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZW1vdmVkIHRhZyBtYXBwaW5nLCByZW1haW5pbmc6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBidXR0b24gdG8gYWRkIG5ldyB0YWcgbWFwcGluZ1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdBZGQgVGFnIE1hcHBpbmcnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0FkZCBhIG5ldyB0YWctZW1vamkgbWFwcGluZycpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQWRkIE5ldyBUYWcnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWc6ICduZXd0YWcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5jaGVja2VkRW1vamk6ICdcdTJCNTUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZEVtb2ppOiAnXHUyNzA1J1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBZGRlZCBuZXcgdGFnIG1hcHBpbmc6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVzZXQgU2V0dGluZ3MnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1Jlc3RvcmUgYWxsIHNldHRpbmdzIHRvIHRoZWlyIGRlZmF1bHRzJylcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZXN0b3JlIERlZmF1bHRzJylcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUyk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUmVzZXQgc2V0dGluZ3MgdG8gZGVmYXVsdHM6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnU2V0dGluZ3MgcmVzdG9yZWQgdG8gZGVmYXVsdHMnKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gQWRkIEFwcGx5IENoYW5nZXMgYnV0dG9uXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0FwcGx5IENoYW5nZXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0FwcGx5IGVtb2ppIGNoYW5nZXMgdG8gYWxsIG9wZW4gbm90ZXMnKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ0FwcGx5IENoYW5nZXMnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ucmVmcmVzaEFsbE5vdGVzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIHRoaXMudGVzdEVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMudXBkYXRlVGVzdFNlY3Rpb24oKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBNYXJrZG93blBvc3RQcm9jZXNzb3IsIE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBNYXJrZG93blJlbmRlckNoaWxkLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgdHlwZSBFbW9qaUNoZWNrbGlzdFBsdWdpbiBmcm9tICcuL21haW4nO1xuXG5jbGFzcyBFbW9qaVJlbmRlckNoaWxkIGV4dGVuZHMgTWFya2Rvd25SZW5kZXJDaGlsZCB7XG4gICAgcHJpdmF0ZSBzcGFuOiBIVE1MU3BhbkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihzcGFuOiBIVE1MU3BhbkVsZW1lbnQpIHtcbiAgICAgICAgc3VwZXIoc3Bhbik7XG4gICAgICAgIHRoaXMuc3BhbiA9IHNwYW47XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIC8vIE9wdGlvbmFsOiBBZGQgYW55IGNsZWFudXAgbG9naWMgaWYgbmVlZGVkXG4gICAgfVxufVxuXG5mdW5jdGlvbiBmaW5kVGFnSW5MaW5lKGxpc3RJdGVtOiBIVE1MRWxlbWVudCk6IHN0cmluZyB8IG51bGwge1xuICAgIC8vIEdldCB0aGUgZnVsbCB0ZXh0IGNvbnRlbnQgb2YgdGhlIGxpc3QgaXRlbVxuICAgIGNvbnN0IHRleHQgPSBsaXN0SXRlbS50ZXh0Q29udGVudCB8fCAnJztcbiAgICBjb25zb2xlLmxvZygnRnVsbCB0YXNrIHRleHQ6JywgdGV4dCk7XG5cbiAgICAvLyBMb29rIGZvciB0YWdzIGluIHRoZSB0ZXh0LCBpZ25vcmluZyBhbnkgZW1vamlzIGF0IHRoZSBzdGFydFxuICAgIGNvbnN0IHRhZ01hdGNoID0gdGV4dC5yZXBsYWNlKC9eW15cXHdcXHMjXSpcXHMqLywgJycpLm1hdGNoKC8jKFxcdyspLyk7XG4gICAgaWYgKHRhZ01hdGNoKSB7XG4gICAgICAgIGNvbnN0IHRhZyA9IHRhZ01hdGNoWzFdO1xuICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgdGFnOicsIHRhZyk7XG4gICAgICAgIHJldHVybiB0YWc7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ05vIHRhZyBmb3VuZCBpbiB0ZXh0Jyk7XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIGdldEVtb2ppc0ZvclRhZyhwbHVnaW46IEVtb2ppQ2hlY2tsaXN0UGx1Z2luLCB0YWc6IHN0cmluZyB8IG51bGwsIGlzQ2hlY2tlZDogYm9vbGVhbik6IHN0cmluZyB7XG4gICAgY29uc29sZS5sb2coJ0dldHRpbmcgZW1vamkgZm9yIHRhZzonLCB0YWcsICdjaGVja2VkOicsIGlzQ2hlY2tlZCk7XG4gICAgY29uc29sZS5sb2coJ0F2YWlsYWJsZSBtYXBwaW5nczonLCBKU09OLnN0cmluZ2lmeShwbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MsIG51bGwsIDIpKTtcbiAgICBcbiAgICBpZiAodGFnKSB7XG4gICAgICAgIGNvbnN0IG1hcHBpbmcgPSBwbHVnaW4uc2V0dGluZ3MudGFnTWFwcGluZ3MuZmluZChtID0+IG0udGFnLnRvTG93ZXJDYXNlKCkgPT09IHRhZy50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgaWYgKG1hcHBpbmcpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBtYXBwaW5nIGZvciB0YWc6JywgSlNPTi5zdHJpbmdpZnkobWFwcGluZywgbnVsbCwgMikpO1xuICAgICAgICAgICAgY29uc3QgZW1vamkgPSBpc0NoZWNrZWQgPyBtYXBwaW5nLmNoZWNrZWRFbW9qaSA6IG1hcHBpbmcudW5jaGVja2VkRW1vamk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnVXNpbmcgdGFnLXNwZWNpZmljIGVtb2ppOicsIGVtb2ppKTtcbiAgICAgICAgICAgIHJldHVybiBlbW9qaTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygnTm8gbWFwcGluZyBmb3VuZCBmb3IgdGFnOicsIHRhZyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGRlZmF1bHRFbW9qaSA9IGlzQ2hlY2tlZCA/IHBsdWdpbi5zZXR0aW5ncy5jaGVja2VkRW1vamkgOiBwbHVnaW4uc2V0dGluZ3MudW5jaGVja2VkRW1vamk7XG4gICAgY29uc29sZS5sb2coJ1VzaW5nIGRlZmF1bHQgZW1vamk6JywgZGVmYXVsdEVtb2ppKTtcbiAgICByZXR1cm4gZGVmYXVsdEVtb2ppO1xufVxuXG5leHBvcnQgY29uc3QgcHJvY2Vzc0NoZWNrYm94ZXM6IE1hcmtkb3duUG9zdFByb2Nlc3NvciA9IGZ1bmN0aW9uKFxuICAgIHRoaXM6IEVtb2ppQ2hlY2tsaXN0UGx1Z2luLFxuICAgIGVsOiBIVE1MRWxlbWVudCxcbiAgICBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHRcbikge1xuICAgIGNvbnNvbGUubG9nKCdQcm9jZXNzaW5nIGNoZWNrYm94ZXMgd2l0aCBzZXR0aW5nczonLCBKU09OLnN0cmluZ2lmeSh0aGlzLnNldHRpbmdzLCBudWxsLCAyKSk7XG4gICAgY29uc3QgY2hlY2tib3hlcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTElucHV0RWxlbWVudD4oJ2xpLnRhc2stbGlzdC1pdGVtIGlucHV0W3R5cGU9XCJjaGVja2JveFwiXScpO1xuICAgIGNvbnNvbGUubG9nKCdGb3VuZCBjaGVja2JveGVzOicsIGNoZWNrYm94ZXMubGVuZ3RoKTtcblxuICAgIC8vIEdldCB0aGUgY3VycmVudCB2aWV3IGFuZCBlZGl0b3JcbiAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICBjb25zdCBlZGl0b3IgPSB2aWV3Py5lZGl0b3I7XG4gICAgY29uc3Qgc2VjdGlvbkluZm8gPSBjdHguZ2V0U2VjdGlvbkluZm8oZWwpO1xuXG4gICAgY2hlY2tib3hlcy5mb3JFYWNoKChjaGVja2JveCwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKCEoY2hlY2tib3ggaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgY2hlY2tib3ggZWxlbWVudCBhdCBpbmRleCcsIGluZGV4KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxpc3RJdGVtID0gY2hlY2tib3guY2xvc2VzdCgnbGkudGFzay1saXN0LWl0ZW0nKSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgaWYgKCFsaXN0SXRlbSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIGxpc3QgaXRlbSBmb3VuZCBmb3IgY2hlY2tib3gnLCBpbmRleCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnUHJvY2Vzc2luZyBjaGVja2JveCcsIGluZGV4LCAnd2l0aCBIVE1MOicsIGxpc3RJdGVtLmlubmVySFRNTCk7XG4gICAgICAgIGNvbnN0IHRhZyA9IGZpbmRUYWdJbkxpbmUobGlzdEl0ZW0pO1xuICAgICAgICBjb25zb2xlLmxvZygnRm91bmQgdGFnIGZvciBjaGVja2JveCcsIGluZGV4LCAnOicsIHRhZyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBzcGFuLmNsYXNzTmFtZSA9ICd0YXNrLWxpc3QtZW1vamknO1xuICAgICAgICBjb25zdCBlbW9qaSA9IGdldEVtb2ppc0ZvclRhZyh0aGlzLCB0YWcsIGNoZWNrYm94LmNoZWNrZWQpO1xuICAgICAgICBjb25zb2xlLmxvZygnSW5pdGlhbCBlbW9qaSBmb3IgY2hlY2tib3gnLCBpbmRleCwgJzonLCBlbW9qaSk7XG4gICAgICAgIHNwYW4udGV4dENvbnRlbnQgPSBlbW9qaTtcblxuICAgICAgICAvLyBVcGRhdGUgdGhlIG5vdGUgY29udGVudCB3aXRoIHRoZSBjb3JyZWN0IGVtb2ppXG4gICAgICAgIGlmIChlZGl0b3IgJiYgc2VjdGlvbkluZm8pIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVUZXh0ID0gZWRpdG9yLmdldExpbmUoc2VjdGlvbkluZm8ubGluZVN0YXJ0ICsgaW5kZXgpO1xuICAgICAgICAgICAgLy8gRXh0cmFjdCBhbnkgZXhpc3RpbmcgZW1vamkgYXQgdGhlIHN0YXJ0IG9mIHRoZSBsaW5lXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0Vtb2ppTWF0Y2ggPSBsaW5lVGV4dC5tYXRjaCgvXihbXlxcd1xccyNdKilcXHMqLyk7XG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0Vtb2ppID0gZXhpc3RpbmdFbW9qaU1hdGNoID8gZXhpc3RpbmdFbW9qaU1hdGNoWzFdIDogJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChleGlzdGluZ0Vtb2ppICE9PSBlbW9qaSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1RleHQgPSBsaW5lVGV4dC5yZXBsYWNlKC9eW15cXHdcXHMjXSpcXHMqLywgZW1vamkgKyAnICcpO1xuICAgICAgICAgICAgICAgIGVkaXRvci50cmFuc2FjdGlvbih7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZXM6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiB7IGxpbmU6IHNlY3Rpb25JbmZvLmxpbmVTdGFydCArIGluZGV4LCBjaDogMCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdG86IHsgbGluZTogc2VjdGlvbkluZm8ubGluZVN0YXJ0ICsgaW5kZXgsIGNoOiBsaW5lVGV4dC5sZW5ndGggfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG5ld1RleHRcbiAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHNwYW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9ICFjaGVja2JveC5jaGVja2VkO1xuICAgICAgICAgICAgY29uc3QgbmV3RW1vamkgPSBnZXRFbW9qaXNGb3JUYWcodGhpcywgdGFnLCBjaGVja2JveC5jaGVja2VkKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdOZXcgZW1vamkgYWZ0ZXIgY2xpY2s6JywgbmV3RW1vamkpO1xuICAgICAgICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IG5ld0Vtb2ppO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIG5vdGUgY29udGVudFxuICAgICAgICAgICAgaWYgKGVkaXRvciAmJiBzZWN0aW9uSW5mbykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVUZXh0ID0gZWRpdG9yLmdldExpbmUoc2VjdGlvbkluZm8ubGluZVN0YXJ0ICsgaW5kZXgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1RleHQgPSBsaW5lVGV4dC5yZXBsYWNlKC9eW15cXHdcXHMjXSpcXHMqLywgbmV3RW1vamkgKyAnICcpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGVkaXRvci50cmFuc2FjdGlvbih7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZXM6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiB7IGxpbmU6IHNlY3Rpb25JbmZvLmxpbmVTdGFydCArIGluZGV4LCBjaDogMCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdG86IHsgbGluZTogc2VjdGlvbkluZm8ubGluZVN0YXJ0ICsgaW5kZXgsIGNoOiBsaW5lVGV4dC5sZW5ndGggfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG5ld1RleHRcbiAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2hlY2tib3guZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2NoYW5nZScsIHsgYnViYmxlczogdHJ1ZSB9KSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZVBhdGggPSBjdHguc291cmNlUGF0aDtcbiAgICAgICAgICAgIGlmIChzb3VyY2VQYXRoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVuZGVyQ2hpbGQgPSBuZXcgRW1vamlSZW5kZXJDaGlsZChzcGFuKTtcbiAgICAgICAgICAgICAgICBjdHguYWRkQ2hpbGQocmVuZGVyQ2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBjaGVja2JveC5wYXJlbnRFbGVtZW50O1xuICAgICAgICBpZiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XG4gICAgICAgICAgICBjb250YWluZXIuc3R5bGUuZ2FwID0gJzAuNWVtJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNoZWNrYm94LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIGNoZWNrYm94LmFmdGVyKHNwYW4pO1xuXG4gICAgICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0Vtb2ppID0gZ2V0RW1vamlzRm9yVGFnKHRoaXMsIHRhZywgY2hlY2tib3guY2hlY2tlZCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTmV3IGVtb2ppIGFmdGVyIGNoYW5nZTonLCBuZXdFbW9qaSk7XG4gICAgICAgICAgICBzcGFuLnRleHRDb250ZW50ID0gbmV3RW1vamk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbm90ZSBjb250ZW50XG4gICAgICAgICAgICBpZiAoZWRpdG9yICYmIHNlY3Rpb25JbmZvKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZVRleHQgPSBlZGl0b3IuZ2V0TGluZShzZWN0aW9uSW5mby5saW5lU3RhcnQgKyBpbmRleCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VGV4dCA9IGxpbmVUZXh0LnJlcGxhY2UoL15bXlxcd1xccyNdKlxccyovLCBuZXdFbW9qaSArICcgJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZWRpdG9yLnRyYW5zYWN0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlczogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IHsgbGluZTogc2VjdGlvbkluZm8ubGluZVN0YXJ0ICsgaW5kZXgsIGNoOiAwIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0bzogeyBsaW5lOiBzZWN0aW9uSW5mby5saW5lU3RhcnQgKyBpbmRleCwgY2g6IGxpbmVUZXh0Lmxlbmd0aCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbmV3VGV4dFxuICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBLHVCQUFxQzs7O0FDWTlCLElBQU0sbUJBQTJDO0FBQUEsRUFDcEQsY0FBYztBQUFBLEVBQ2QsZ0JBQWdCO0FBQUEsRUFDaEIsYUFBYTtBQUFBLElBQ1Q7QUFBQSxNQUNJLEtBQUs7QUFBQSxNQUNMLGdCQUFnQjtBQUFBLE1BQ2hCLGNBQWM7QUFBQTtBQUFBO0FBQUE7OztBQ25CMUIsc0JBQXFEO0FBSTlDLDZDQUF1QyxpQ0FBaUI7QUFBQSxFQUkzRCxZQUFZLEtBQVUs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
